var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),BaseEuiView=function(t){function e(e,i){var n=t.call(this)||this;return n._resources=null,n._controller=e,n._myParent=i,n._isInit=!1,n.addEventListener(eui.UIEvent.COMPLETE,n.onUIComplete,n),n}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.percentHeight=100,this.percentWidth=100},e.prototype.onUIComplete=function(){this.initUI(),this.initData()},Object.defineProperty(e.prototype,"myParent",{get:function(){return this._myParent},enumerable:!0,configurable:!0}),e.prototype.setResources=function(t){this._resources=t},e.prototype.isInit=function(){return this._isInit},e.prototype.applyFunc=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return this._controller.applyFunc.apply(this._controller,arguments)},e.prototype.applyControllerFunc=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return this._controller.applyControllerFunc.apply(this._controller,arguments)},e.prototype.isShow=function(){return null!=this.stage&&this.visible},e.prototype.addToParent=function(){this._myParent.addChild(this)},e.prototype.removeFromParent=function(){App.DisplayUtils.removeFromParent(this)},e.prototype.initUI=function(){this._isInit=!0},e.prototype.initData=function(){},e.prototype.destroy=function(){this._controller=null,this._myParent=null,this._resources=null},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.loadResource=function(t,e){this._resources&&this._resources.length>0?(App.ResourceUtils.loadResource(this._resources,[],t,null,this),this.once(eui.UIEvent.CREATION_COMPLETE,e,this)):(t(),e())},e.prototype.setVisible=function(t){this.visible=t},e}(eui.Component);__reflect(BaseEuiView.prototype,"BaseEuiView",["IBaseView"]);var starlingswf;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getTextField=function(t){return this.getChildByName(t)},e.prototype.getMovie=function(t){return this.getChildByName(t)},e.prototype.getSprite=function(t){return this.getChildByName(t)},e.prototype.getImage=function(t){return this.getChildByName(t)},e}(egret.DisplayObjectContainer);t.SwfSprite=e,__reflect(e.prototype,"starlingswf.SwfSprite")}(starlingswf||(starlingswf={}));var BaseClass=function(){function t(){}return t.getInstance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;if(!i._instance){var n=t.length;0==n?i._instance=new i:1==n?i._instance=new i(t[0]):2==n?i._instance=new i(t[0],t[1]):3==n?i._instance=new i(t[0],t[1],t[2]):4==n?i._instance=new i(t[0],t[1],t[2],t[3]):5==n&&(i._instance=new i(t[0],t[1],t[2],t[3],t[4]))}return i._instance},t}();__reflect(BaseClass.prototype,"BaseClass");var BaseController=function(){function t(){this._messages={}}return t.prototype.registerFunc=function(t,e,i){this._messages[t]=[e,i]},t.prototype.applyFunc=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this._messages[t];return n?n[0].apply(n[1],e):(Log.trace("消息"+t+"不存在侦听"),null)},t.prototype.applyControllerFunc=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return App.ControllerManager.applyFunc.apply(App.ControllerManager,arguments)},t.prototype.setModel=function(t){this._model=t},t.prototype.getModel=function(){return this._model},t.prototype.getControllerModel=function(t){return App.ControllerManager.getControllerModel(t)},t}();__reflect(BaseController.prototype,"BaseController");var ByteArrayMsg=function(){function t(){this._sid=0,this._msgBuffer=new egret.ByteArray,this.actionArray=[]}return t.prototype.receive=function(t){t.readBytes(this._msgBuffer);var e=this.decode(this._msgBuffer);e&&(e.sid>0?App.MessageCenter.dispatch("ssid_"+e.sid,[e.sid,e.id,e.body]):(e.body.isInBackground=GameApp.isInBackground,App.MessageCenter.dispatch(e.id,e.body))),0==this._msgBuffer.bytesAvailable&&this._msgBuffer.clear()},t.prototype.send=function(t,e,i,n){this._sid++,0==this._sid&&this._sid++;var r=this.encode(e);r&&(r.position=0,t.writeBytes(r,0,r.bytesAvailable),this.actionArray[this._sid]=[i,n],App.MessageCenter.addListener("ssid_"+this._sid,this.handlerSessionMsg,this))},t.prototype.handlerSessionMsg=function(t){var e=t[0],i=t[1],n=t[2],r=this.actionArray[e];r?r[0].apply(r[1],[i,n]):Log.trace("sessionId 没有action"),App.MessageCenter.removeListener("ssid_"+e,this.handlerSessionMsg,this)},t.prototype.decode=function(t){return Log.trace("decode需要子类重写，根据项目的协议结构解析"),null},t.prototype.encode=function(t){return Log.trace("encode需要子类重写，根据项目的协议结构解析"),null},t.prototype.resetSid=function(){this._sid=0},t.prototype.getSid=function(){return this._sid},t}();__reflect(ByteArrayMsg.prototype,"ByteArrayMsg",["BaseMsg"]);var UTFMsg=function(){function t(){this._sid=0}return t.prototype.receive=function(t){var e=t.readUTF(),i=this.decode(e);i&&App.MessageCenter.dispatch(i.key,i.body)},t.prototype.send=function(t,e){this._sid++,0==this._sid&&this._sid++;var i=this.encode(e);i&&(t.type=egret.WebSocket.TYPE_STRING,t.writeUTF(i))},t.prototype.decode=function(t){return Log.trace("decode需要子类重写，根据项目的协议结构解析"),null},t.prototype.encode=function(t){return Log.trace("encode需要子类重写，根据项目的协议结构解析"),null},t.prototype.resetSid=function(){this._sid=0},t.prototype.getSid=function(){return this._sid},t}();__reflect(UTFMsg.prototype,"UTFMsg",["BaseMsg"]);var BaseEuiLayer=function(t){function e(){var e=t.call(this)||this;return e.percentWidth=100,e.percentHeight=100,e.touchEnabled=!1,e}return __extends(e,t),e}(eui.Group);__reflect(BaseEuiLayer.prototype,"BaseEuiLayer");var BaseScene=function(){function t(){this._layers=new Array}return t.prototype.onEnter=function(){},t.prototype.onExit=function(){App.ViewManager.closeAll(),this.removeAllLayer()},t.prototype.addLayer=function(t){t instanceof BaseSpriteLayer?(App.StageUtils.getStage().addChild(t),this._layers.push(t)):t instanceof BaseEuiLayer&&(App.StageUtils.getUIStage().addChild(t),this._layers.push(t))},t.prototype.addLayerAt=function(t,e){t instanceof BaseSpriteLayer?(App.StageUtils.getStage().addChildAt(t,e),this._layers.push(t)):t instanceof BaseEuiLayer&&(App.StageUtils.getUIStage().addChildAt(t,e),this._layers.push(t))},t.prototype.removeLayer=function(t){t instanceof BaseSpriteLayer?(App.StageUtils.getStage().removeChild(t),this._layers.splice(this._layers.indexOf(t),1)):t instanceof BaseEuiLayer&&(App.StageUtils.getUIStage().removeChild(t),this._layers.splice(this._layers.indexOf(t),1))},t.prototype.layerRemoveAllChild=function(t){t instanceof BaseSpriteLayer?t.removeChildren():t instanceof BaseEuiLayer&&t.removeChildren()},t.prototype.removeAllLayer=function(){for(;this._layers.length;){var t=this._layers[0];this.layerRemoveAllChild(t),this.removeLayer(t)}},t}();__reflect(BaseScene.prototype,"BaseScene");var BaseSound=function(){function t(){this._cache={},this._loadingCache=new Array,App.TimerManager.doTimer(6e4,0,this.dealSoundTimer,this)}return t.prototype.dealSoundTimer=function(){for(var t=egret.getTimer(),e=Object.keys(this._cache),i=0,n=e.length;n>i;i++){var r=e[i];this.checkCanClear(r)&&t-this._cache[r]>=SoundManager.CLEAR_TIME&&(delete this._cache[r],RES.destroyRes(r))}},t.prototype.getSound=function(t){var e=RES.getRes(t);if(e)this._cache[t]&&(this._cache[t]=egret.getTimer());else{if(-1!=this._loadingCache.indexOf(t))return null;this._loadingCache.push(t),RES.getResAsync(t,this.onResourceLoadComplete,this)}return e},t.prototype.onResourceLoadComplete=function(t,e){var i=this._loadingCache.indexOf(e);-1!=i&&(this._loadingCache.splice(i,1),this._cache[e]=egret.getTimer(),this.loadedPlay(e))},t.prototype.loadedPlay=function(t){},t.prototype.checkCanClear=function(t){return!0},t}();__reflect(BaseSound.prototype,"BaseSound");var starlingswf;!function(t){var e=function(e){function i(t,i,n,r){var s=e.call(this)||this;return s._isPlay=!1,s.loop=!0,s._completeFunction=null,s._frames=t,s._labels=i,s._displayObjects=n,s._startFrame=0,s._endFrame=s._frames.length-1,s._ownerSwf=r,s.setCurrentFrame(0),s.play(),s}return __extends(i,e),i.prototype.update=function(){if(this._isPlay)if(this._currentFrame>this._endFrame){if(this.hasCompleteListener()&&this.dispatchEventWith(egret.Event.COMPLETE),this._currentFrame=this._startFrame,!this.loop)return void(this._ownerSwf&&this.stop(!1));if(this._startFrame==this._endFrame)return void(this._ownerSwf&&this.stop(!1));this.setCurrentFrame(this._startFrame)}else this.setCurrentFrame(this._currentFrame),this._currentFrame+=1},i.prototype.setCurrentFrame=function(e){this.$children.length=0,this._currentFrame=e,this.__frameInfos=this._frames[this._currentFrame];for(var i,n,r,s,o=this.__frameInfos.length,a=0;o>a;a++)i=this.__frameInfos[a],s=i[10],n=this._displayObjects[i[0]][s],n.skewX=i[6],n.skewY=i[7],n.alpha=i[8],n.name=i[9],n.x=i[2],n.y=i[3],i[1]==t.Swf.dataKey_Scale9?(n.width=i[11],n.height=i[12]):(n.scaleX=i[4],n.scaleY=i[5]),this.$children.push(n),n.$parent=this,i[1]==t.Swf.dataKey_TextField&&(r=n,r.width=i[11],r.height=i[12],r.textColor=i[14],r.size=i[15],r.textAlign=i[16],i[19]&&"\r"!=i[19]&&""!=i[19]&&(r.text=i[19]))},i.prototype.getCurrentFrame=function(){return this._currentFrame},i.prototype.play=function(){this._isPlay=!0,this._ownerSwf.swfUpdateManager.addSwfAnimation(this);var e,i,n;for(e in this._displayObjects)if(0==e.indexOf(t.Swf.dataKey_MovieClip)){i=this._displayObjects[e],n=i.length;for(var r=0;n>r;r++)i[r].play()}},i.prototype.stop=function(e){if(void 0===e&&(e=!0),this._isPlay=!1,this._ownerSwf.swfUpdateManager.removeSwfAnimation(this),e){var i,n,r;for(i in this._displayObjects)if(0==i.indexOf(t.Swf.dataKey_MovieClip)){n=this._displayObjects[i],r=n.length;for(var s=0;r>s;s++)n[s].stop(e)}}},i.prototype.gotoAndStop=function(t,e){void 0===e&&(e=!0),this.goTo(t),this.stop(e)},i.prototype.gotoAndPlay=function(t){this.goTo(t),this.play()},i.prototype.goTo=function(t){if("string"==typeof t){var e=this.getLabelData(t);this._currentLabel=e[0],this._currentFrame=this._startFrame=e[1],this._endFrame=e[2]}else"number"==typeof t&&(this._currentFrame=this._startFrame=t,this._endFrame=this._frames.length-1);this.setCurrentFrame(this._currentFrame)},i.prototype.getLabelData=function(t){for(var e,i=this._labels.length,n=0;i>n;n++)if(e=this._labels[n],e[0]==t)return e;return null},i.prototype.isPlay=function(){return this._isPlay},i.prototype.totalFrames=function(){return this._frames.length},i.prototype.currentLabel=function(){return this._currentLabel},i.prototype.labels=function(){for(var t=this._labels.length,e=[],i=0;t>i;i++)e.push(this._labels[i][0]);return e},i.prototype.hasCompleteListener=function(){return this.hasEventListener(egret.Event.COMPLETE)},i.prototype.hasLabel=function(t){var e=this.labels();return!(-1==e.indexOf(t))},i.prototype.getLabelStartFrame=function(t){return this.getLabelData(t)[1]},i.prototype.getLabelEndFrame=function(t){return this.getLabelData(t)[2]},i}(t.SwfSprite);t.SwfMovieClip=e,__reflect(e.prototype,"starlingswf.SwfMovieClip",["starlingswf.ISwfAnimation"])}(starlingswf||(starlingswf={}));var BaseLoadingView=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.skinName="resource/skins/LoadingSkin.exml",n}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.txtMsg.visible=!1,this.imgBg.texture=RES.getRes(this.loadingBgRes()),this.progressBar.skinName="resource/eui_skins/ProgressBarSkin.exml";var e=this.progressBar.thumb;e.texture=RES.getRes(this.fillRes());var i=this.progressBar.getChildByName("imgBg");i.texture=RES.getRes(this.fillBgRes()),this.progressBar.width=i.width,this.progressBar.height=i.height,this.progressBar.minimum=0,this.progressBar.maximum=100,this.progressBar.value=0,this.progressBar.labelDisplay.textColor=16777215,this.progressBar.labelDisplay.size=60,this.progressBar.labelDisplay.horizontalCenter=0,this.progressBar.labelDisplay.bottom=20,this.progressBar.visible=this.showProgressBar()},e.prototype.loadingBgRes=function(){return""},e.prototype.fillBgRes=function(){return""},e.prototype.fillRes=function(){return""},e.prototype.showProgressBar=function(){return!0},e.prototype.setProgress=function(t,e){this.progressBar.value=t/e*100},e}(BaseEuiView);__reflect(BaseLoadingView.prototype,"BaseLoadingView");var BasePanelView=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.skinName="resource/skins/PanelSkin.exml",n}return __extends(e,t),e.prototype.initUI=function(){this.btnClose.addEventListener(egret.TouchEvent.TOUCH_END,this.closeClickHandler,this)},e.prototype.initData=function(){t.prototype.initData.call(this),this.lbTitle.text=this._title},Object.defineProperty(e.prototype,"title",{get:function(){return this._title},set:function(t){this._title=t},enumerable:!0,configurable:!0}),e.prototype.closeClickHandler=function(){App.ViewManager.closeView(this)},e}(BaseEuiView);__reflect(BasePanelView.prototype,"BasePanelView");var baccarat;!function(t){var e=function(){function t(){}return Object.defineProperty(t.prototype,"roomInfo",{get:function(){return this._roomInfo},set:function(t){this._roomInfo=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEnterScene",{get:function(){return this._isEnterScene},set:function(t){this._isEnterScene=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gameInfo",{get:function(){return this._gameInfo},set:function(t){this._gameInfo=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"statInfo",{get:function(){return this._statInfo},set:function(t){this._statInfo=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"billWayInfo",{get:function(){return this._billWayInfo},set:function(t){this._billWayInfo=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"members",{get:function(){return this._mems},set:function(t){this._mems=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"me",{get:function(){return this._me},set:function(t){"number"!=typeof t.chips&&(t.chips=t.chips.toNumber()),this._me=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"myBet",{get:function(){return this._myBet},set:function(t){this._myBet=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastBet",{get:function(){return this._lastBet},set:function(t){this._lastBet=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"totalBet",{get:function(){return this._totalBet},set:function(t){this._totalBet=t},enumerable:!0,configurable:!0}),t.prototype.setMembers=function(t){var e=this;this._mems=t,this._mems.forEach(function(t){return GameApp.PlayerInfo.isMySelf(t.playerId)?void(e._me=t):void 0})},t}();t.BaccaratModel=e,__reflect(e.prototype,"baccarat.BaccaratModel")}(baccarat||(baccarat={}));var fish;!function(t){var e=function(){function t(){this._backRoom=!1}return Object.defineProperty(t.prototype,"roomInfo",{get:function(){return this._roomInfo},set:function(t){this._roomInfo=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"backRoom",{get:function(){return this._backRoom},set:function(t){this._backRoom=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEnterScene",{get:function(){return this._isEnterScene},set:function(t){this._isEnterScene=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"instatdSendPlayerLst",{get:function(){return this._instatdSendPlayerLst},set:function(t){this._instatdSendPlayerLst=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userInfoLst",{get:function(){return this._userInfoLst},enumerable:!0,configurable:!0}),t.prototype.addUserInfo=function(t,e){this._userInfoLst||(this._userInfoLst={}),this._userInfoLst[t]=e},t.prototype.resetUserInfo=function(t){-1!=this._userInfoLst[t].seatId&&(this._userInfoLst[t].seatId=-1,this._userInfoLst[t].playerId=-1,this._userInfoLst[t].isLocal=!1,this._userInfoLst[t].chips=0)},t.prototype.getUserInfo=function(t){return this._userInfoLst?this._userInfoLst[t]:null},t.prototype.removeAllUserInfo=function(){this._userInfoLst=null},t}();t.FishMainModel=e,__reflect(e.prototype,"fish.FishMainModel")}(fish||(fish={}));var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),document.addEventListener("visibilitychange",function(){"visible"==document.visibilityState&&(egret.Capabilities.isMobile||(GameApp.isInBackground=!1,GameApp.HomeManager.resumeGame())),"hidden"==document.visibilityState&&(egret.Capabilities.isMobile||(GameApp.isInBackground=!0,GameApp.HomeManager.pauseGame()))}),egret.lifecycle.onPause=function(){egret.Capabilities.isMobile&&(GameApp.isInBackground=!0,egret.ticker.pause(),App.SoundManager.setBgVolume(0),App.SoundManager.setEffectVolume(0),GameApp.HomeManager.pauseGame())},egret.lifecycle.onResume=function(){egret.Capabilities.isMobile&&(GameApp.isInBackground=!1,egret.ticker.resume(),App.SoundManager.setBgVolume(1),App.SoundManager.setEffectVolume(1),GameApp.HomeManager.resumeGame())};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),App.EasyLoading.showLoading(),this.loadConfig()},e.prototype.loadConfig=function(){App.ResourceUtils.addConfig("resource/default.res.json","resource/"),App.ResourceUtils.loadConfig(this.onConfigComplete,this)},e.prototype.onConfigComplete=function(){var t=new eui.Theme("resource/customer_theme.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},e.prototype.onThemeLoadComplete=function(){App.ResourceUtils.loadGroup("preload",this.onPreLoadComplete,this.onPreLoadProgress,this)},e.prototype.onPreLoadComplete=function(){App.EasyLoading.hideLoading(),LoginMgr.start()},e.prototype.onPreLoadProgress=function(t,e){},e}(eui.UILayer);__reflect(Main.prototype,"Main");var App=function(){function t(){}return Object.defineProperty(t,"Http",{get:function(){return Http.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Socket",{get:function(){return Socket.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ControllerManager",{get:function(){return ControllerManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ViewManager",{get:function(){return ViewManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SceneManager",{get:function(){return SceneManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DebugUtils",{get:function(){return DebugUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MessageCenter",{get:function(){return MessageCenter.getInstance(0)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TimerManager",{get:function(){return TimerManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DateUtils",{get:function(){return DateUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MathUtils",{get:function(){return MathUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"RandomUtils",{get:function(){return RandomUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DisplayUtils",{get:function(){return DisplayUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"BitmapNumber",{get:function(){return BitmapNumber.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GuideUtils",{get:function(){return GuideUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"StageUtils",{get:function(){return StageUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EffectUtils",{get:function(){return EffectUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"StringUtils",{get:function(){return StringUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CommonUtils",{get:function(){return CommonUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SoundManager",{get:function(){return SoundManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DeviceUtils",{get:function(){return DeviceUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EgretExpandUtils",{get:function(){return EgretExpandUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"KeyboardUtils",{get:function(){return KeyboardUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"RockerUtils",{get:function(){return RockerUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ShockUtils",{get:function(){return ShockUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ResourceUtils",{get:function(){return ResourceUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"RenderTextureManager",{get:function(){return RenderTextureManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TextFlowMaker",{get:function(){return TextFlowMaker.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"NotificationCenter",{get:function(){return null==t._notificationCenter&&(t._notificationCenter=new MessageCenter(1)),t._notificationCenter},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DelayOptManager",{get:function(){return DelayOptManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ArrayUtils",{get:function(){return ArrayUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EasyLoading",{get:function(){return EasyLoading.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ResVersionManager",{get:function(){return ResVersionManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DragonBonesFactory",{get:function(){return DragonBonesFactory.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"StarlingSwfFactory",{get:function(){return StarlingSwfFactory.getInstance()},enumerable:!0,configurable:!0}),t.IsNetAvaliable=function(){return navigator&&0==navigator.onLine?!1:!0},Object.defineProperty(t,"MsgFactory",{get:function(){return MsgFactory.getInstance()},enumerable:!0,configurable:!0}),t.Init=function(){ResVersionManager.getInstance(),t.GlobalData=RES.getRes("global"),t.DebugUtils.isOpen(t.GlobalData.IsDebug),t.DebugUtils.setThreshold(5),t.EgretExpandUtils.init(),t.Socket.initServer(t.GlobalData.SocketServer,t.GlobalData.SocketPort,t.GlobalData.SocketUrl,new ByteArrayMsgByProtobuf)},t.ProxyUserFlag="",t.GlobalData=null,t}();__reflect(App.prototype,"App");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?n(r):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var MergeJsonAnalyzer=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mergeJsons=["MergeConfig_json"],e}return __extends(e,t),e.prototype.analyzeData=function(t,e){var i=t.name;if(!this.fileDic[i]&&e)try{var n=JSON.parse(e);if(-1!=this.mergeJsons.indexOf(i))for(var r in n)this.fileDic[r]=n[r];else this.fileDic[i]=n}catch(s){egret.$warn(1017,t.url,e)}},e}(RES.JsonAnalyzer);__reflect(MergeJsonAnalyzer.prototype,"MergeJsonAnalyzer");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function r(t){e.call(n,t)}function s(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Keyboard=function(){function t(){}return t.LEFT=37,t.RIGHT=39,t.UP=38,t.DOWN=40,t.W=87,t.A=65,t.S=83,t.D=68,t.J=74,t.K=75,t.L=76,t.U=85,t.I=73,t.O=79,t.P=80,t.SPACE=32,t}();__reflect(Keyboard.prototype,"Keyboard");var BitmapNumber=function(t){function e(){var e=t.call(this)||this;return e._imgPool=[],e._containerPool=[],e}return __extends(e,t),e.prototype.createNumPic=function(t,e){var i,n=this.getContainer(),r=t.toString(),s=0;for(s;s<r.length;s++)i=this.getSingleNumPic(r.charAt(s),e),n.addChild(i);return this.repositionNumPic(n),n},e.prototype.desstroyNumPic=function(t){this.clearContainer(t),t.parent&&t.parent.removeChild(t),this._containerPool.push(t)},e.prototype.changeNum=function(t,e,i){var n=e.toString();if(t.numChildren>n.length)for(;t.numChildren>n.length;)this.recycleBM(t.getChildAt(t.numChildren-1));var r,s=0;for(s;s<n.length;s++)s>=t.numChildren&&t.addChild(this.getBitmap()),r=n.charAt(s),r="."==r?"dot":r,t.getChildAt(s).texture=this.getTexture(r,i);this.repositionNumPic(t)},e.prototype.repositionNumPic=function(t){var e,i=0,n=0;for(i;i<t.numChildren;i++)e=t.getChildAt(i),e.x=n,n=e.x+e.width},e.prototype.clearContainer=function(t){for(;t.numChildren;)this.recycleBM(t.removeChildAt(0))},e.prototype.recycleBM=function(t){t&&t.parent&&(t.parent.removeChild(t),t.texture=null,this._imgPool.push(t))},e.prototype.getContainer=function(){return this._containerPool.length?this._containerPool.shift():new egret.DisplayObjectContainer},e.prototype.getSingleNumPic=function(t,e){"."==t&&(t="dot");var i=this.getBitmap();return i.texture=this.getTexture(t,e),i},e.prototype.getTexture=function(t,e){return RES.getRes(e+t)},e.prototype.getBitmap=function(){return this._imgPool.length?this._imgPool.shift():new egret.Bitmap},e}(BaseClass);__reflect(BitmapNumber.prototype,"BitmapNumber");var HotspotBitmap=function(t){function e(){var e=t.call(this)||this;return e._hotspot=[],e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouch,e),e}return __extends(e,t),e.prototype.addHotspotArea=function(t,e,i,n){this._hotspot.push({rect:t,callBack:e,thisObj:i,para:n})},e.prototype.onTouch=function(t){for(var e,i=t.localX,n=t.localY,r=0;r<this._hotspot.length;r++)e=this._hotspot[r],e.rect.contains(i,n)&&(e.para?e.callBack.call(e.thisObj,e.para):e.callBack.call(e.thisObj))},e}(egret.Bitmap);__reflect(HotspotBitmap.prototype,"HotspotBitmap");var DragonBonesArmature=function(t){function e(e,i){var n=t.call(this)||this;return n._armature=e,n._clock=i,n.addChild(n._armature.display),n._completeCalls=[],n._frameCalls=[],n._isPlay=!1,n._playName="",n}return __extends(e,t),e.prototype.addListeners=function(){this._armature.eventDispatcher.addEvent(dragonBones.EventObject.COMPLETE,this.completeHandler,this),this._armature.eventDispatcher.addEvent(dragonBones.EventObject.FRAME_EVENT,this.frameHandler,this)},e.prototype.removeListeners=function(){this._armature.eventDispatcher.removeEvent(dragonBones.EventObject.COMPLETE,this.completeHandler,this),this._armature.eventDispatcher.removeEvent(dragonBones.EventObject.FRAME_EVENT,this.frameHandler,this)},e.prototype.completeHandler=function(t){for(var e=t.eventObject.animationState.name,i=0,n=this._completeCalls.length;n>i;i++){var r=this._completeCalls[i];r[0].apply(r[1],[t,e])}e==this._playName&&(this._playName="")},e.prototype.frameHandler=function(t){for(var e=0,i=this._frameCalls.length;i>e;e++){var n=this._frameCalls[e];n[0].apply(n[1],[t])}},e.prototype.play=function(t,e){return void 0===e&&(e=void 0),this._playName==t?this._currAnimationState:(this._playName=t,this.start(),void 0==e?this._currAnimationState=this.getAnimation().play(t):this._currAnimationState=this.getAnimation().play(t,e),this._currAnimationState)},e.prototype.start=function(){this._isPlay||(this._clock.add(this._armature),this._isPlay=!0,this.addListeners())},e.prototype.stop=function(){this._isPlay&&(this._clock.remove(this._armature),this._isPlay=!1,this._playName="",this.removeListeners())},e.prototype.destroy=function(){this.stop(),this.parent&&this.parent.removeChild(this),this.removeChildren(),this._armature=null,this._clock=null,this._completeCalls=null,this._frameCalls=null},e.prototype.addCompleteCallFunc=function(t,e){for(var i=0;i<this._completeCalls.length;i++){var n=this._completeCalls[i];if(n[0]==t&&n[1]==e)return}this._completeCalls.unshift([t,e])},e.prototype.removeCompleteCallFunc=function(t,e){for(var i=0;i<this._completeCalls.length;i++){var n=this._completeCalls[i];n[0]==t&&n[1]==e&&(this._completeCalls.splice(i,1),i--)}},e.prototype.addFrameCallFunc=function(t,e){for(var i=0;i<this._frameCalls.length;i++){var n=this._frameCalls[i];if(n[0]==t&&n[1]==e)return}this._frameCalls.push([t,e])},e.prototype.removeFrameCallFunc=function(t,e){for(var i=0;i<this._frameCalls.length;i++){var n=this._frameCalls[i];n[0]==t&&n[1]==e&&(this._frameCalls.splice(i,1),i--)}},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.stop()},e.prototype.getArmature=function(){return this._armature},e.prototype.getCurrAnimationState=function(){return this._currAnimationState},e.prototype.getClock=function(){return this._clock},e.prototype.getAnimation=function(){return this._armature.animation},e.prototype.getBone=function(t){return this._armature.getBone(t)},e.prototype.getPlayName=function(){return this._playName},e.prototype.getBoneDisplay=function(t){return t.slot.display},e.prototype.changeBone=function(t,e){var i=this.getBone(t);i&&i.slot.setDisplay(e)},e}(egret.DisplayObjectContainer);__reflect(DragonBonesArmature.prototype,"DragonBonesArmature");var DragonBonesArmatureContainer=function(t){function e(){var e=t.call(this)||this;return e.armatures=new Array,e.actions={},e.cacheBones={},e}return __extends(e,t),e.prototype.register=function(t,e){this.armatures.push(t);for(var i=0,n=e.length;n>i;i++)this.actions[e[i]]=this.armatures.length-1},Object.defineProperty(e.prototype,"armature",{get:function(){return this.armatures[this.currArmatureIndex]},enumerable:!0,configurable:!0}),e.prototype.getCacheBone=function(t){if(!this.cacheBones[t]){this.cacheBones[t]=[];for(var e=0,i=this.armatures.length;i>e;e++){var n=this.armatures[e];this.cacheBones[t].push(n.getBone(t))}}return this.cacheBones[t][this.currArmatureIndex]},e.prototype.play=function(t,e){if(void 0===e&&(e=void 0),null==this.actions[t])return void Log.trace("DragonBonesArmatureContainer不存在动作：",t);var i=this.actions[t];i!=this.currArmatureIndex&&this.remove();var n=this.armatures[i];return n?(this.addChild(n),this.currArmatureIndex=i,n.play(t,e)):null},e.prototype.stop=function(){var t=this.armatures[this.currArmatureIndex];t&&t.stop()},e.prototype.start=function(){var t=this.armatures[this.currArmatureIndex];t&&t.start()},e.prototype.remove=function(){var t=this.armatures[this.currArmatureIndex];t&&(t.stop(),App.DisplayUtils.removeFromParent(t),this.currArmatureIndex=null)},e.prototype.addCompleteCallFunc=function(t,e){for(var i=0,n=this.armatures.length;n>i;i++){var r=this.armatures[i];r.addCompleteCallFunc(t,e)}},e.prototype.removeCompleteCallFunc=function(t,e){for(var i=0,n=this.armatures.length;n>i;i++){var r=this.armatures[i];r.removeCompleteCallFunc(t,e)}},e.prototype.addFrameCallFunc=function(t,e){for(var i=0,n=this.armatures.length;n>i;i++){var r=this.armatures[i];r.addFrameCallFunc(t,e)}},e.prototype.removeFrameCallFunc=function(t,e){for(var i=0,n=this.armatures.length;n>i;i++){var r=this.armatures[i];
r.removeFrameCallFunc(t,e)}},e.prototype.clear=function(){for(;this.armatures.length;){var t=this.armatures.pop();App.DisplayUtils.removeFromParent(t),t.destroy()}this.cacheBones={},this.actions={}},e.prototype.destroy=function(){this.clear(),this.armatures=null,this.cacheBones=null,this.actions=null},e}(egret.DisplayObjectContainer);__reflect(DragonBonesArmatureContainer.prototype,"DragonBonesArmatureContainer");var DragonBonesFactory=function(t){function e(){var e=t.call(this)||this;return e.averageUtils=new AverageUtils,e.factory=new dragonBones.EgretFactory,e.clocks=new Array,e.clocksLen=0,e.files=[],e.start(),e}return __extends(e,t),e.prototype.initArmatureFile=function(t,e,i){-1==this.files.indexOf(t.name)&&(this.addSkeletonData(t),this.addTextureAtlas(e,i),this.files.push(t.name))},e.prototype.removeArmatureFile=function(t){var e=this.files.indexOf(t);-1!=e&&(this.removeSkeletonData(t),this.removeTextureAtlas(t),this.files.splice(e,1))},e.prototype.clear=function(){for(;this.files.length;)this.removeArmatureFile(this.files[0])},e.prototype.addSkeletonData=function(t){this.factory.parseDragonBonesData(t)},e.prototype.addTextureAtlas=function(t,e){this.factory.parseTextureAtlasData(e,t)},e.prototype.removeSkeletonData=function(t){this.factory.removeDragonBonesData(t)},e.prototype.removeTextureAtlas=function(t){this.factory.removeTextureAtlasData(t)},e.prototype.makeArmature=function(t,e,i){void 0===i&&(i=1);var n=this.factory.buildArmature(t,e);if(null==n)return Log.trace("不存在Armature： "+t),null;var r=this.createWorldClock(i),s=new DragonBonesArmature(n,r);return s},e.prototype.makeFastArmature=function(t,e,i){void 0===i&&(i=1);var n=this.makeArmature(t,e,i);return n.getArmature().cacheFrameRate=24,n},e.prototype.createWorldClock=function(t){for(var e=0;e<this.clocksLen;e++)if(this.clocks[e].timeScale==t)return this.clocks[e];var i=new dragonBones.WorldClock;return i.timeScale=t,this.clocks.push(i),this.clocksLen=this.clocks.length,i},e.prototype.onEnterFrame=function(t){this.averageUtils.push(t);for(var e=.001*this.averageUtils.getValue(),i=0;i<this.clocksLen;i++){var n=this.clocks[i];n.advanceTime(e)}},e.prototype.stop=function(){this.isPlay&&(App.TimerManager.remove(this.onEnterFrame,this),this.isPlay=!1)},e.prototype.start=function(){this.isPlay||(this.isPlay=!0,App.TimerManager.doFrame(1,0,this.onEnterFrame,this))},e}(BaseClass);__reflect(DragonBonesFactory.prototype,"DragonBonesFactory");var GuideMaskBackgroud=function(t){function e(){var e=t.call(this)||this;return e._stageWidth=0,e._stageHeight=0,e._bgs=new Array,e.touchEnabled=!0,e}return __extends(e,t),e.prototype.init=function(t,e){this._stageWidth=t,this._stageHeight=e},e.prototype.draw=function(t){this.cacheAsBitmap=!1,this._deductRec=t,this.removeAllChild();var e=Math.max(t.x,0),i=Math.max(t.y,0),n=Math.min(t.x+t.width,this._stageWidth),r=Math.min(t.y+t.height,this._stageHeight);this.addBg(0,0,this._stageWidth,i),this.addBg(0,i,e,t.height),this.addBg(n,i,this._stageWidth-n,t.height),this.addBg(0,r,this._stageWidth,this._stageHeight-r),this.width=this._stageWidth,this.height=this._stageHeight,this.cacheAsBitmap=!0},e.prototype.destroy=function(){this.removeChildren(),this._bgs=[]},e.prototype.removeAllChild=function(){for(;this.numChildren;){var t=this.removeChildAt(0);this._bgs.push(t)}},e.prototype.addBg=function(t,e,i,n){var r;this._bgs.length?(r=this._bgs.pop(),r.graphics.clear()):r=new egret.Shape,r.graphics.beginFill(0,.5),r.graphics.drawRect(t,e,i,n),r.graphics.endFill(),this.addChild(r)},e.prototype.hitTest=function(t,e,i){return this._deductRec&&this._deductRec.contains(t,e)?null:this},e}(egret.Sprite);__reflect(GuideMaskBackgroud.prototype,"GuideMaskBackgroud");var GuideUtils=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.configData={1:{1:{txt:"点击这里，去设置宠物出战",txtdir:1,handDir:1},2:{txt:"点击选择一个宠物出战",txtdir:3,handDir:1},3:{txt:"点击宠物出战",txtdir:3,handDir:1}},2:{1:{txt:"更多宠物，可以抽取获得哦！",txtdir:1,handDir:2},2:{txt:"点击抽取宠物",txtdir:1,handDir:1}},3:{1:{txt:"点击选择另一个宠物",txtdir:1,handDir:1},2:{txt:"点击宠物出战",txtdir:3,handDir:1}},4:{1:{txt:"点击查看宠物属性",txtdir:4,handDir:1},2:{txt:"点击宠物升级",txtdir:1,handDir:2},3:{txt:"点击选择升级材料",txtdir:3,handDir:1},4:{txt:"选择一个宠物或卡牌作为材料",txtdir:3,handDir:1},5:{txt:"选择材料后点击确定回到升级界面",txtdir:1,handDir:2},6:{txt:"点击完成升级",txtdir:1,handDir:2}},5:{1:{txt:"现在立刻享受\n炫酷的飞行吧",txtdir:1,handDir:2},2:{txt:"每天前3次购买免费",txtdir:1,handDir:1},3:{txt:"开始战斗吧",txtdir:1,handDir:2}},6:{1:{txt:"点击这里查看战机",txtdir:1,handDir:1},2:{txt:"点击升级战机，\n可以提高战力",txtdir:1,handDir:2}}},e.currPart=0,e.currStep=0,e}return __extends(e,t),e.prototype.next=function(){null!=this.view&&null!=this.view.parent&&(this.currStep++,this.configData[this.currPart][this.currStep]||(this.currPart++,this.currStep=1),this.configData[this.currPart]||(this.currPart=0,this.currStep=0),this.hide())},e.prototype.show=function(t,e,i){this.currPart==e&&this.currStep==i&&(null==this.view&&(this.view=new GuideView),this.view.setData(t,this.configData[this.currPart][this.currStep]),egret.MainContext.instance.stage.addChild(this.view))},e.prototype.hide=function(){App.DisplayUtils.removeFromParent(this.view)},e.prototype.isShow=function(){return null!=this.view&&null!=this.view.parent},e}(BaseClass);__reflect(GuideUtils.prototype,"GuideUtils");var GuideView=function(t){function e(){var e=t.call(this)||this;return e._objRec=new egret.Rectangle,e._objGlobalPoint=new egret.Point,e._bg=new GuideMaskBackgroud,e.addChild(e._bg),e._maskPic=StarlingSwfUtils.createS9Image("s9_guide_mask"),e.addChild(e._maskPic),e._textBgPic=StarlingSwfUtils.createS9Image("s9_guide_txt"),AnchorUtil.setAnchorY(e._textBgPic,1),e.addChild(e._textBgPic),e._handPic=StarlingSwfUtils.createImage("img_hand"),AnchorUtil.setAnchorX(e._handPic,.5),e.addChild(e._handPic),e._txt=new egret.TextField,e._txt.size=26,e._txt.textColor=5723991,e._txt.lineSpacing=4,AnchorUtil.setAnchorY(e._txt,.5),e.addChild(e._txt),egret.MainContext.instance.stage.addEventListener(egret.Event.RESIZE,e.onResize,e),e}return __extends(e,t),e.prototype.onResize=function(){this.stage&&egret.setTimeout(this.refurbish,this,500)},e.prototype.refurbish=function(){this.setData(this._obj,this._data)},e.prototype.setData=function(t,e){if(null!=t){this._obj=t,this._data=e,this._obj.localToGlobal(0,0,this._objGlobalPoint),this._obj.getBounds(this._objRec),this._objGlobalPoint.x=Math.ceil(this._objGlobalPoint.x),this._objGlobalPoint.y=Math.ceil(this._objGlobalPoint.y);var i=15,n=15;this._objRec.x=this._objGlobalPoint.x-i,this._objRec.y=this._objGlobalPoint.y-n,this._objRec.width+=2*i,this._objRec.height+=2*n,this._bg.init(egret.MainContext.instance.stage.stageWidth,egret.MainContext.instance.stage.stageHeight),this._bg.draw(this._objRec),this._maskPic.cacheAsBitmap=!1,this._maskPic.x=this._objRec.x,this._maskPic.y=this._objRec.y,this._maskPic.width=this._objRec.width,this._maskPic.height=this._objRec.height,this._maskPic.cacheAsBitmap=!0,1==this._data.handDir?(this._handPic.scaleY=1,this._handPic.y=this._objRec.y+this._objRec.height-20):2==this._data.handDir&&(this._handPic.scaleY=-1,this._handPic.y=this._objRec.y+20),this._handPic.x=this._objRec.x+.5*this._objRec.width,this._txt.width=0/0,this._txt.height=0/0,this._txt.text=this._data.txt,this._txt.width>320&&(this._txt.text="",this._txt.width=320,this._txt.text=this._data.txt);var r=15;this._textBgPic.cacheAsBitmap=!1,this._textBgPic.width=this._txt.width+2*r+35,this._textBgPic.height=114,1==this._data.txtdir?(this._textBgPic.scaleX=-1,this._textBgPic.scaleY=1,this._textBgPic.x=this._objRec.x):2==this._data.txtdir?(this._textBgPic.scaleX=-1,this._textBgPic.scaleY=-1,this._textBgPic.x=this._objRec.x):3==this._data.txtdir?(this._textBgPic.scaleX=1,this._textBgPic.scaleY=1,this._textBgPic.x=this._objRec.x+this._objRec.width):4==this._data.txtdir&&(this._textBgPic.scaleX=1,this._textBgPic.scaleY=-1,this._textBgPic.x=this._objRec.x+this._objRec.width),this.checkTextBgX(),this._textBgPic.y=this._objRec.y+.5*this._objRec.height,this._txt.x=this._textBgPic.x-(-1==this._textBgPic.scaleX?this._textBgPic.width:-35)+r,this._txt.y=this._textBgPic.y-this._textBgPic.scaleY*this._textBgPic.height*.5,this._textBgPic.cacheAsBitmap=!0}},e.prototype.checkTextBgX=function(){if(1==this._textBgPic.scaleX){var t=egret.MainContext.instance.stage.stageWidth;this._textBgPic.x+this._textBgPic.width>t&&(this._textBgPic.x=t-this._textBgPic.width)}else-1==this._textBgPic.scaleX&&this._textBgPic.x-this._textBgPic.width<0&&(this._textBgPic.x=this._textBgPic.width)},e}(egret.Sprite);__reflect(GuideView.prototype,"GuideView");var EasyLoading=function(t){function e(){var e=t.call(this)||this;return e.content=null,e.speed=.6,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.averageUtils=new AverageUtils,this.content=new egret.Sprite,this.content.graphics.beginFill(0,.2),this.content.graphics.drawRect(0,0,App.StageUtils.getWidth(),App.StageUtils.getHeight()),this.content.graphics.endFill(),this.content.touchEnabled=!0,this.uiImageContainer=new egret.DisplayObjectContainer,this.uiImageContainer.x=.5*this.content.width,this.uiImageContainer.y=.5*this.content.height,this.content.addChild(this.uiImageContainer),this.label=new egret.TextField,this.content.addChild(this.label),this.label.width=this.content.width,this.label.textAlign=egret.HorizontalAlign.CENTER,this.label.y=.5*this.content.height+100,RES.getResByUrl("resource/assets/load_Reel.png",function(t){var e=new egret.Bitmap;e.texture=t,e.x=.5*-e.width,e.y=.5*-e.height,this.uiImageContainer.addChild(e)},this,RES.ResourceItem.TYPE_IMAGE)},e.prototype.showLoading=function(t){null==t||t.length<=0?this.label.text="":this.label.text=t,App.StageUtils.getStage().addChild(this.content),App.TimerManager.doFrame(1,0,this.enterFrame,this)},e.prototype.hideLoading=function(){this.content&&this.content.parent&&(App.StageUtils.getStage().removeChild(this.content),this.uiImageContainer.rotation=0),App.TimerManager.remove(this.enterFrame,this)},e.prototype.enterFrame=function(t){this.averageUtils.push(this.speed*t),this.uiImageContainer.rotation+=this.averageUtils.getValue()},e}(BaseClass);__reflect(EasyLoading.prototype,"EasyLoading");var ControllerManager=function(t){function e(){var e=t.call(this)||this;return e._modules={},e}return __extends(e,t),e.prototype.clear=function(){this._modules={}},e.prototype.register=function(t,e){this.isExists(t)||(this._modules[t]=e)},e.prototype.unregister=function(t){this.isExists(t)&&(this._modules[t]=null,delete this._modules[t])},e.prototype.isExists=function(t){return null!=this._modules[t]},e.prototype.applyFunc=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var r=this._modules[t];if(r){for(var s=[],o=1;o<arguments.length;o++)s[o-1]=arguments[o];return r.applyFunc.apply(r,s)}return Log.trace("模块"+t+"不存在"),null},e.prototype.getControllerModel=function(t){var e=this._modules[t];return e?e.getModel():null},e}(BaseClass);__reflect(ControllerManager.prototype,"ControllerManager");var ViewManager=function(t){function e(){var e=t.call(this)||this;return e._views={},e._opens=[],e}return __extends(e,t),e.prototype.clear=function(){this.closeAll(),this._views={}},e.prototype.register=function(t,e){null!=e&&(this._views[t]||(this._views[t]=e))},e.prototype.unregister=function(t){this._views[t]&&(this._views[t]=null,delete this._views[t])},e.prototype.destroy=function(t,e){void 0===e&&(e=null);var i=this.getView(t);i&&(this.unregister(t),i.destroy(),i=null),this.register(t,e)},e.prototype.open=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this.getView(t);return null==n?void Log.trace("UI_"+t+"不存在"):n.isShow()?(n.open.apply(n,e),n):(n.isInit()?(n.addToParent(),n.open.apply(n,e)):(App.EasyLoading.showLoading(),n.loadResource(function(){n.setVisible(!1),n.addToParent()}.bind(this),function(){n instanceof BaseEuiView||(n.initUI(),n.initData()),n.open.apply(n,e),n.setVisible(!0),App.EasyLoading.hideLoading()}.bind(this))),this._opens.push(t),n)},e.prototype.close=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(this.isShow(t)){var n=this.getView(t);if(null==n)return void this._opens.splice(r,1);var r=this._opens.indexOf(t);t>=0&&this._opens.splice(r,1),n.removeFromParent(),n.close.apply(n,e)}},e.prototype.closeView=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var n=Object.keys(this._views),r=0,s=n.length;s>r;r++){var o=parseInt(n[r]);if(this._views[o]==t)return void this.close(o,e)}},e.prototype.getView=function(t){return this._views[t]},e.prototype.closeAll=function(){for(;this._opens.length;)this.close(this._opens[0])},e.prototype.currOpenNum=function(){return this._opens.length},e.prototype.isShow=function(t){return-1!=this._opens.indexOf(t)},e}(BaseClass);__reflect(ViewManager.prototype,"ViewManager");var BaseModel=function(){function t(t){this._controller=t,this._controller.setModel(this)}return t}();__reflect(BaseModel.prototype,"BaseModel");var BaseProxy=function(){function t(t){this._controller=t}return t.prototype.applyFunc=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return this._controller.applyFunc.apply(this._controller,arguments)},t.prototype.applyControllerFunc=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return this._controller.applyControllerFunc.apply(this._controller,arguments)},t.prototype.receiveServerMsg=function(t,e,i){App.MessageCenter.addListener(t,e,i)},t.prototype.receiveServerMsgOnce=function(t,e,i){var n=function(r){this.removeServerMsg(t,n,this),e.apply(i,r)};this.receiveServerMsg(t,n,this)},t.prototype.receiveServerHttpUpdateMsg=function(t,e,i){this.receiveServerMsg(t+"_HttpUpdate",e,i)},t.prototype.receiveServerHttpUpdateMsgOnce=function(t,e,i){this.receiveServerMsgOnce(t+"_HttpUpdate",e,i)},t.prototype.removeServerMsg=function(t,e,i){App.MessageCenter.removeListener(t,e,i)},t.prototype.removeServerHttpUpdateMsg=function(t,e,i){this.removeServerMsg(t+"_HttpUpdate",e,i)},t.prototype.sendSocketMsg=function(t,e,i){App.Socket.send(t,e,i)},t.prototype.sendHttpMsg=function(t,e){void 0===e&&(e=null),App.Http.send(t,this.getURLVariables(t,e))},t.prototype.getURLVariables=function(t,e){var i=t.split("."),n={};n.mod=i[0],n["do"]=i[1],null!=e&&(n.p=e);var r=JSON.stringify(n),s=new egret.URLVariables("data="+r+"&h="+App.ProxyUserFlag);return s},t}();__reflect(BaseProxy.prototype,"BaseProxy");var BaseSpriteView=function(t){function e(e,i){var n=t.call(this)||this;return n._resources=null,n._controller=e,n._myParent=i,n._isInit=!1,App.StageUtils.getStage().addEventListener(egret.Event.RESIZE,n.onResize,n),n}return __extends(e,t),e.prototype.setResources=function(t){this._resources=t},Object.defineProperty(e.prototype,"myParent",{get:function(){return this._myParent},enumerable:!0,configurable:!0}),e.prototype.isInit=function(){return this._isInit},e.prototype.applyFunc=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return this._controller.applyFunc.apply(this._controller,arguments)},e.prototype.applyControllerFunc=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return this._controller.applyControllerFunc.apply(this._controller,arguments)},e.prototype.isShow=function(){return null!=this.stage&&this.visible},e.prototype.addToParent=function(){this._myParent.addChild(this)},e.prototype.removeFromParent=function(){App.DisplayUtils.removeFromParent(this)},e.prototype.initUI=function(){this._isInit=!0},e.prototype.initData=function(){},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.destroy=function(){this._controller=null,this._myParent=null,this._resources=null},e.prototype.onResize=function(){},e.prototype.loadResource=function(t,e){this._resources&&this._resources.length>0?App.ResourceUtils.loadResource(this._resources,[],function(){t(),e()},null,this):(t(),e())},e.prototype.setVisible=function(t){this.visible=t},e}(egret.DisplayObjectContainer);__reflect(BaseSpriteView.prototype,"BaseSpriteView",["IBaseView"]);var DynamicChange=function(){function t(){this._dataCache=[],this._pUpdate=new ProxyUpdate(this._dataCache)}return Object.defineProperty(t.prototype,"pUpdate",{get:function(){return this._pUpdate},enumerable:!0,configurable:!0}),t.prototype.getCacheData=function(t){return this._dataCache[t]?this._dataCache[t]:null},t.prototype.clearCache=function(){for(var t=Object.keys(this._dataCache),e=0,i=t.length;i>e;e++){var n=t[e];this._dataCache[n]=null,delete this._dataCache[n]}},t.prototype.getCacheKeyInfos=function(){for(var t=[],e=Object.keys(this._dataCache),i=0,n=e.length;n>i;i++){var r=e[i],s=this._dataCache[r];t.push(s)}return t},t.prototype.isCache=function(t){return this._dataCache[t]},t}();__reflect(DynamicChange.prototype,"DynamicChange");var ProxyUpdate=function(){function t(t){this._cache=t}return t.prototype.isArray=function(t){return t instanceof Array},t.prototype.isObject=function(t){return t.indexOf("object")>-1},t.prototype.isNormal=function(t){var e=t.indexOf("@")>-1,i=t.indexOf(".")>-1,n=t.indexOf("_")>-1;return!e&&!i&&!n},t.prototype.isAddToArray=function(t){return"@a"==t},t.prototype.isRemoveToArray=function(t){var e=t.split("_");return e.length<=3&&"@d"==e[0]},t.prototype.isFilter=function(t){var e=t.split("_");return"@f"==e[0]},t.prototype.isNumeric=function(t){return parseFloat(t).toString()==t.toString()},t.prototype._updateObject=function(t,e,i){var n=t.split(".");"@a"==n[0]||"@s"==n[0]?i[n[1]]=e:"@d"==n[0]&&delete i[n[1]]},t.prototype._getFilterObject=function(t,e){if(e){var i=t.split("_");if(3==i.length&&"@f"==i[0]&&this.isArray(e))for(var n=i[1],r=i[2],s=0;s<e.length;s++){var o=e[s];if(3==i.length&&this.isObject(o.toString())){var a=o[n];if(a&&("@"==r[0]&&(r=r.replace("@","")),r==a))return o}}}return null},t.prototype._addObjectToArray=function(t,e){if(this.isArray(e))for(var i=0;i<e.length;i++)t.push(e[i]);else t.push(e)},t.prototype._removeObjectFromArray=function(t,e,i){var n=e.split("_");if(n.length<=3&&"@d"==n[0]&&this.isArray(t))for(var r=t.length,s=r-1;s>=0;s--){var o=t[s];if(3==n.length){if(o.hasOwnProperty(n[1])){var a=n[2];"@"==a[0]&&(a=a.replace("@","")),a==o[n[1]]&&t.splice(s,1)}}else 2==n.length&&o.hasOwnProperty(n[1])?i==o[n[1]]&&t.splice(s,1):1==n.length&&i==o&&t.splice(s,1)}},t.prototype.update=function(t,e){if(this._cache[t]=e,e.hasOwnProperty("c"))for(var i=e.c,n=Object.keys(i),r=0,s=n.length;s>r;r++){var o=n[r];this._cache[o]&&(this._update(this._cache[o],i[o]),App.MessageCenter.dispatch(o+"_HttpUpdate"))}},t.prototype._update=function(t,e){if(t&&e&&this.isObject(e.toString()))for(var i=Object.keys(e),n=0,r=i.length;r>n;n++){var s=i[n],o=e[s];if(this.isNormal(s)&&this.isObject(o.toString()))t.hasOwnProperty(s)&&this._update(t[s],o);else if(this.isNormal(s)&&this.isNumeric(o)){var a=t[s];t[s]=a+o}else if(this.isNormal(s))t[s]=o;else if(this.isAddToArray(s))this._addObjectToArray(t,o);else if(this.isRemoveToArray(s))this._removeObjectFromArray(t,s,o);else if(this.isFilter(s)){var h=this._getFilterObject(s,t);h&&this._update(h,o)}else this._updateObject(s,o,t)}},t}();__reflect(ProxyUpdate.prototype,"ProxyUpdate");var Http=function(t){function e(){var e=t.call(this)||this;return e._data=new DynamicChange,e._cache=[],e._request=new egret.URLRequest,e._request.method=egret.URLRequestMethod.POST,e._urlLoader=new egret.URLLoader,e._urlLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,e.onError,e),e}return __extends(e,t),e.prototype.initServer=function(t){this._serverUrl=t},Object.defineProperty(e.prototype,"Data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype.onError=function(t){this.nextPost()},e.prototype.send=function(t,e){this._cache.push([t,e]),this.post()},e.prototype.post=function(){if(!this._isRequesting&&0!=this._cache.length){var t=this._cache.shift(),e=t[0],i=t[1];this._type=e,this._request.url=this._serverUrl,this._request.data=i,this._urlLoader.addEventListener(egret.Event.COMPLETE,this.onLoaderComplete,this),this._urlLoader.load(this._request),this._isRequesting=!0}},e.prototype.onLoaderComplete=function(t){this._urlLoader.removeEventListener(egret.Event.COMPLETE,this.onLoaderComplete,this);var e=JSON.parse(this._urlLoader.data);e.hasOwnProperty("s")&&0!=e.s?Log.trace("Http错误:"+e.s):(this._data.pUpdate.update(this._type,e),App.MessageCenter.dispatch(this._type,e)),this.nextPost()},e.prototype.nextPost=function(){this._isRequesting=!1,this.post()},e}(BaseClass);__reflect(Http.prototype,"Http");var ByteArrayMsgByProtobuf=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.decode=function(t){var e=t.readShort();if(t.bytesAvailable>=e+8){var i=t.readInt(),n=t.readInt(),r=new egret.ByteArray;t.readBytes(r,0,e);var s={};return s.id=n,s.sid=i,s.body=App.MsgFactory.decode(n,r.buffer),s}return null},e.prototype.encode=function(t){var e=t.id,i=App.MsgFactory.encode(e,t),n=new egret.ByteArray(i.toArrayBuffer()),r=n.length,s=this.getSid()^r^512,o=new egret.ByteArray;return o.writeShort(r),o.writeInt(s),o.writeInt(e),o.writeBytes(n),o},e}(ByteArrayMsg);__reflect(ByteArrayMsgByProtobuf.prototype,"ByteArrayMsgByProtobuf");var MsgFactory=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.registerAll=function(){this.reqMsg=RES.getRes("reqMsg");for(var t in this.reqMsg){var e=this.reqMsg[t],i=e.file;i&&(e.proto=dcodeIO.ProtoBuf.loadProto(i))}this.resMsg=RES.getRes("resMsg");for(var n in this.resMsg){var r=this.resMsg[n],i=r.file;i&&(r.proto=dcodeIO.ProtoBuf.loadProto(i))}},e.prototype.encode=function(t,e){var i=this.reqMsg[t];if(i){var n=i.proto.build(i.name);return new n(e)}return null},e.prototype.decode=function(t,e){var i=this.resMsg[t];if(i||(i=this.reqMsg[t]),i){var n=i.proto.build(i.name);return n.decode(e)}},e}(BaseClass);__reflect(MsgFactory.prototype,"MsgFactory");var Socket=function(t){function e(){var e=t.call(this)||this;return e._needReconnect=!0,e._maxReconnectCount=45,e._reconnectCount=1,e._reconnectTime=2e3,e._reconnecting=!1,e._reconnectTimeout=!1,e._startReconnect=!1,e}return __extends(e,t),e.prototype.addEvents=function(){this._socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this._socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)},e.prototype.removeEvents=function(){this._socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this._socket.removeEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.removeEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)},e.prototype.onSocketOpen=function(){this._reconnectCount=1,this._reconnecting=!1,this._reconnectTimeout=!1,this._startReconnect=!1,this._isConnecting=!0,App.EasyLoading.hideLoading(),this._connectFlag&&this._needReconnect?App.MessageCenter.dispatch(SocketConst.SOCKET_RECONNECT):App.MessageCenter.dispatch(SocketConst.SOCKET_CONNECT),this._connectFlag=!0},e.prototype.onSocketClose=function(){console.log("onSocketClose"),this._isConnecting=!1,this._needReconnect?this.reconnect():App.MessageCenter.dispatch(SocketConst.SOCKET_CLOSE)},e.prototype.onSocketError=function(){console.log("onSocketError"),this._needReconnect?this.reconnect():App.MessageCenter.dispatch(SocketConst.SOCKET_NOCONNECT),this._isConnecting=!1},e.prototype.onReceiveMessage=function(t){this._msg.receive(this._socket)},e.prototype.initServer=function(t,e,i,n){this._host=t,this._port=e,this._url=i,this._msg=n},e.prototype.connect=function(){return App.DeviceUtils.IsHtml5&&!window.WebSocket?void Log.trace("不支持WebSocket"):(this._socket=new egret.WebSocket,this._msg instanceof ByteArrayMsg&&(this._socket.type=egret.WebSocket.TYPE_BINARY),Log.trace("WebSocket: "+this._host+":"+this._port),this.addEvents(),this._socket.connectByUrl(this._url),void App.EasyLoading.showLoading("连接服务器 ..."))},e.prototype.reconnect=function(){this._reconnectCount>this._maxReconnectCount&&this._reconnecting||this._reconnectTimeout?(this._reconnectCount=1,this._reconnecting=!1,App.MessageCenter.dispatch(SocketConst.SOCKET_CLOSE)):this._startReconnect&&(this._startReconnect=!1),this._reconnecting||this._reconnectTimeout||this.isConnecting()||(App.EasyLoading.showLoading("正在重连 ..."),this._reconnecting=!0,App.TimerManager.doTimer(this._reconnectTime,this._maxReconnectCount,function(){this.isConnecting()||(this._reconnectCount++,App.IsNetAvaliable&&!this._startReconnect&&(this._startReconnect=!0,App.MessageCenter.dispatch(SocketConst.SOCKET_START_RECONNECT),this.closeCurrentSocket(),this.connect()))},this,function(){this.isConnecting()||(0==this._startReconnect&&App.MessageCenter.dispatch(SocketConst.SOCKET_CLOSE),this._reconnectTimeout=!0)},this))},e.prototype.send=function(t,e,i){this._msg.send(this._socket,t,e,i)},e.prototype.close=function(){this._connectFlag=!1,this.closeCurrentSocket()},e.prototype.closeCurrentSocket=function(){this.removeEvents(),this._socket.close(),this._socket=null,this._msg.resetSid(),this._isConnecting=!1},e.prototype.isConnecting=function(){return this._isConnecting},e.prototype.debugInfo=function(t){App.MessageCenter.dispatch(SocketConst.SOCKET_DEBUG_INFO,t)},e}(BaseClass);__reflect(Socket.prototype,"Socket");var SocketConst=function(){function t(){}return t.SOCKET_CONNECT="SOCKET_CONNECT",t.SOCKET_RECONNECT="SOCKET_RECONNECT",t.SOCKET_START_RECONNECT="SOCKET_START_RECONNECT",t.SOCKET_CLOSE="SOCKET_CLOSE",t.SOCKET_DATA="SOCKET_DATA",t.SOCKET_NOCONNECT="SOCKET_NOCONNECT",t.SOCKET_DEBUG_INFO="SOCKET_DEBUG_INFO",t}();__reflect(SocketConst.prototype,"SocketConst");var UTFMsgByJson=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.decode=function(t){return JSON.parse(t)},e.prototype.encode=function(t){return JSON.stringify(t)},e}(UTFMsg);__reflect(UTFMsgByJson.prototype,"UTFMsgByJson");var BaseSpriteLayer=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(BaseSpriteLayer.prototype,"BaseSpriteLayer");var SceneManager=function(t){function e(){var e=t.call(this)||this;return e._scenes={},e}return __extends(e,t),e.prototype.clear=function(){var t=this._scenes[this._currScene];t&&(t.onExit(),this._currScene=void 0),this._scenes={}},e.prototype.register=function(t,e){this._scenes[t]=e},e.prototype.runScene=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this._scenes[t];if(null==n)return void Log.trace("场景"+t+"不存在");var r=this._scenes[this._currScene];r&&r.onExit(),n.onEnter.apply(n,e),this._currScene=t},e.prototype.getCurrScene=function(){return this._currScene},e}(BaseClass);__reflect(SceneManager.prototype,"SceneManager");var SoundBg=function(t){function e(){var e=t.call(this)||this;return e._currBg="",e}return __extends(e,t),e.prototype.stop=function(){this._currSoundChannel&&this._currSoundChannel.stop(),this._currSoundChannel=null,this._currSound=null,this._currBg=""},e.prototype.play=function(t){if(this._currBg!=t){this.stop(),this._currBg=t;var e=this.getSound(t);e&&this.playSound(e)}},e.prototype.playSound=function(t){this._currSound=t,this._currSoundChannel=this._currSound.play(0,0),this._currSoundChannel.volume=this._volume},e.prototype.setVolume=function(t){this._volume=t,this._currSoundChannel&&(this._currSoundChannel.volume=this._volume)},e.prototype.loadedPlay=function(t){this._currBg==t&&this.playSound(RES.getRes(t))},e.prototype.checkCanClear=function(t){return this._currBg!=t},e}(BaseSound);__reflect(SoundBg.prototype,"SoundBg");var SoundEffects=function(t){function e(){var e=t.call(this)||this;return e._soundChannels=[],e}return __extends(e,t),e.prototype.play=function(t,e){var i=this.getSound(t);i&&this.playSound(i,e)},e.prototype.playSound=function(t,e){var i=1;null!=e&&(i=e);var n=t.play(0,i);n.volume=this._volume,this._soundChannels.push(n)},e.prototype.setVolume=function(t){this._volume=t},e.prototype.loadedPlay=function(t){this.playSound(RES.getRes(t))},e.prototype.stopEffect=function(){for(var t=0;t<this._soundChannels.length;t++)this._soundChannels[t].stop();this._soundChannels=[]},e}(BaseSound);__reflect(SoundEffects.prototype,"SoundEffects");var SoundManager=function(t){function e(){var e=t.call(this)||this;return e.bgOn=!0,e.effectOn=!0,e.bgVolume=.5,e.effectVolume=.8,e.bg=new SoundBg,e.bg.setVolume(e.bgVolume),e.effect=new SoundEffects,e.effect.setVolume(e.effectVolume),e}return __extends(e,t),e.prototype.playEffect=function(t,e){this.effectOn&&this.effect.play(t,e)},e.prototype.stopEffect=function(){this.effect.stopEffect()},e.prototype.playBg=function(t){this.currBg=t,this.bgOn&&this.bg.play(t)},e.prototype.stopBg=function(){this.bg.stop()},e.prototype.setEffectOn=function(t){this.effectOn=t},e.prototype.setBgOn=function(t){this.bgOn=t,this.bgOn?this.currBg&&this.playBg(this.currBg):this.stopBg()},e.prototype.setBgVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.bgVolume=t,this.bg.setVolume(this.bgVolume)},e.prototype.getBgVolume=function(){return this.bgVolume},e.prototype.setEffectVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.effectVolume=t,this.effect.setVolume(this.effectVolume)},e.prototype.getEffectVolume=function(){return this.effectVolume},e.CLEAR_TIME=18e4,e}(BaseClass);__reflect(SoundManager.prototype,"SoundManager");var starlingswf;!function(t){var e=function(){function e(i,n,r){void 0===r&&(r=24),this._swfData=i,this._assetManager=n,this._createDisplayFuns=new Object,this._createDisplayFuns[e.dataKey_Sprite]=this.createSprite,this._createDisplayFuns[e.dataKey_MovieClip]=this.createMovie,this._createDisplayFuns[e.dataKey_Image]=this.createImage,this._createDisplayFuns[e.dataKey_Scale9]=this.createS9Image,this._createDisplayFuns[e.dataKey_ShapeImg]=this.createShapeImage,this._createDisplayFuns[e.dataKey_TextField]=this.createTextField,this.swfUpdateManager=t.SwfUpdateManager.createSwfUpdateManager(r)}return e.prototype.createSprite=function(i,n,r){void 0===n&&(n=null),void 0===r&&(r=null),null==r&&(r=this._swfData[e.dataKey_Sprite][i]);for(var s,o,a,h=new t.SwfSprite,c=r.length,l=0;c>l;l++)s=r[l],a=this._createDisplayFuns[s[1]],null!=a&&(o=a.apply(this,[s[0],s]),o.name=s[9],o.x=s[2],o.y=s[3],s[0]==e.dataKey_TextField,s[1]!=e.dataKey_Scale9&&s[1]!=e.dataKey_ShapeImg&&(o.scaleX=s[4],o.scaleY=s[5]),o.skewX=s[6],o.skewY=s[7],o.alpha=s[8],h.addChild(o));return h},e.prototype.createMovie=function(i,n,r){void 0===n&&(n=null),void 0===r&&(r=null);var s,o,a,h,c,l=this._swfData[e.dataKey_MovieClip][i],p=l.objCount,u={};for(c in p){o=p[c][0],a=p[c][1],s=null==u[c]?[]:u[c];for(var g=0;a>g;g++)h=this._createDisplayFuns[o],null!=h&&s.push(h.apply(this,[c,null]));u[c]=s}var f;return f=null==r?new t.SwfMovieClip(l.frames,l.labels,u,this):new r(l.frames,l.labels,u,this),f.loop=l.loop,f},e.prototype.createImage=function(t,i){void 0===i&&(i=null);var n=this._swfData[e.dataKey_Image][t],r=this._assetManager.createBitmap(t);return r.anchorOffsetX=n[0],r.anchorOffsetY=n[1],r},e.prototype.getTexture=function(t){return this._assetManager.getTexture(t)},e.prototype.createS9Image=function(t,i){void 0===i&&(i=null);var n=this._swfData[e.dataKey_Scale9][t],r=this._assetManager.createBitmap(t);return r.scale9Grid=new egret.Rectangle(n[0],n[1],n[2],n[3]),null!=i&&(r.width=i[10],r.height=i[11]),r},e.prototype.createShapeImage=function(t,e){void 0===e&&(e=null);var i=this._assetManager.createBitmap(t);return i.fillMode=egret.BitmapFillMode.REPEAT,null!=e&&(i.width=e[10],i.height=e[11]),i},e.prototype.createTextField=function(t,e){void 0===e&&(e=null);var i=new egret.TextField;return null!=e&&(i.width=e[10],i.height=e[11],i.textColor=e[13],i.size=e[14],i.textAlign=e[15],i.text=e[18]),i
},e.prototype.hasSprite=function(t){return null!=this._swfData[e.dataKey_Sprite][t]},e.prototype.hasMovieClip=function(t){return null!=this._swfData[e.dataKey_MovieClip][t]},e.prototype.hasImage=function(t){return null!=this._swfData[e.dataKey_Image][t]},e.prototype.hasS9Image=function(t){return null!=this._swfData[e.dataKey_Scale9][t]},e.prototype.hasShapeImage=function(t){return null!=this._swfData[e.dataKey_ShapeImg][t]},e.dataKey_Sprite="spr",e.dataKey_Image="img",e.dataKey_MovieClip="mc",e.dataKey_TextField="text",e.dataKey_Button="btn",e.dataKey_Scale9="s9",e.dataKey_ShapeImg="shapeImg",e.dataKey_Component="comp",e.dataKey_Particle="particle",e}();t.Swf=e,__reflect(e.prototype,"starlingswf.Swf")}(starlingswf||(starlingswf={}));var starlingswf;!function(t){var e=function(){function t(){this._sheets={},this._textures={}}return t.prototype.addSpriteSheet=function(t,e){this._sheets[t]=e},t.prototype.addTexture=function(t,e){this._textures[t]=e},t.prototype.createBitmap=function(t){var e=this.getTexture(t);if(null==e)return null;var i=new egret.Bitmap;return i.texture=e,i},t.prototype.getTexture=function(t){var e,i,n;for(n in this._sheets)if(i=this._sheets[n],e=i.getTexture(t),null!=e)break;return null==e&&(e=this._textures[t]),e},t}();t.SwfAssetManager=e,__reflect(e.prototype,"starlingswf.SwfAssetManager")}(starlingswf||(starlingswf={}));var starlingswf;!function(t){var e=function(){function t(){}return t.createSwfUpdateManager=function(e){var i=new t;return i._animations=[],i._addQueue=[],i._removeQueue=[],i._currentTime=0,i.setFps(e),App.TimerManager.doFrame(1,0,i.update,i),i},t.prototype.clear=function(){this._addQueue.splice(0),this._removeQueue.splice(0),this._animations.splice(0)},t.prototype.stop=function(){this.clear(),App.TimerManager.remove(this.update,this)},t.prototype.play=function(){App.TimerManager.doFrame(1,0,this.update,this)},t.prototype.setFps=function(t){this._fps=t,this._fpsTime=1e3/t},t.prototype.addSwfAnimation=function(t){this._addQueue.push(t)},t.prototype.removeSwfAnimation=function(t){this._removeQueue.push(t);var e=this._addQueue.indexOf(t);-1!=e&&this._addQueue.splice(e,1)},t.prototype.updateAdd=function(){for(var t,e,i=this._addQueue.length,n=0;i>n;n++)e=this._addQueue.pop(),t=this._animations.indexOf(e),-1==t&&this._animations.push(e)},t.prototype.updateRemove=function(){for(var t,e,i=this._removeQueue.length,n=0;i>n;n++)e=this._removeQueue.pop(),t=this._animations.indexOf(e),-1!=t&&this._animations.splice(t,1)},t.prototype.update=function(t){if(this._currentTime+=t,!(this._currentTime<this._fpsTime)){this._currentTime-=this._fpsTime,this._update();for(var e=0;this._currentTime>this._fpsTime;)this._currentTime-=this._fpsTime,e++,4>e&&this._update()}},t.prototype._update=function(){this.updateRemove(),this.updateAdd();for(var t=this._animations.length,e=0;t>e;e++)this._animations[e].update()},t}();t.SwfUpdateManager=e,__reflect(e.prototype,"starlingswf.SwfUpdateManager")}(starlingswf||(starlingswf={}));var StarlingSwfFactory=function(t){function e(){var e=t.call(this)||this;return e.swfAssetsManager=new starlingswf.SwfAssetManager,e.swfAssetsNames=new Array,e.swfAssets=new Array,e.swfData={},e}return __extends(e,t),e.prototype.addSwf=function(t,e,i){if(-1==this.swfAssetsNames.indexOf(t)){if(null==e||null==i)return void console.log("SWF加载失败:"+t);this.swfAssetsManager.addSpriteSheet(t,i);var n=new starlingswf.Swf(e,this.swfAssetsManager,24);n.name=t,StarlingSwfUtils.addSwf(n),this.swfAssetsNames.push(t),this.swfAssets.push(n)}},e.prototype.stopSwfs=function(t){for(var e=0,i=t.length;i>e;e++){var n=StarlingSwfUtils.getSwf(t[e]);n&&n.swfUpdateManager.stop()}},e.prototype.playSwfs=function(t){for(var e=0,i=t.length;i>e;e++){var n=StarlingSwfUtils.getSwf(t[e]);n&&n.swfUpdateManager.play()}},e.prototype.clearSwfs=function(){for(;this.swfAssets.length;)StarlingSwfUtils.removeSwf(this.swfAssets.pop());for(;this.swfAssetsNames.length;)this.swfAssetsNames.pop();this.swfAssetsManager=new starlingswf.SwfAssetManager},e.prototype.clear=function(){this.clearSwfs()},e.prototype.makeMc=function(t){var e=StarlingSwfUtils.createMovie("mc_"+t,null,StarlingSwfMovieClip);return null==e&&console.log("SWF创建失败: "+t),e},e.prototype.makeImage=function(t){return StarlingSwfUtils.createImage("img_"+t)},e.prototype.getTexture=function(t){return StarlingSwfUtils.getTexture("img_"+t)},e}(BaseClass);__reflect(StarlingSwfFactory.prototype,"StarlingSwfFactory");var StarlingSwfMovieClip=function(t){function e(e,i,n,r){var s=t.call(this,e,i,n,r)||this;return s.frameActions={},s.preFrame=-1,s.addEventListener(egret.Event.REMOVED_FROM_STAGE,s.onRemove,s),s}return __extends(e,t),e.prototype.onRemove=function(){this.stop()},e.prototype.setFrameAction=function(t,e,i,n){void 0===n&&(n=null),this.frameActions[t]=[e,i,n]},e.prototype.setCompleteAction=function(t,e){this.complateFunc=t,this.complateObj=e,this.addEventListener(egret.Event.COMPLETE,this.onPlayend,this)},e.prototype.onPlayend=function(){this.complateFunc&&this.complateFunc.call(this.complateObj)},e.prototype.goToPlay=function(t){this.preFrame=-1,this.currFrameName=t,this.gotoAndPlay(t)},e.prototype.setCurrentFrame=function(e){t.prototype.setCurrentFrame.call(this,e);var i=this.getCurrentFrame();if(this.preFrame!=i&&(this.preFrame=i,this.frameActions&&this.frameActions[i])){var n=this.frameActions[i];n[2]?n[0].call(n[1],n[2]):n[0].call(n[1])}},e.prototype.dispose=function(){this.stop(),this.removeEventListener(egret.Event.COMPLETE,this.onPlayend,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),App.DisplayUtils.removeFromParent(this),this.complateFunc=null,this.complateObj=null,this.frameActions=null},e}(starlingswf.SwfMovieClip);__reflect(StarlingSwfMovieClip.prototype,"StarlingSwfMovieClip");var StarlingSwfUtils=function(){function t(){}return t.addSwf=function(e){t.swfList.push(e)},t.removeSwf=function(e){var i=t.swfList.indexOf(e);-1!=i&&t.swfList.splice(i,1)},t.createSprite=function(e,i,n){void 0===i&&(i=null),void 0===n&&(n=null);for(var r=t.swfList.length,s=0;r>s;s++){var o=t.swfList[s];if(o.hasSprite(e))return o.createSprite(e,i,n)}return null},t.createImage=function(e,i){void 0===i&&(i=null);for(var n=t.swfList.length,r=0;n>r;r++){var s=t.swfList[r];if(s.hasImage(e))return s.createImage(e,i)}return null},t.getTexture=function(e){for(var i=t.swfList.length,n=0;i>n;n++){var r=t.swfList[n];if(r.hasImage(e))return r.getTexture(e)}return null},t.createMovie=function(e,i,n){void 0===i&&(i=null),void 0===n&&(n=null);for(var r=t.swfList.length,s=0;r>s;s++){var o=t.swfList[s];if(o.hasMovieClip(e))return o.createMovie(e,i,n)}return null},t.createS9Image=function(e,i){void 0===i&&(i=null);for(var n=t.swfList.length,r=0;n>r;r++){var s=t.swfList[r];if(s.hasS9Image(e))return s.createS9Image(e,i)}return null},t.createShapeImage=function(e,i){void 0===i&&(i=null);for(var n=t.swfList.length,r=0;n>r;r++){var s=t.swfList[r];if(s.hasShapeImage(e))return s.createShapeImage(e,i)}return null},t.getSwf=function(e){for(var i=t.swfList.length,n=0;i>n;n++){var r=t.swfList[n];if(r.name==e)return r}return null},t.fixButton=function(e,i,n){t.firstAddBtn&&(t.firstAddBtn=!1,egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),egret.MainContext.instance.stage.addEventListener(egret.Event.LEAVE_STAGE,this.onTouchEnd,this));var r=new StarlingSwfButtonData;r.btn=e,r.onClick=i,r.thisObj=n,t.btnList.push(r),e.touchEnabled=!0,e.gotoAndStop(0),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBtnTouchBegin,e)},t.onBtnTouchBegin=function(e){for(var i=e.currentTarget,n=t.btnList.length,r=0;n>r;r++){var s=t.btnList[r];if(s.btn==i){s.touchStageX=e.stageX,s.touchStageY=e.stageY,i.gotoAndStop(1);break}}},t.onTouchEnd=function(e){for(var i=t.btnList.length,n=0;i>n;n++){var r=t.btnList[n];-1!=r.touchStageX&&(e.stageX&&Math.abs(r.touchStageX-e.stageX)<10&&Math.abs(r.touchStageY-e.stageY)<10&&r.onClick&&r.onClick.call(r.thisObj,e),r.touchStageX=-1,r.touchStageY=-1,r.btn.gotoAndStop(0))}},t.swfList=[],t.btnList=[],t.firstAddBtn=!0,t}();__reflect(StarlingSwfUtils.prototype,"StarlingSwfUtils");var StarlingSwfButtonData=function(){function t(){this.touchStageX=-1,this.touchStageY=-1}return t}();__reflect(StarlingSwfButtonData.prototype,"StarlingSwfButtonData");var AllAsyncExecutor=function(){function t(){this._functions=new Array,this._complateNum=0}return t.prototype.setCallBack=function(t,e){this._callBack=t,this._callBackTarget=e},t.prototype.regist=function(t,e){this._functions.push([t,e])},t.prototype.start=function(){App.ArrayUtils.forEach(this._functions,function(t){t[0].call(t[1])},this)},t.prototype.complate=function(){this._functions&&(this._complateNum++,this._complateNum==this._functions.length&&(this._callBack&&this._callBack.call(this._callBackTarget),this._callBack=null,this._callBackTarget=null,this._functions=null))},t}();__reflect(AllAsyncExecutor.prototype,"AllAsyncExecutor");var AnchorUtil=function(){function t(){}return t.init=function(){t._propertyChange=Object.create(null),t._anchorChange=Object.create(null),t.injectAnchor()},t.setAnchorX=function(t,e){t.anchorX=e},t.setAnchorY=function(t,e){t.anchorY=e},t.setAnchor=function(t,e){t.anchorX=t.anchorY=e},t.getAnchor=function(t){return t.anchorX!=t.anchorY&&console.log("target's anchorX != anchorY"),t.anchorX||0},t.getAnchorY=function(t){return t.anchorY||0},t.getAnchorX=function(t){return t.anchorX||0},t.injectAnchor=function(){Object.defineProperty(egret.DisplayObject.prototype,"width",{get:function(){return this.$getWidth()},set:function(e){var i=this;this.$setWidth(e),t._propertyChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"height",{get:function(){return this.$getHeight()},set:function(e){var i=this;this.$setHeight(e),t._propertyChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"anchorX",{get:function(){return this._anchorX},set:function(e){var i=this;this._anchorX=e,t._propertyChange[this.hashCode]=!0,t._anchorChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"anchorY",{get:function(){return this._anchorY},set:function(e){var i=this;this._anchorY=e,t._propertyChange[this.hashCode]=!0,t._anchorChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0})},t.changeAnchor=function(e){t._propertyChange[e.hashCode]&&t._anchorChange[e.hashCode]&&(e.anchorOffsetX=e._anchorX*e.width,e.anchorOffsetY=e._anchorY*e.height,delete t._propertyChange[e.hashCode])},t}();__reflect(AnchorUtil.prototype,"AnchorUtil");var ArrayUtils=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.forEach=function(t,e,i){for(var n=0,r=t.length;r>n;n++)e.apply(i,[t[n]])},e}(BaseClass);__reflect(ArrayUtils.prototype,"ArrayUtils");var AverageUtils=function(){function t(t){void 0===t&&(t=10),this.nums=[],this.numsLen=0,this.numSum=0,this.maxNum=t}return t.prototype.push=function(t){this.numsLen>this.maxNum&&(this.numsLen--,this.numSum-=this.nums.shift()),this.nums.push(t),this.numSum+=t,this.numsLen++},t.prototype.getValue=function(){return this.numSum/this.numsLen},t.prototype.clear=function(){this.nums.splice(0),this.numsLen=0,this.numSum=0},t}();__reflect(AverageUtils.prototype,"AverageUtils");var CommonUtils=function(t){function e(){var e=t.call(this)||this;return e.labelIsOverLenght=function(t,e){var i=null;i=1e5>e?e:1e6>e?Math.floor(e/1e3/10).toString()+"万":Math.floor(e/1e4).toString()+"万",t.text=i},e}return __extends(e,t),e.prototype.addLableStrokeColor=function(t,e,i){t.strokeColor=e,t.stroke=i},e.prototype.copyDataHandler=function(t){var e;if(t instanceof Array)e=[];else{if(!(t instanceof Object))return t;e={}}for(var i=Object.keys(t),n=0,r=i.length;r>n;n++){var s=i[n];e[s]=this.copyDataHandler(t[s])}return e},e.prototype.lock=function(){var t=App.StageUtils.getStage();t.$children.forEach(function(t){t instanceof egret.DisplayObjectContainer&&(t.touchEnabled=t.touchChildren=!1)})},e.prototype.unlock=function(){var t=App.StageUtils.getStage();t.$children.forEach(function(t){t instanceof egret.DisplayObjectContainer&&(t.touchEnabled=t.touchChildren=!0)})},e.prototype.int64ToNumber=function(t){return parseInt(t.toString())},e}(BaseClass);__reflect(CommonUtils.prototype,"CommonUtils");var DateUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getFormatBySecond=function(t,e){void 0===e&&(e=1);var i="";switch(e){case 1:i=this.getFormatBySecond1(t);break;case 2:i=this.getFormatBySecond2(t);break;case 3:i=this.getFormatBySecond3(t);break;case 4:i=this.getFormatBySecond4(t);break;case 5:i=this.getFormatBySecond5(t)}return i},e.prototype.getFormatBySecond1=function(t){void 0===t&&(t=0);var e,i=Math.floor(t/3600);e=0==i?"00":10>i?"0"+i:""+i;var n,r,s=Math.floor((t-3600*i)/60),o=Math.floor((t-3600*i)%60);return n=0==s?"00":10>s?"0"+s:""+s,r=0==o?"00":10>o?"0"+o:""+o,e+":"+n+":"+r},e.prototype.getFormatBySecond3=function(t){void 0===t&&(t=0);var e,i,n=Math.floor(t/3600),r=Math.floor((t-3600*n)/60),s=Math.floor((t-3600*n)%60);return e=0==r?"00":10>r?"0"+r:""+r,i=0==s?"00":10>s?"0"+s:""+s,e+":"+i},e.prototype.getFormatBySecond2=function(t){var e=new Date(t),i=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),s=e.getHours(),o=e.getMinutes(),a=e.getSeconds();return i+"-"+n+"-"+r+" "+s+":"+o+":"+a},e.prototype.getFormatBySecond4=function(t){var e=Math.floor(t/3600);return e>0?e>24?Math.floor(e/24)+"天前":e+"小时前":Math.floor(t/60)+"分钟前"},e.prototype.getFormatBySecond5=function(t){var e=86400,i=3600,n=60,r=Math.floor(t/e),s=Math.floor(t%e/i),o=Math.floor((t-s*i)/n),a=Math.floor((t-s*i)%n),h="",c="",l="",p="";return t>0?0==r?(h="",0==s?(c="",0==o?(l="",p=0==a?"":10>a?"0"+a+"秒":""+a+"秒"):(l=""+o+"分",p=0==a?"":10>a?"0"+a+"秒":""+a+"秒",l+p)):(c=s+"小时",0==o?(l="",p=0==a?"":10>a?"0"+a+"秒":""+a+"秒"):(l=10>o?"0"+o+"分":""+o+"分",c+l))):(h=r+"天",c=0==s?"":10>s?"0"+s+"小时":""+s+"小时",h+c):""},e}(BaseClass);__reflect(DateUtils.prototype,"DateUtils");var DebugUtils=function(t){function e(){var e=t.call(this)||this;return e._threshold=3,e._startTimes={},e}return __extends(e,t),e.prototype.isOpen=function(t){this._isOpen=t},Object.defineProperty(e.prototype,"isDebug",{get:function(){return this._isOpen},enumerable:!0,configurable:!0}),e.prototype.start=function(t){this._isOpen&&(this._startTimes[t]=egret.getTimer())},e.prototype.stop=function(t){if(!this._isOpen)return 0;if(!this._startTimes[t])return 0;var e=egret.getTimer()-this._startTimes[t];return e>this._threshold&&Log.trace(t+": "+e),e},e.prototype.setThreshold=function(t){this._threshold=t},e}(BaseClass);__reflect(DebugUtils.prototype,"DebugUtils");var DelayOptManager=function(t){function e(){var e=t.call(this)||this;return e.TIME_THRESHOLD=2,e._delayOpts=[],App.TimerManager.doFrame(1,0,e.runCachedFun,e),e}return __extends(e,t),e.prototype.addDelayOptFunction=function(t,e,i,n,r){this._delayOpts.push({fun:e,funPara:i,thisObj:t,callBack:n,para:r})},e.prototype.clear=function(){this._delayOpts.length=0},e.prototype.stop=function(){App.TimerManager.remove(this.runCachedFun,this)},e.prototype.runCachedFun=function(t){if(0!=this._delayOpts.length)for(var e,i=egret.getTimer();this._delayOpts.length&&(e=this._delayOpts.shift(),e.funPara?e.fun.call(e.thisObj,e.funPara):e.fun.call(e.thisObj),e.callBack&&(void 0!=e.para?e.callBack.call(e.thisObj,e.para):e.callBack()),!(egret.getTimer()-i>this.TIME_THRESHOLD)););},e}(BaseClass);__reflect(DelayOptManager.prototype,"DelayOptManager");var DeviceUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"IsHtml5",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WEB},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsNative",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsMobile",{get:function(){return egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsPC",{get:function(){return!egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsQQBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MQQBrowser")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsIEBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MSIE")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsFirefoxBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Firefox")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsChromeBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Chrome")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsSafariBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Safari")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsOperaBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Opera")},enumerable:!0,configurable:!0}),e}(BaseClass);__reflect(DeviceUtils.prototype,"DeviceUtils");var DisplayUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createBitmap=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.createEuiImage=function(t){var e=new eui.Image,i=RES.getRes(t);return e.source=i,e},e.prototype.removeFromParent=function(t){null!=t.parent&&t.parent.removeChild(t)},e}(BaseClass);__reflect(DisplayUtils.prototype,"DisplayUtils");var EffectUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.macIconShake=function(t,e){for(var i=[[20,300],[15,300],[10,300],[5,300]],n="egret.Tween.get("+t+")",r=0,s=i.length;s>r;r++)n+=".to({'y':"+e+"-"+i[r][0]+"}, "+i[r][1]+")",n+=".to({'y':"+e+"}, "+i[r][1]+")";return n+=";"},e.prototype.startFlicker=function(t,e){t.alpha=1,egret.Tween.get(t).to({alpha:0},e).to({alpha:1},e).call(this.startFlicker,this,[t,e])},e.prototype.stopFlicker=function(t){egret.Tween.removeTweens(t)},e}(BaseClass);__reflect(EffectUtils.prototype,"EffectUtils");var EgretExpandUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){AnchorUtil.init()},e}(BaseClass);__reflect(EgretExpandUtils.prototype,"EgretExpandUtils");var FrameDelay=function(){function t(){}return t.prototype.delayCall=function(t,e,i){this.func=e,this.thisObj=i,egret.callLater(function(){App.TimerManager.doFrame(t,1,this.listener_enterFrame,this)},this)},t.prototype.listener_enterFrame=function(){this.func.call(this.thisObj)},t}();__reflect(FrameDelay.prototype,"FrameDelay");var FrameExecutor=function(){function t(t){this.delayFrame=t,this.frameDelay=new FrameDelay,this.functions=new Array}return t.prototype.regist=function(t,e){this.functions.push([t,e])},t.prototype.execute=function(){if(this.functions.length){var t=this.functions.shift();t[0].call(t[1]),this.frameDelay.delayCall(this.delayFrame,this.execute,this)}},t}();__reflect(FrameExecutor.prototype,"FrameExecutor");var KeyboardUtils=function(t){function e(){var e=t.call(this)||this;if(e.key_ups=new Array,e.key_downs=new Array,App.DeviceUtils.IsHtml5){var i=e;document.addEventListener("keyup",function(t){for(var e=0,n=i.key_ups.length;n>e;e++){var r=i.key_ups[e][0],s=i.key_ups[e][1];s?r.call(s,t.keyCode):r(t.keyCode)}}),document.addEventListener("keydown",function(t){for(var e=0,n=i.key_downs.length;n>e;e++){var r=i.key_downs[e][0],s=i.key_downs[e][1];s?r.call(s,t.keyCode):r(t.keyCode)}})}return e}return __extends(e,t),e.prototype.addKeyUp=function(t,e){this.key_ups.push([t,e])},e.prototype.addKeyDown=function(t,e){this.key_downs.push([t,e])},e.prototype.removeKeyUp=function(t,e){for(var i=0;i<this.key_ups.length;i++)this.key_ups[i][0]==t&&this.key_ups[i][1]==e&&(this.key_ups.splice(i,1),i--)},e.prototype.removeKeyDown=function(t,e){for(var i=0;i<this.key_downs.length;i++)this.key_downs[i][0]==t&&this.key_downs[i][1]==e&&(this.key_downs.splice(i,1),i--)},e}(BaseClass);__reflect(KeyboardUtils.prototype,"KeyboardUtils");var LocationProperty=function(){function t(){}return t.getPara=function(t,e){if(egret.MainContext.runtimeType==egret.MainContext.RUNTIME_NATIVE)return null;var i=e||location.href;if(-1!=i.indexOf("?")){var n="&"+i.split("?")[1],r=new RegExp("&"+t+"=.*?(?:&|$)"),s=r.exec(n);if(s){var o=s[0];return o.split("&")[1].split("=")[1]}}return null},t.setProperty=function(t,e,i){var n=i||location.href,r="&"+n.split("?")[1];if(-1==n.indexOf("?"))return n+="?"+t+"="+e;var r=n.split("?")[1];if(""==r)return n+=t+"="+e;var s=new RegExp("(?:^|&)"+t+"=.*?(?:&|$)"),o=s.exec(r);if(o&&""!=o[0]){var a=o[0],h=new RegExp("=.*$"),c=a.replace(h,"="+e);return n.replace(a,c)}return n+="&"+t+"="+e},t.hasProperty=function(t,e){var i=e||location.href,n="&"+i.split("?")[1];return-1!=n.indexOf("&"+t+"=")},t}();__reflect(LocationProperty.prototype,"LocationProperty");var Log=function(){function t(){}return t.trace=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];App.DebugUtils.isDebug&&(t[0]="[DebugLog]"+t[0],console.log.apply(console,t))},t}();__reflect(Log.prototype,"Log");var MathUtils=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getAngle=function(t){return 180*t/Math.PI},e.prototype.getRadian=function(t){return t/180*Math.PI},e.prototype.getRadian2=function(t,e,i,n){var r=i-t,s=n-e;return Math.atan2(s,r)},e.prototype.getDistance=function(t,e,i,n){var r=i-t,s=n-e,o=r*r+s*s;return Math.sqrt(o)},e.prototype.getDistanceByPoint=function(t,e){var i=t.x-e.x,n=t.y-e.y,r=i*i+n*n;return Math.sqrt(r)},e.prototype.range=function(t,e){return Math.round(Math.random()*(e-t))+t},e}(BaseClass);__reflect(MathUtils.prototype,"MathUtils");var md5=function(){function t(){this.hexcase=0,this.b64pad=""}return t.prototype.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},t.prototype.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.any_hmac_md5=function(t,e,i){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),i)},t.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},t.prototype.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.prototype.rstr_hmac_md5=function(t,e){var i=this.rstr2binl(t);i.length>16&&(i=this.binl_md5(i,8*t.length));for(var n=Array(16),r=Array(16),s=0;16>s;s++)n[s]=909522486^i[s],r[s]=1549556828^i[s];var o=this.binl_md5(n.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(r.concat(o),640))},t.prototype.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var i,n=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",r="",s=0;s<t.length;s++)i=t.charCodeAt(s),r+=n.charAt(i>>>4&15)+n.charAt(15&i);return r},t.prototype.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",r=t.length,s=0;r>s;s+=3)for(var o=t.charCodeAt(s)<<16|(r>s+1?t.charCodeAt(s+1)<<8:0)|(r>s+2?t.charCodeAt(s+2):0),a=0;4>a;a++)n+=8*s+6*a>8*t.length?this.b64pad:i.charAt(o>>>6*(3-a)&63);return n},t.prototype.rstr2any=function(t,e){var i,n,r,s,o,a=e.length,h=Array(Math.ceil(t.length/2));for(i=0;i<h.length;i++)h[i]=t.charCodeAt(2*i)<<8|t.charCodeAt(2*i+1);var c=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),l=Array(c);for(n=0;c>n;n++){for(o=Array(),s=0,i=0;i<h.length;i++)s=(s<<16)+h[i],r=Math.floor(s/a),s-=r*a,(o.length>0||r>0)&&(o[o.length]=r);l[n]=s,h=o}var p="";for(i=l.length-1;i>=0;i--)p+=e.charAt(l[i]);return p},t.prototype.str2rstr_utf8=function(t){for(var e,i,n="",r=-1;++r<t.length;)e=t.charCodeAt(r),i=r+1<t.length?t.charCodeAt(r+1):0,e>=55296&&56319>=e&&i>=56320&&57343>=i&&(e=65536+((1023&e)<<10)+(1023&i),r++),127>=e?n+=String.fromCharCode(e):2047>=e?n+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?n+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(n+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return n},t.prototype.str2rstr_utf16le=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(255&t.charCodeAt(i),t.charCodeAt(i)>>>8&255);return e},t.prototype.str2rstr_utf16be=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t.charCodeAt(i)>>>8&255,255&t.charCodeAt(i));return e},t.prototype.rstr2binl=function(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(var i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<i%32;return e},t.prototype.binl2rstr=function(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e},t.prototype.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var i=1732584193,n=-271733879,r=-1732584194,s=271733878,o=0;o<t.length;o+=16){var a=i,h=n,c=r,l=s;i=this.md5_ff(i,n,r,s,t[o+0],7,-680876936),s=this.md5_ff(s,i,n,r,t[o+1],12,-389564586),r=this.md5_ff(r,s,i,n,t[o+2],17,606105819),n=this.md5_ff(n,r,s,i,t[o+3],22,-1044525330),i=this.md5_ff(i,n,r,s,t[o+4],7,-176418897),s=this.md5_ff(s,i,n,r,t[o+5],12,1200080426),r=this.md5_ff(r,s,i,n,t[o+6],17,-1473231341),n=this.md5_ff(n,r,s,i,t[o+7],22,-45705983),i=this.md5_ff(i,n,r,s,t[o+8],7,1770035416),s=this.md5_ff(s,i,n,r,t[o+9],12,-1958414417),r=this.md5_ff(r,s,i,n,t[o+10],17,-42063),n=this.md5_ff(n,r,s,i,t[o+11],22,-1990404162),i=this.md5_ff(i,n,r,s,t[o+12],7,1804603682),s=this.md5_ff(s,i,n,r,t[o+13],12,-40341101),r=this.md5_ff(r,s,i,n,t[o+14],17,-1502002290),n=this.md5_ff(n,r,s,i,t[o+15],22,1236535329),i=this.md5_gg(i,n,r,s,t[o+1],5,-165796510),s=this.md5_gg(s,i,n,r,t[o+6],9,-1069501632),r=this.md5_gg(r,s,i,n,t[o+11],14,643717713),n=this.md5_gg(n,r,s,i,t[o+0],20,-373897302),i=this.md5_gg(i,n,r,s,t[o+5],5,-701558691),s=this.md5_gg(s,i,n,r,t[o+10],9,38016083),r=this.md5_gg(r,s,i,n,t[o+15],14,-660478335),n=this.md5_gg(n,r,s,i,t[o+4],20,-405537848),i=this.md5_gg(i,n,r,s,t[o+9],5,568446438),s=this.md5_gg(s,i,n,r,t[o+14],9,-1019803690),r=this.md5_gg(r,s,i,n,t[o+3],14,-187363961),n=this.md5_gg(n,r,s,i,t[o+8],20,1163531501),i=this.md5_gg(i,n,r,s,t[o+13],5,-1444681467),s=this.md5_gg(s,i,n,r,t[o+2],9,-51403784),r=this.md5_gg(r,s,i,n,t[o+7],14,1735328473),n=this.md5_gg(n,r,s,i,t[o+12],20,-1926607734),i=this.md5_hh(i,n,r,s,t[o+5],4,-378558),s=this.md5_hh(s,i,n,r,t[o+8],11,-2022574463),r=this.md5_hh(r,s,i,n,t[o+11],16,1839030562),n=this.md5_hh(n,r,s,i,t[o+14],23,-35309556),i=this.md5_hh(i,n,r,s,t[o+1],4,-1530992060),s=this.md5_hh(s,i,n,r,t[o+4],11,1272893353),r=this.md5_hh(r,s,i,n,t[o+7],16,-155497632),n=this.md5_hh(n,r,s,i,t[o+10],23,-1094730640),i=this.md5_hh(i,n,r,s,t[o+13],4,681279174),s=this.md5_hh(s,i,n,r,t[o+0],11,-358537222),r=this.md5_hh(r,s,i,n,t[o+3],16,-722521979),n=this.md5_hh(n,r,s,i,t[o+6],23,76029189),i=this.md5_hh(i,n,r,s,t[o+9],4,-640364487),s=this.md5_hh(s,i,n,r,t[o+12],11,-421815835),r=this.md5_hh(r,s,i,n,t[o+15],16,530742520),n=this.md5_hh(n,r,s,i,t[o+2],23,-995338651),i=this.md5_ii(i,n,r,s,t[o+0],6,-198630844),s=this.md5_ii(s,i,n,r,t[o+7],10,1126891415),r=this.md5_ii(r,s,i,n,t[o+14],15,-1416354905),n=this.md5_ii(n,r,s,i,t[o+5],21,-57434055),i=this.md5_ii(i,n,r,s,t[o+12],6,1700485571),s=this.md5_ii(s,i,n,r,t[o+3],10,-1894986606),r=this.md5_ii(r,s,i,n,t[o+10],15,-1051523),n=this.md5_ii(n,r,s,i,t[o+1],21,-2054922799),i=this.md5_ii(i,n,r,s,t[o+8],6,1873313359),s=this.md5_ii(s,i,n,r,t[o+15],10,-30611744),r=this.md5_ii(r,s,i,n,t[o+6],15,-1560198380),n=this.md5_ii(n,r,s,i,t[o+13],21,1309151649),i=this.md5_ii(i,n,r,s,t[o+4],6,-145523070),s=this.md5_ii(s,i,n,r,t[o+11],10,-1120210379),r=this.md5_ii(r,s,i,n,t[o+2],15,718787259),n=this.md5_ii(n,r,s,i,t[o+9],21,-343485551),i=this.safe_add(i,a),n=this.safe_add(n,h),r=this.safe_add(r,c),s=this.safe_add(s,l)}return[i,n,r,s]},t.prototype.md5_cmn=function(t,e,i,n,r,s){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(n,s)),r),i)},t.prototype.md5_ff=function(t,e,i,n,r,s,o){return this.md5_cmn(e&i|~e&n,t,e,r,s,o)},t.prototype.md5_gg=function(t,e,i,n,r,s,o){return this.md5_cmn(e&n|i&~n,t,e,r,s,o)},t.prototype.md5_hh=function(t,e,i,n,r,s,o){return this.md5_cmn(e^i^n,t,e,r,s,o)},t.prototype.md5_ii=function(t,e,i,n,r,s,o){return this.md5_cmn(i^(e|~n),t,e,r,s,o)},t.prototype.safe_add=function(t,e){var i=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(i>>16);return n<<16|65535&i},t.prototype.bit_rol=function(t,e){return t<<e|t>>>32-e},t}();__reflect(md5.prototype,"md5");var MessageCenter=function(t){function e(e){var i=t.call(this)||this;return i.type=e,i.dict={},i.eVec=new Array,i.lastRunTime=0,0==i.type&&App.TimerManager.doFrame(1,0,i.run,i),i}return __extends(e,t),e.prototype.clear=function(){this.dict={},this.eVec.splice(0)},e.prototype.addListener=function(t,e,i){var n=this.dict[t];null==n&&(n=new Array,this.dict[t]=n);var r=0,s=n.length;for(r;s>r;r++)if(n[r][0]==e&&n[r][1]==i)return;n.push([e,i])},e.prototype.removeListener=function(t,e,i){var n=this.dict[t];if(null!=n){var r=0,s=n.length;for(r;s>r;r++)if(n[r][0]==e&&n[r][1]==i){n.splice(r,1);break}0==n.length&&(this.dict[t]=null,delete this.dict[t])}},e.prototype.removeAll=function(t){for(var e=Object.keys(this.dict),i=0,n=e.length;n>i;i++){for(var r=e[i],s=this.dict[r],o=0;o<s.length;o++)s[o][1]==t&&(s.splice(o,1),o--);0==s.length&&(this.dict[r]=null,delete this.dict[r])}},e.prototype.dispatch=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(null!=this.dict[t]){var n=ObjectPool.pop("MessageVo");n.type=t,n.param=e,0==this.type?this.eVec.push(n):1==this.type?this.dealMsg(n):Log.trace("MessageCenter未实现的类型")}},e.prototype.run=function(){var t=egret.getTimer(),e=t-this.lastRunTime>100;if(this.lastRunTime=t,e)for(;this.eVec.length>0;)this.dealMsg(this.eVec.shift());else for(;this.eVec.length>0&&(this.dealMsg(this.eVec.shift()),!(egret.getTimer()-t>5)););},e.prototype.dealMsg=function(t){var e=this.dict[t.type];if(e){for(var i=0,n=e.length,r=null;n>i;)r=e[i],r[0].apply(r[1],t.param),e.length!=n&&(n=e.length,i--),i++;t.dispose(),ObjectPool.push(t)}},e}(BaseClass);__reflect(MessageCenter.prototype,"MessageCenter");var MessageVo=function(){function t(){}return t.prototype.dispose=function(){this.type=null,this.param=null},t}();__reflect(MessageVo.prototype,"MessageVo");var ObjectPool=function(){function t(){this._objs=new Array}return t.prototype.pushObj=function(t){this._objs.push(t)},t.prototype.popObj=function(){return this._objs.length>0?this._objs.pop():null},t.prototype.clear=function(){for(;this._objs.length>0;)this._objs.pop()},t.pop=function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];t._content[e]||(t._content[e]=[]);var r=t._content[e];if(r.length)return r.pop();var s,o=egret.getDefinitionByName(e),a=i.length;return 0==a?s=new o:1==a?s=new o(i[0]):2==a?s=new o(i[0],i[1]):3==a?s=new o(i[0],i[1],i[2]):4==a?s=new o(i[0],i[1],i[2],i[3]):5==a&&(s=new o(i[0],i[1],i[2],i[3],i[4])),s.ObjectPoolKey=e,s},t.popWithExtraKey=function(e,i){t._content[e]||(t._content[e]=[]);var n,r=t._content[e];if(r.length)for(var s=0;s<r.length;s++)if(r[s].extraKey==i){n=r[s],r.splice(s,1);break}if(!n){var o=egret.getDefinitionByName(e);n=new o(i),n.extraKey=i,n.ObjectPoolKey=e}return n},t.push=function(e){if(null==e)return!1;
var i=e.ObjectPoolKey;return t._content[i]?(t._content[i].push(e),!0):!1},t.clear=function(){t._content={}},t.clearClass=function(e,i){void 0===i&&(i=null);for(var n=t._content[e];n&&n.length;){var r=n.pop();i&&r[i](),r=null}t._content[e]=null,delete t._content[e]},t.dealFunc=function(e,i){var n=t._content[e];if(null!=n){var r=0,s=n.length;for(r;s>r;r++)n[r][i]()}},t._content={},t}();__reflect(ObjectPool.prototype,"ObjectPool");var Percent=function(){function t(t,e){this.currentValue=t,this.totalValue=e}return t.prototype.computePercent=function(){return this.currentValue/this.totalValue*100},t.prototype.computeRate=function(){return this.currentValue/this.totalValue},t.prototype.reverse=function(){return this.currentValue=this.totalValue-this.currentValue,this},t.prototype.copy=function(){return new t(this.currentValue,this.totalValue)},t.prototype.computePercentReverse=function(){return(this.totalValue-this.currentValue)/this.totalValue*100},t.prototype.computeRateReverse=function(){return(this.totalValue-this.currentValue)/this.totalValue},t}();__reflect(Percent.prototype,"Percent");var QueueExecutor=function(){function t(){this._functions=new Array}return t.prototype.setCallBack=function(t,e){this._callBack=t,this._callBackTarget=e},t.prototype.regist=function(t,e){this._functions.push([t,e])},t.prototype.start=function(){this.next()},t.prototype.next=function(){if(this._functions)if(0==this._functions.length)this._callBack&&this._callBack.call(this._callBackTarget),this._callBack=null,this._callBackTarget=null,this._functions=null;else{var t=this._functions.shift();t[0].call(t[1])}},t}();__reflect(QueueExecutor.prototype,"QueueExecutor");var RandomUtils=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.limit=function(t,e){t=Math.min(t,e),e=Math.max(t,e);var i=e-t;return t+Math.random()*i},e.prototype.limitInteger=function(t,e){return Math.round(this.limit(t,e))},e.prototype.randomArray=function(t){var e=Math.floor(Math.random()*t.length);return t[e]},e}(BaseClass);__reflect(RandomUtils.prototype,"RandomUtils");var RenderTextureManager=function(t){function e(){var e=t.call(this)||this;return e._pool=[],e._useNum=0,e.isLowerQQBrowser()?e._maxNum=18:e._maxNum=-1,e}return __extends(e,t),e.prototype.isLowerQQBrowser=function(){if(App.DeviceUtils.IsQQBrowser){for(var t=["2013022","Lenovo A630t","SM-G3818","vivo X3t","GT-I9100"],e=!1,i=0,n=t.length;n>i;i++)if(-1!=navigator.userAgent.indexOf(t[i])){e=!0;break}return e}return!1},e.prototype.pop=function(){var t=this._pool.pop();return t||(-1==this._maxNum||this._useNum<this._maxNum)&&(t=new egret.RenderTexture,this._useNum++),t},e.prototype.push=function(t){for(var e=!1,i=0,n=this._pool.length;n>i;i++)if(this._pool[i]==t){e=!0;break}e||this._pool.push(t)},e}(BaseClass);__reflect(RenderTextureManager.prototype,"RenderTextureManager");var ResourceUtils=function(t){function e(){var e=t.call(this)||this;return e._groupIndex=0,e._configs=new Array,e._groups={},RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,e.onResourceLoadComplete,e),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,e.onResourceLoadProgress,e),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,e.onResourceLoadError,e),e}return __extends(e,t),e.prototype.addConfig=function(t,e){this._configs.push([t,e])},e.prototype.loadConfig=function(t,e){this._onConfigComplete=t,this._onConfigCompleteTarget=e,this.loadNextConfig()},e.prototype.loadNextConfig=function(){if(0==this._configs.length)return this._onConfigComplete.call(this._onConfigCompleteTarget),this._onConfigComplete=null,void(this._onConfigCompleteTarget=null);var t=this._configs.shift();RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),RES.loadConfig(t[0],t[1])},e.prototype.onConfigCompleteHandle=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),this.loadNextConfig()},e.prototype.loadGroup=function(t,e,i,n){this._groups[t]=[e,i,n],RES.loadGroup(t)},e.prototype.loadGroups=function(t,e,i,n,r){RES.createGroup(t,e,!0),this.loadGroup(t,i,n,r)},e.prototype.pilfererLoadGroup=function(t,e){void 0===e&&(e=null);var i="pilferer_"+t;e||(e=[t]),RES.createGroup(i,e,!0),RES.loadGroup(i,-1)},e.prototype.onResourceLoadComplete=function(t){var e=t.groupName;if(this._groups[e]){var i=this._groups[e][0],n=this._groups[e][2];null!=i&&i.apply(n,[e]),this._groups[e]=null,delete this._groups[e]}},e.prototype.onResourceLoadProgress=function(t){var e=t.groupName;if(this._groups[e]){var i=this._groups[e][1],n=this._groups[e][2];null!=i&&i.call(n,t.itemsLoaded,t.itemsTotal)}},e.prototype.onResourceLoadError=function(t){Log.trace(t.groupName+"资源组有资源加载失败"),this.onResourceLoadComplete(t)},e.prototype.loadResource=function(t,e,i,n,r){void 0===t&&(t=[]),void 0===e&&(e=[]),void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=null);var s=t.concat(e),o="loadGroup"+this._groupIndex++;RES.createGroup(o,s,!0),this._groups[o]=[i,n,r],RES.loadGroup(o)},e.prototype.createGroup=function(t,e){RES.createGroup(t,e,!0)},e.prototype.createResource=function(t,e,i){var n={name:t,type:e,url:i};RES.parseConfig({resources:[n]})},e}(BaseClass);__reflect(ResourceUtils.prototype,"ResourceUtils");var ResVersionManager=function(t){function e(){var e=t.call(this)||this;return e.res_loadByVersion(),e}return __extends(e,t),e.prototype.res_loadByVersion=function(){RES.web.Html5VersionController.prototype.getVirtualUrl=function(t){var i="",n=e.resVersionData,r=t.substring(9);return n&&n[r]&&(i=n[r]),0==i.length&&(i=window.version),t+=-1==t.indexOf("?")?"?v="+i:"&v="+i}},e.prototype.loadConfig=function(t,e,i){this.complateFunc=e,this.complateFuncTarget=i,RES.getResByUrl(t,this.loadResVersionComplate,this)},e.prototype.loadResVersionComplate=function(t){e.resVersionData=t,this.complateFunc.call(this.complateFuncTarget)},e}(BaseClass);__reflect(ResVersionManager.prototype,"ResVersionManager");var RockerUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(t,e,i,n){this.keys=[0,0],this.mouseX=-1,this.mouseY=-1,this.moveFlag=e,this.moveFlagX=e.x,this.moveFlagY=e.y,this.moveFlagGoX=this.moveFlagX,this.moveFlagGoY=this.moveFlagY,this.moveFlagWidthHelf=.5*t.width,this.moveFlagRec=new egret.Rectangle(this.moveFlagX-.5*t.width,this.moveFlagY-.5*t.height,t.width,t.height),this.moveFlagCheckRec=new egret.Rectangle(0,0,.5*App.StageUtils.getWidth(),App.StageUtils.getHeight()),this.dealKeyFunc=i,this.dealKeyTarget=n,this.moveFlag.touchEnabled=!0,this.moveFlag.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startMove,this),this.moveFlag.addEventListener(egret.TouchEvent.TOUCH_END,this.stopMove,this),this.moveFlag.addEventListener(egret.TouchEvent.TOUCH_TAP,this.stopEvent,this),App.StageUtils.getStage().addEventListener(egret.TouchEvent.TOUCH_END,this.leaveStateEvent,this),App.StageUtils.getStage().addEventListener(egret.TouchEvent.TOUCH_MOVE,this.heroMoveEvent,this),App.KeyboardUtils.addKeyDown(this.onKeyDown,this),App.KeyboardUtils.addKeyUp(this.onKeyUp,this)},e.prototype.onKeyDown=function(t){switch(t){case Keyboard.A:this.keys[0]=-1,this.startCheckKey();break;case Keyboard.D:this.keys[0]=1,this.startCheckKey();break;case Keyboard.W:this.keys[1]=-1,this.startCheckKey();break;case Keyboard.S:this.keys[1]=1,this.startCheckKey()}},e.prototype.onKeyUp=function(t){switch(t){case Keyboard.A:-1==this.keys[0]&&(this.keys[0]=0);break;case Keyboard.D:1==this.keys[0]&&(this.keys[0]=0);break;case Keyboard.W:-1==this.keys[1]&&(this.keys[1]=0);break;case Keyboard.S:1==this.keys[1]&&(this.keys[1]=0)}},e.prototype.stopEvent=function(t){t.stopPropagation()},e.prototype.leaveStateEvent=function(t){t.stageX==this.mouseX&&t.stageY==this.mouseY&&this.stopMove()},e.prototype.startMove=function(t){this.isMoveing=!0,this.moveFlagGoX=this.moveFlagX,this.moveFlagGoY=this.moveFlagY,this.mouseX=t.stageX,this.mouseY=t.stageY},e.prototype.stopMove=function(){this.isMoveing=!1,this.keys[0]=0,this.keys[1]=0,this.moveFlagGoX=this.moveFlagX,this.moveFlagGoY=this.moveFlagY,this.mouseX=-1,this.mouseY=-1},e.prototype.resetRockerPos=function(){this.moveFlag.x=this.moveFlagX,this.moveFlag.y=this.moveFlagY},e.prototype.heroMoveEvent=function(t){this.runMove(t.stageX,t.stageY)},e.prototype.runMove=function(t,e){if(this.isMoveing&&(this.moveFlagCheckRec.contains(t,e)||!(Math.abs(this.mouseX-t)>50||Math.abs(this.mouseY-e)>50))){if(this.mouseX=t,this.mouseY=e,this.moveFlagRec.contains(this.mouseX,this.mouseY))this.moveFlagGoX=this.mouseX,this.moveFlagGoY=this.mouseY;else{var i=App.MathUtils.getRadian2(this.moveFlagX,this.moveFlagY,this.mouseX,this.mouseY);this.moveFlagGoX=this.moveFlagX+Math.cos(i)*this.moveFlagWidthHelf,this.moveFlagGoY=this.moveFlagY+Math.sin(i)*this.moveFlagWidthHelf}this.moveFlagGoX>this.moveFlagX&&Math.abs(this.moveFlagGoX-this.moveFlagX)>10?this.keys[0]=1:this.moveFlagGoX<this.moveFlagX&&Math.abs(this.moveFlagGoX-this.moveFlagX)>10?this.keys[0]=-1:this.keys[0]=0,this.moveFlagGoY>this.moveFlagY&&Math.abs(this.moveFlagGoY-this.moveFlagY)>10?this.keys[1]=1:this.moveFlagGoY<this.moveFlagY&&Math.abs(this.moveFlagGoY-this.moveFlagY)>10?this.keys[1]=-1:this.keys[1]=0,this.startCheckKey()}},e.prototype.startCheckKey=function(){this.checkKeying||(this.checkKeying=!0,App.TimerManager.doFrame(1,0,this.delKeys,this))},e.prototype.stopCheckKey=function(){this.keys[0]=0,this.keys[1]=0,this.checkKeying&&(App.TimerManager.remove(this.delKeys,this),this.checkKeying=!1)},e.prototype.delKeys=function(){-1==this.mouseX||this.moveFlagCheckRec.contains(this.mouseX,this.mouseY)||this.stopMove(),this.moveFlag.x!=this.moveFlagGoX&&(this.moveFlag.x=this.moveFlagGoX),this.moveFlag.y!=this.moveFlagGoY&&(this.moveFlag.y=this.moveFlagGoY),this.keys[0]||this.keys[1]||this.stopCheckKey(),this.dealKeyFunc.call(this.dealKeyTarget,this.keys[0],this.keys[1])||this.resetRockerPos()},e.prototype.stop=function(){this.stopCheckKey(),this.stopMove()},e}(BaseClass);__reflect(RockerUtils.prototype,"RockerUtils");var ShockUtils=function(t){function e(){var e=t.call(this)||this;return e.MAP=0,e.SPRITE=1,e.mapPoss=[new egret.Point(0,5),new egret.Point(0,0),new egret.Point(0,-5)],e.spritePoss=[new egret.Point(-5,-5),new egret.Point(5,-5),new egret.Point(0,0),new egret.Point(-5,5),new egret.Point(5,5)],e._shockLength=0,e._shockCount=0,e._rx=0,e._ry=0,e._type=0,e._repeatCount=0,e}return __extends(e,t),e.prototype.destroy=function(){this.stop()},e.prototype.shock=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=null),void 0===i&&(i=3),this._target||(this._type=t,this._target=e,this._type==this.MAP?(this._shockPoss=this.mapPoss.concat(),this._shockLength=this._shockPoss.length):this._type==this.SPRITE&&(this._shockPoss=this.spritePoss.concat(),this._shockLength=this._shockPoss.length),this.start(i))},e.prototype.start=function(t){void 0===t&&(t=1),this.repeatCount=t,this._shockCount=0,this._target&&(this._type!=this.MAP&&(this._rx=this._target.x),this._ry=this._target.y,App.TimerManager.doFrame(1,0,this.onShockEnter,this))},e.prototype.stop=function(){this._target&&(this._type!=this.MAP&&(this._target.x=this._rx),this._target.y=this._ry,App.TimerManager.remove(this.onShockEnter,this)),this._target=null},e.prototype.onShockEnter=function(t){var e=this._shockLength*this._repeatCount;if(this._shockCount>=e)return void this.stop();var i=this._shockCount%this._shockLength,n=this._shockPoss[i];this._target&&(this._type!=this.MAP&&(this._target.x=this._rx+n.x),this._target.y=this._ry+n.y),this._shockCount++},Object.defineProperty(e.prototype,"repeatCount",{get:function(){return this._repeatCount},set:function(t){this._repeatCount=t},enumerable:!0,configurable:!0}),e}(BaseClass);__reflect(ShockUtils.prototype,"ShockUtils");var StageUtils=function(t){function e(){var i=t.call(this)||this;return null==e._uiStage&&(e._uiStage=new eui.UILayer,e._uiStage.percentHeight=100,e._uiStage.percentWidth=100,e._uiStage.touchEnabled=!1,i.getStage().addChild(e._uiStage)),i}return __extends(e,t),e.prototype.getHeight=function(){return this.getStage().stageHeight},e.prototype.getWidth=function(){return this.getStage().stageWidth},e.prototype.setTouchChildren=function(t){this.getStage().touchChildren=t},e.prototype.setMaxTouches=function(t){this.getStage().maxTouches=t},e.prototype.setFrameRate=function(t){this.getStage().frameRate=t},e.prototype.setScaleMode=function(t){this.getStage().scaleMode=t},e.prototype.getStage=function(){return egret.MainContext.instance.stage},e.prototype.getUIStage=function(){return e._uiStage},e.prototype.startFullscreenAdaptation=function(t,e,i){this.designWidth=t,this.designHeight=e,this.resizeCallback=i,this.stageOnResize()},e.prototype.stageOnResize=function(){this.getStage().removeEventListener(egret.Event.RESIZE,this.stageOnResize,this);var t=this.designWidth,e=this.designHeight,i=window.innerWidth,n=window.innerHeight,r=i/n,s=t/e,o=r/s;if(r>s){var a=o,h=o;t=Math.floor(t*a),e=Math.floor(e*h)}this.getStage().setContentSize(t,e),this.resizeCallback&&this.resizeCallback(),this.getStage().addEventListener(egret.Event.RESIZE,this.stageOnResize,this)},e}(BaseClass);__reflect(StageUtils.prototype,"StageUtils");var StringBuffer=function(){function t(){this._strings=new Array}return t.prototype.append=function(t){this._strings.push(t)},t.prototype.toString=function(){return this._strings.join("")},t.prototype.clear=function(){this._strings.length=0},t}();__reflect(StringBuffer.prototype,"StringBuffer");var StringUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.trimSpace=function(t){return t.replace(/^\s*(.*?)[\s\n]*$/g,"$1")},e.prototype.getStringLength=function(t){for(var e=t.split(""),i=0,n=0;n<e.length;n++){var r=e[n];i+=this.isChinese(r)?2:1}return i},e.prototype.isChinese=function(t){var e=/^.*[\u4E00-\u9FA5]+.*$/;return e.test(t)},e.prototype.isPhone=function(t){var e=/^[1][3,4,5,7,8][0-9]{9}$/;return e.test(t)},e.prototype.isEmpty=function(t){return null==t||t.length<=0},e}(BaseClass);__reflect(StringUtils.prototype,"StringUtils");var TextFlowMaker=function(t){function e(){var e=t.call(this)||this;return e.STYLE_COLOR="C",e.STYLE_SIZE="S",e.PROP_TEXT="T",e}return __extends(e,t),e.prototype.generateTextFlow=function(t){for(var e=t.split("|"),i=[],n=0,r=e.length;r>n;n++)i.push(this.getSingleTextFlow(e[n]));return i},e.prototype.getSingleTextFlow=function(t){for(var e,i=t.split("&"),n={style:{}},r=0,s=i.length;s>r;r++)e=i[r].split(":"),e[0]==this.PROP_TEXT?n.text=e[1]:e[0]==this.STYLE_SIZE?n.style.size=parseInt(e[1]):e[0]==this.STYLE_COLOR?n.style.textColor=parseInt(e[1]):n.text=e[0];return n},e}(BaseClass);__reflect(TextFlowMaker.prototype,"TextFlowMaker");var TimerManager=function(t){function e(){var e=t.call(this)||this;return e._handlers=new Array,e._delHandlers=new Array,e._currTime=egret.getTimer(),e._currFrame=0,e._count=0,e._timeScale=1,egret.Ticker.getInstance().register(e.onEnterFrame,e),e}return __extends(e,t),e.prototype.setTimeScale=function(t){this._timeScale=t},e.prototype.onEnterFrame=function(){this._currFrame++,this._currTime=egret.getTimer(),App.DebugUtils.start("TimerManager:");for(var t=0;t<this._count;t++){var e=this._handlers[t],i=e.userFrame?this._currFrame:this._currTime;i>=e.exeTime&&(App.DebugUtils.start(e.method.toString()),e.method.call(e.methodObj,(this._currTime-e.dealTime)*this._timeScale),App.DebugUtils.stop(e.method.toString()),e.dealTime=this._currTime,e.exeTime+=e.delay,e.repeat||(e.repeatCount>1?e.repeatCount--:(e.complateMethod&&e.complateMethod.apply(e.complateMethodObj),this._delHandlers.push(e))))}for(;this._delHandlers.length;){var e=this._delHandlers.pop();this.remove(e.method,e.methodObj)}App.DebugUtils.stop("TimerManager:")},e.prototype.create=function(t,e,i,n,r,s,o){if(!(0>e||0>i||null==n)){this.remove(n,r);var a=ObjectPool.pop("TimerHandler");a.userFrame=t,a.repeat=0==i,a.repeatCount=i,a.delay=e,a.method=n,a.methodObj=r,a.complateMethod=s,a.complateMethodObj=o,a.exeTime=e+(t?this._currFrame:this._currTime),a.dealTime=this._currTime,this._handlers.push(a),this._count++}},e.prototype.doTimer=function(t,e,i,n,r,s){void 0===r&&(r=null),void 0===s&&(s=null),this.create(!1,t,e,i,n,r,s)},e.prototype.doFrame=function(t,e,i,n,r,s){void 0===r&&(r=null),void 0===s&&(s=null),this.create(!0,t,e,i,n,r,s)},Object.defineProperty(e.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),e.prototype.remove=function(t,e){for(var i=0;i<this._count;i++){var n=this._handlers[i];if(n.method==t&&n.methodObj==e){this._handlers.splice(i,1),ObjectPool.push(n),this._count--;break}}},e.prototype.removeAll=function(t){for(var e=0;e<this._count;e++){var i=this._handlers[e];i.methodObj==t&&(this._handlers.splice(e,1),ObjectPool.push(i),this._count--,e--)}},e.prototype.isExists=function(t,e){for(var i=0;i<this._count;i++){var n=this._handlers[i];if(n.method==t&&n.methodObj==e)return!0}return!1},e}(BaseClass);__reflect(TimerManager.prototype,"TimerManager");var TimerHandler=function(){function t(){this.delay=0,this.repeatCount=0,this.exeTime=0,this.dealTime=0}return t.prototype.clear=function(){this.method=null,this.methodObj=null,this.complateMethod=null,this.complateMethodObj=null},t}();__reflect(TimerHandler.prototype,"TimerHandler");var GameApp=function(){function t(){}return Object.defineProperty(t,"PromotManager",{get:function(){return PromotManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PlayerInfo",{get:function(){return PlayerInfo.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"HomeManager",{get:function(){return HomeManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MarqueeManager",{get:function(){return MarqueeManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"HeartMgr",{get:function(){return HeartMgr.getInstance()},enumerable:!0,configurable:!0}),t.getMcFactory=function(t,e){var i=RES.getRes(t),n=RES.getRes(e);return new egret.MovieClipDataFactory(i,n)},t.getClipByDataAndTexture=function(e,i,n){var r=t.getMcFactory(e,i);return r?new egret.MovieClip(r.generateMovieClipData(n)):null},t.getMovieDataByFileName=function(e,i){var n=t.getMcFactory(e+"_json",e+"_png");return n?n.generateMovieClipData(i):null},t.getClipByFileName=function(e,i){return t.getClipByDataAndTexture(e+"_json",e+"_png",i)},t.playMoveClip=function(t,e,i,n,r,s,o){t&&e&&i&&(t.addChild(e),n&&(e.x=n.x,e.y=n.y),r?e.gotoAndPlay(i,r):e.gotoAndPlay(i),e.addEventListener(egret.Event.COMPLETE,function(t){s&&s.apply(o)},this))},t.clone=function(e){var i;if("object"==typeof e)if(null===e)i=null;else if(e instanceof Array){i=[];for(var n=0,r=e.length;r>n;n++)i.push(t.clone(e[n]))}else{i={};for(var s in e)i[s]=t.clone(e[s])}else i=e;return i},t.chips2Money=function(t){return App.GlobalData.GoldMode?t:(t/1e3).toFixed(3)},t.money2Chips=function(t){return App.GlobalData.GoldMode?t:1e3*t},t.chips2MoneyNum=function(t){return App.GlobalData.GoldMode?t:t/1e3},t.prototype.equal=function(t,e){return 0==t.compare(e)},t.Init=function(){PlayerManager.registerResListener(),baccarat.BaccaratMgr.registerListener(),fish.FishMgr.registerListener(),brnn.BrnnMgr.registerListener()},t.isInBackground=!1,t}();__reflect(GameApp.prototype,"GameApp");var ControllerConst;!function(t){t[t.Loading=1e4]="Loading",t[t.Login=10001]="Login",t[t.Home=10002]="Home",t[t.Room=10003]="Room",t[t.Baccarat=10004]="Baccarat",t[t.FishLoad=10005]="FishLoad",t[t.FishMain=10006]="FishMain",t[t.BrnnLoad=10007]="BrnnLoad",t[t.BrnnMain=10008]="BrnnMain"}(ControllerConst||(ControllerConst={}));var SceneConsts;!function(t){t[t.Login=1]="Login",t[t.Game=2]="Game",t[t.Fish=3]="Fish",t[t.Brnn=4]="Brnn"}(SceneConsts||(SceneConsts={}));var ViewConst;!function(t){t[t.Loading=1e4]="Loading",t[t.Login=10001]="Login",t[t.Home=10002]="Home",t[t.Room=10003]="Room",t[t.Test=10004]="Test",t[t.BaccaratLoad=10005]="BaccaratLoad",t[t.Baccarat=10006]="Baccarat",t[t.FishLoad=10007]="FishLoad",t[t.FishMain=10008]="FishMain",t[t.BrnnLoad=10009]="BrnnLoad",t[t.BrnnMain=10010]="BrnnMain"}(ViewConst||(ViewConst={}));var game;!function(t){var e;!function(t){t[t.CashOut=1]="CashOut",t[t.CashIn=2]="CashIn"}(e=t.ExchangeType||(t.ExchangeType={}));var i=function(t){function i(){var e=t.call(this)||this;return e.safeGold=0,e.chips=0,e.skinName="resource/skins/ExchangeSkin.exml",e.addEventListener(eui.UIEvent.COMPLETE,e.onUIComplete,e),e}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.percentHeight=100,this.percentWidth=100},i.prototype.onUIComplete=function(){var t=this;this.btnClose1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){App.SoundManager.playEffect("btnclick_mp3"),t.visible=!1},this),this.btnClose2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){App.SoundManager.playEffect("btnclick_mp3"),t.visible=!1},this),this.btnCashIn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(i){App.SoundManager.playEffect("btnclick_mp3"),t.lbTitle.text="下分",t.exchangeType=e.CashIn,t.initView()},this),this.btnCashOut.addEventListener(egret.TouchEvent.TOUCH_TAP,function(i){App.SoundManager.playEffect("btnclick_mp3"),t.lbTitle.text="上分",t.exchangeType=e.CashOut,t.initView()},this),this.sliderExchange.addEventListener(eui.UIEvent.CHANGE,this.changeHandler,this),this.btnSure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sureHandler,this)},i.prototype.changeHandler=function(t){switch(this.exchangeType){case e.CashOut:this.lbExchange.text="选择金币："+GameApp.chips2MoneyNum(t.target.value)+", 兑换 "+GameApp.chips2MoneyNum(t.target.value)*this.roomInfo.proportionChips/this.roomInfo.proportionGold+" 筹码";break;case e.CashIn:this.lbExchange.text="选择筹码："+t.target.value+", 兑换 "+GameApp.chips2Money(GameApp.money2Chips(t.target.value*this.roomInfo.proportionGold/this.roomInfo.proportionChips))+" 金币"}},i.prototype.sureHandler=function(t){this.sureMethod.apply(this.sureMethodObj,[this.exchangeType,this.sliderExchange.value]),this.hide()},i.prototype.initView=function(){switch(this.groupSelect.visible=!1,this.groupExchange.visible=!0,this.lbExchange.text="兑换筹码：0",this.exchangeType){case e.CashOut:this.lbRate.text="金币:筹码 = "+this.roomInfo.proportionGold+":"+this.roomInfo.proportionChips,this.lbTotal.text="剩余金币："+GameApp.chips2Money(this.safeGold),this.sliderExchange.maximum=this.safeGold,this.sliderExchange.enabled=this.safeGold>0,this.btnSure.enabled=this.safeGold>0;break;case e.CashIn:this.lbRate.text="筹码:金币 = "+this.roomInfo.proportionChips+":"+this.roomInfo.proportionGold,this.lbTotal.text="剩余筹码："+this.chips,this.sliderExchange.maximum=this.chips,this.sliderExchange.enabled=this.chips>0,this.btnSure.enabled=this.chips>0}this.sliderExchange.value=0},i.prototype.registerEvent=function(t,e){this.sureMethod=t,this.sureMethodObj=e},i.prototype.show=function(t,e,i){this.visible||(this.safeGold=t,this.chips=e,this.roomInfo=i,this.groupSelect.visible=!0,this.groupExchange.visible=!1,this.visible=!0)},i.prototype.hide=function(){this.visible=!1},i}(eui.Component);t.ExchangeView=i,__reflect(i.prototype,"game.ExchangeView")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/SetSkin.exml",e.addEventListener(eui.UIEvent.COMPLETE,e.onUIComplete,e),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.percentHeight=100,this.percentWidth=100,this.show(!1)},e.prototype.registerEvent=function(t,e){this.bgOnMethod=t,this.bgOnObj=e},e.prototype.onUIComplete=function(){var t=this;this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){App.SoundManager.playEffect("btnclick_mp3"),t.visible=!1},this),this.tgMusic.selected=App.SoundManager.bgOn,this.tgSound.selected=App.SoundManager.effectOn,this.tgMusic.addEventListener(eui.UIEvent.CHANGE,function(e){e.target.selected?(App.SoundManager.setBgOn(!0),t.bgOnMethod&&t.bgOnObj&&t.bgOnMethod.apply(t.bgOnObj)):(App.SoundManager.setBgOn(!1),App.SoundManager.stopBg())},this),this.tgSound.addEventListener(eui.UIEvent.CHANGE,function(t){t.target.selected?App.SoundManager.setEffectOn(!0):(App.SoundManager.setEffectOn(!1),App.SoundManager.stopEffect())},this)},e.prototype.show=function(t){this.visible=t},e}(eui.Component);t.SetView=e,__reflect(e.prototype,"game.SetView")}(game||(game={}));var BaccaratConst=function(){function t(){}return t.LoadCompleted=590001,t.RenderCompleted=590002,t.FastEnterTable=595904,t.ExitTable=595931,t.DoBet=595907,t.ClearBet=595908,t.TableBetInfoNotice=595928,t.PlayerChipNotice=595921,t.GameStateNotice=595929,t.GameOddsNotice=595923,t.GameStartNotice=595925,t.GameResultNotice=595930,t.GameBillNotice=595926,t.GameStatNotice=595927,t.GameWayBillNotice=595922,t.GameShuffleNotice=595924,t.GameInfo=595999,t}();__reflect(BaccaratConst.prototype,"BaccaratConst");var baccarat;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.initData(),t.loadView=new BaccaratLoad(t,LayerManager.UI_Main),App.ViewManager.register(ViewConst.BaccaratLoad,t.loadView),App.ViewManager.open(ViewConst.BaccaratLoad),t.bindFunctions(),t}return __extends(i,e),i.prototype.bindFunctions=function(){this.registerFunc(BaccaratConst.LoadCompleted,this.loadCompleted,this),this.registerFunc(BaccaratConst.RenderCompleted,this.renderCompleted,this),this.registerFunc(BaccaratConst.ExitTable,this.exitTable,this),this.registerFunc(BaccaratConst.DoBet,this.resDoBet,this),this.registerFunc(BaccaratConst.ClearBet,this.resClearBet,this),this.registerFunc(BaccaratConst.GameStateNotice,this.gameState,this),this.registerFunc(BaccaratConst.TableBetInfoNotice,this.tableBetInfo,this),this.registerFunc(BaccaratConst.PlayerChipNotice,this.changePlayerChip,this),this.registerFunc(BaccaratConst.GameStartNotice,this.gameStart,this),this.registerFunc(BaccaratConst.GameResultNotice,this.gameResult,this),this.registerFunc(BaccaratConst.GameBillNotice,this.gameBill,this),this.registerFunc(BaccaratConst.GameStatNotice,this.gameStat,this),this.registerFunc(BaccaratConst.GameWayBillNotice,this.gemtWayBill,this),this.registerFunc(BaccaratConst.GameShuffleNotice,this.gameShuffle,this),this.registerFunc(BaccaratConst.GameInfo,this.resGetGameInfo,this)},i.prototype.unbindFunctions=function(){},i.prototype.initData=function(){t.BaccaratMgr.setEnterScene(!1),this.gameInfo=new Object,this.gameInfo.time=0,this.gameInfo.state=0,this.resultMsg=null,this.startMsg=null,this.bankerChips=0,this.playerChips=0,t.BaccaratMgr.bjlModel.myBet=[0,0,0,0,0,0,0,0,0,0,0,0],t.BaccaratMgr.bjlModel.lastBet=[0,0,0,0,0,0,0,0,0,0,0,0],t.BaccaratMgr.bjlModel.totalBet=[0,0,0,0,0,0,0,0,0,0,0,0]},i.prototype.loadCompleted=function(){this.mainView=new t.BaccaratView(this,LayerManager.UI_Main),App.ViewManager.register(ViewConst.Baccarat,this.mainView),App.ViewManager.open(ViewConst.Baccarat)},i.prototype.renderCompleted=function(){t.BaccaratReq.send_ReqGameInfo(),App.ViewManager.close(ViewConst.BaccaratLoad)},i.prototype.initViewData=function(){t.BaccaratMgr.isEnterScene()&&(this.mainView.setPlayerInfo(t.BaccaratMgr.bjlModel.me),this.mainView.showDuihuan()),this.resultMsg&&(this.gameResult(this.resultMsg),this.resultMsg=null),this.startMsg&&(this.gameStart(this.startMsg),this.startMsg=null)},i.prototype.gameState=function(t,e){this.gameInfo.time=t,this.gameInfo.state=e,this.renderGameState()},i.prototype.renderGameState=function(){var e=this.gameInfo.state;if(t.BaccaratMgr.isEnterScene()){if(this.mainView.setGameState(this.gameInfo.time,this.gameInfo.state),3==e){for(var i=0,n=t.BaccaratMgr.bjlModel.myBet;i<n.length;i++){var r=n[i];if(0!=r){t.BaccaratMgr.bjlModel.lastBet=t.BaccaratMgr.bjlModel.myBet;break}}t.BaccaratMgr.bjlModel.myBet=[0,0,0,0,0,0,0,0,0,0,0,0]}1==e?(this.mainView.setBetBtnState(t.BaccaratMgr.bjlModel.me.chips,1e7,t.BaccaratMgr.bjlModel.lastBet,!1),this.mainView.setBetAreaState(t.BaccaratMgr.bjlModel.statInfo?t.BaccaratMgr.bjlModel.statInfo.score:0,!1)):(this.mainView.setBetBtnState(t.BaccaratMgr.bjlModel.me.chips,1e7,t.BaccaratMgr.bjlModel.lastBet,!0),this.mainView.setBetAreaState(t.BaccaratMgr.bjlModel.statInfo?t.BaccaratMgr.bjlModel.statInfo.score:0,!0))}},i.prototype.resGetGameInfo=function(e){if(e.cardIndex!=this.mainView.cardIndex&&0!=this.mainView.cardIndex&&(this.mainView.cardIndex=e.cardIndex,this.mainView.clear(!1),t.BaccaratMgr.bjlModel.myBet=[0,0,0,0,0,0,0,0,0,0,0,0],e.betInfos&&12==e.betInfos.length))for(var i=0;i<t.BaccaratMgr.bjlModel.myBet.length;i++)this.setMyBet(e.betInfos[i],i);t.BaccaratMgr.setEnterScene(!0),t.BaccaratMgr.bjlModel.statInfo&&this.mainView.setBillStat(t.BaccaratMgr.bjlModel.statInfo),t.BaccaratMgr.bjlModel.billWayInfo&&this.mainView.setWayBill(t.BaccaratMgr.bjlModel.billWayInfo),this.mainView.setChipBtnText();var n=this.gameInfo.state;3>n&&(this.mainView.tableBetInfo(t.BaccaratMgr.bjlModel.totalBet),this.mainView.gameBill(this.bankerChips,this.playerChips)),this.initViewData(),this.renderGameState()},i.prototype.exitTable=function(t){this.unbindFunctions(),this.mainView.clear(!1),LoginMgr.start()},i.prototype.setMyBet=function(e,i){if("number"!=typeof e&&(e=e.toNumber()),t.BaccaratMgr.bjlModel.myBet[i]+=e,t.BaccaratMgr.isEnterScene())for(var n=8;n>0;n--){var r=t.BaccaratMgr.bjlModel.roomInfo.betOptions[n-1],s=Math.floor(e/r);if(s>=1){for(var o=0;s>o;o++)this.mainView.doBet(r,i,t.BaccaratMgr.bjlModel.myBet[i]);e-=s*r}}},i.prototype.resDoBet=function(e,i){if("number"!=typeof e&&(e=e.toNumber()),t.BaccaratMgr.bjlModel.myBet[i]+=e,t.BaccaratMgr.bjlModel.totalBet[i]+=e,t.BaccaratMgr.isEnterScene()){for(var n=8;n>0;n--){var r=t.BaccaratMgr.bjlModel.roomInfo.betOptions[n-1],s=Math.floor(e/r);if(s>=1){for(var o=0;s>o;o++)this.mainView.doBet(r,i,t.BaccaratMgr.bjlModel.myBet[i]);e-=s*r}}this.mainView.updateTableBetInfo()}},i.prototype.resClearBet=function(){for(var e=0;e<t.BaccaratMgr.bjlModel.myBet.length;e++)t.BaccaratMgr.bjlModel.totalBet[e]=t.BaccaratMgr.bjlModel.totalBet[e]-t.BaccaratMgr.bjlModel.myBet[e];t.BaccaratMgr.bjlModel.myBet=[0,0,0,0,0,0,0,0,0,0,0,0],t.BaccaratMgr.isEnterScene()&&this.mainView.clearBet()},i.prototype.tableBetInfo=function(e){0==e.length&&(t.BaccaratMgr.bjlModel.totalBet=[0,0,0,0,0,0,0,0,0,0,0,0]),e.forEach(function(e){t.BaccaratMgr.bjlModel.totalBet[e.area]=e.chips.toNumber()}),t.BaccaratMgr.isEnterScene()&&this.mainView.tableBetInfo(t.BaccaratMgr.bjlModel.totalBet)},i.prototype.changePlayerChip=function(e,i){t.BaccaratMgr.bjlModel.me&&e.toNumber()==t.BaccaratMgr.bjlModel.me.playerId.toNumber()&&(t.BaccaratMgr.bjlModel.me.chips=i,t.BaccaratMgr.isEnterScene()&&(2!=this.gameInfo.state&&3!=this.gameInfo.state&&this.mainView.setPlayerInfo(t.BaccaratMgr.bjlModel.me),1==this.gameInfo.state&&(this.mainView.setBetBtnState(t.BaccaratMgr.bjlModel.me.chips,1e7,t.BaccaratMgr.bjlModel.lastBet,!1),this.mainView.setBetAreaState(t.BaccaratMgr.bjlModel.statInfo?t.BaccaratMgr.bjlModel.statInfo.score:0,!1))))},i.prototype.gameStart=function(e){t.BaccaratMgr.isEnterScene()&&e?this.gameInfo.time>18?this.mainView.gameStartProcess(e.cardsInfo,e.cardIndex,1==e.yellow):this.mainView.gameStartNow(e.cardsInfo,e.cardIndex,1==e.yellow):this.startMsg=e},i.prototype.gameResult=function(e){t.BaccaratMgr.isEnterScene()?(this.mainView.gameResult(e.result),t.BaccaratMgr.bjlModel.totalBet=[0,0,0,0,0,0,0,0,0,0,0,0]):this.resultMsg=e},i.prototype.gameBill=function(e){this.bankerChips=e.bankerChips,this.playerChips=e.playerChips,t.BaccaratMgr.isEnterScene()&&this.mainView.gameBill(e.bankerChips,e.playerChips)},i.prototype.gameStat=function(e){t.BaccaratMgr.bjlModel.statInfo=e,t.BaccaratMgr.isEnterScene()&&this.mainView.setBillStat(t.BaccaratMgr.bjlModel.statInfo)},i.prototype.gemtWayBill=function(e){t.BaccaratMgr.bjlModel.billWayInfo=e},i.prototype.gameShuffle=function(e){e.cardsInfo&&t.BaccaratMgr.isEnterScene()&&this.mainView.showShuffle(e.cardsInfo)},i}(BaseController);t.BaccaratController=e,__reflect(e.prototype,"baccarat.BaccaratController")}(baccarat||(baccarat={}));var baccarat;
!function(t){var e=function(){function e(){}return e.setRoomInfo=function(i){if(e.bjlModel||(e.bjlModel=new t.BaccaratModel),e.bjlModel.roomInfo=i,e.bjlModel.roomInfo.betOptions)for(var n=0;n<e.bjlModel.roomInfo.betOptions.length;n++)"number"!=typeof e.bjlModel.roomInfo.betOptions[n]&&(e.bjlModel.roomInfo.betOptions[n]=e.bjlModel.roomInfo.betOptions[n].toNumber())},e.isEnterScene=function(){return e.bjlModel&&e.bjlModel.isEnterScene},e.setEnterScene=function(t){e.bjlModel&&(e.bjlModel.isEnterScene=t)},e.registerListener=function(){GameApp.HomeManager.registerModuleReqFunc(18,t.BaccaratReq.registerComReq,e),GameApp.HomeManager.registerModuleResFunc(18,t.BaccaratRes.registerListener,e)},e.start=function(){e.bjlModel||(e.bjlModel=new t.BaccaratModel),e.bjlStart||(e.bjlStart=new t.BaccaratStart),e.bjlStart.start()},e.finish=function(i){i&&t.BaccaratRes.unregisterListener(),e.bjlStart&&e.bjlStart.finish(),e.bjlStart=null,e.bjlModel=null},e.bjlModel=new t.BaccaratModel,e}();t.BaccaratMgr=e,__reflect(e.prototype,"baccarat.BaccaratMgr")}(baccarat||(baccarat={}));var baccarat;!function(t){var e=function(){function e(){}return e.send_ReqEnterGameHall=function(){var t={id:e.c2s_bjl_ReqEnterGameHall_msg};App.Socket.send(t,function(e,i){App.EasyLoading.hideLoading(),e==t.id?(GameApp.PlayerInfo.myRoomTypeInfo=i.roomTypes,egret.log("rooms",i.roomTypes),GameApp.PlayerInfo.curGameID=18,App.ViewManager.open(ViewConst.Room,"百家乐")):PlayerManager.resCommonMsg(i)},this)},e.send_ReqEnterRoom=function(t){},e.send_ReqFastEnterTable=function(i){var n={id:e.c2s_bjl_ReqFastEnterTable_msg,roomId:i};App.Socket.send(n,function(i,r){i==n.id?(e.load_scene(),t.BaccaratMgr.bjlModel.setMembers(r.mems)):PlayerManager.resCommonMsg(r)},this)},e.send_ReqExitRoom=function(){var i={id:e.c2s_bjl_ReqExitRoom_msg};App.Socket.send(i,function(e,n){e==i.id?t.BaccaratRes.unregisterListener():GameApp.PromotManager.floatingTip(n.errorCode)},this)},e.send_ReqExitTable=function(){var t={id:e.c2s_bjl_ReqExitTable_msg};App.Socket.send(t,function(i,n){i==t.id?(e.send_ReqExitRoom(),App.ControllerManager.applyFunc(ControllerConst.Baccarat,BaccaratConst.ExitTable,1)):GameApp.PromotManager.floatingTip(n.errorCode)},this)},e.send_ReqBet=function(t,i){var n={id:e.c2s_bjl_ReqBet_msg,chips:t,area:i};App.Socket.send(n,function(t,e){t==n.id?App.ControllerManager.applyFunc(ControllerConst.Baccarat,BaccaratConst.DoBet,e.chips,e.area):PlayerManager.resCommonMsg(e)},this)},e.send_ReqClearBet=function(){var t={id:e.c2s_bjl_ReqClearBet_msg};App.Socket.send(t,function(e,i){e==t.id?App.ControllerManager.applyFunc(ControllerConst.Baccarat,BaccaratConst.ClearBet):PlayerManager.resCommonMsg(i)},this)},e.send_ReqGameInfo=function(){t.BaccaratMgr.setEnterScene(!1);var i={id:e.c2s_bjl_ReqGameInfo_msg};App.Socket.send(i,function(e,n){if(e==i.id){if(!n||!n.roomInfo)return void LoginMgr.start();GameApp.PlayerInfo.curGameID=18,t.BaccaratMgr.bjlModel.setMembers(n.mems),t.BaccaratMgr.setRoomInfo(n.roomInfo),App.ControllerManager.applyFunc(ControllerConst.Baccarat,BaccaratConst.GameInfo,n)}},this)},e.send_ReqExchangeChips=function(t){var i={id:e.c2s_bjl_ReqExchangeChips_msg,gold:t};App.Socket.send(i,function(t,e){t==i.id||GameApp.PromotManager.floatingTip(e.errorCode)},this)},e.send_ReqExchangeGolds=function(t){var i={id:e.c2s_bjl_ReqExchangeGold_msg,chips:t};App.Socket.send(i,function(t,e){t==i.id||GameApp.PromotManager.floatingTip(e.errorCode)},this)},e.set_RoomInfo=function(e){t.BaccaratMgr.setRoomInfo(e),egret.log("Set_RoomInfo",e)},e.load_scene=function(){App.ViewManager.isShow(ViewConst.Baccarat)?this.send_ReqGameInfo():(t.BaccaratMgr.start(),t.BaccaratRes.registerListener())},e.registerComReq=function(){GameApp.HomeManager.registerModuleReq(18,CommonReq.SetRoomInfo,e.set_RoomInfo,e),GameApp.HomeManager.registerModuleReq(18,CommonReq.LoadGameScene,e.load_scene,e),GameApp.HomeManager.registerModuleReq(18,CommonReq.ReqEnterCurGame,e.send_ReqEnterGameHall,e),GameApp.HomeManager.registerModuleReq(18,CommonReq.ReqEnterCurGameRoom,e.send_ReqEnterRoom,e),GameApp.HomeManager.registerModuleReq(18,CommonReq.ReqExitCurGameRoom,e.send_ReqExitRoom,e),GameApp.HomeManager.registerModuleReq(18,CommonReq.ReqQuickEnterCurGame,e.send_ReqFastEnterTable,e),GameApp.HomeManager.registerModuleReq(18,CommonReq.ReqExitCurGameTable,e.send_ReqExitTable,e)},e.c2s_bjl_ReqEnterGameHall_msg=5901,e.c2s_bjl_ReqExitRoom_msg=5905,e.c2s_bjl_ReqExitTable_msg=5906,e.c2s_bjl_ReqBet_msg=5907,e.c2s_bjl_ReqClearBet_msg=5908,e.c2s_bjl_ReqGameInfo_msg=5999,e.c2s_bjl_ReqExchangeGold_msg=5909,e.c2s_bjl_ReqExchangeChips_msg=5910,e.c2s_bjl_ReqFastEnterTable_msg=5911,e}();t.BaccaratReq=e,__reflect(e.prototype,"baccarat.BaccaratReq")}(baccarat||(baccarat={}));var baccarat;!function(t){var e=function(){function t(){}return t.rec_bjl_ResPlayerEnter=function(t){},t.rec_bjl_ResPlayerExit=function(t){},t.rec_bjl_ResPlayerChipChange=function(t){App.ControllerManager.applyFunc(ControllerConst.Baccarat,BaccaratConst.PlayerChipNotice,t.playerId,t.chips)},t.rec_bjl_ResTableBetInfo=function(t){App.ControllerManager.applyFunc(ControllerConst.Baccarat,BaccaratConst.TableBetInfoNotice,t.betInfo)},t.rec_bjl_ResGameState=function(t){App.ControllerManager.applyFunc(ControllerConst.Baccarat,BaccaratConst.GameStateNotice,t.time,t.state)},t.rec_bjl_ResSendCards=function(t){App.ControllerManager.applyFunc(ControllerConst.Baccarat,BaccaratConst.GameStartNotice,t)},t.rec_bjl_ResGameResult=function(t){App.ControllerManager.applyFunc(ControllerConst.Baccarat,BaccaratConst.GameResultNotice,t)},t.rec_bjl_ResGameBill=function(t){App.ControllerManager.applyFunc(ControllerConst.Baccarat,BaccaratConst.GameBillNotice,t)},t.rec_bjl_ResGameBillStat=function(t){App.ControllerManager.applyFunc(ControllerConst.Baccarat,BaccaratConst.GameStatNotice,t)},t.rec_bjl_ResGameWayBill=function(t){App.ControllerManager.applyFunc(ControllerConst.Baccarat,BaccaratConst.GameWayBillNotice,t)},t.rec_bjl_ResShuffle=function(t){App.ControllerManager.applyFunc(ControllerConst.Baccarat,BaccaratConst.GameShuffleNotice,t)},t.registerListener=function(){App.MessageCenter.addListener(t.s2c_bjl_ResPlayerEnter_msg,t.rec_bjl_ResPlayerEnter,t),App.MessageCenter.addListener(t.s2c_bjl_ResTableBetInfo_msg,t.rec_bjl_ResTableBetInfo,t),App.MessageCenter.addListener(t.s2c_bjl_ResPlayerChipChange_msg,t.rec_bjl_ResPlayerChipChange,t),App.MessageCenter.addListener(t.s2c_bjl_ResGameState_msg,t.rec_bjl_ResGameState,t),App.MessageCenter.addListener(t.s2c_bjl_ResSendCards_msg,t.rec_bjl_ResSendCards,t),App.MessageCenter.addListener(t.s2c_bjl_ResGameResult_msg,t.rec_bjl_ResGameResult,t),App.MessageCenter.addListener(t.s2c_bjl_ResBill_msg,t.rec_bjl_ResGameBill,t),App.MessageCenter.addListener(t.s2c_bjl_ResBillStat_msg,t.rec_bjl_ResGameBillStat,t),App.MessageCenter.addListener(t.s2c_bjl_ResWayBill_msg,t.rec_bjl_ResGameWayBill,t),App.MessageCenter.addListener(t.s2c_bjl_ResShuffle_msg,t.rec_bjl_ResShuffle,t)},t.unregisterListener=function(){App.MessageCenter.removeAll(t)},t.s2c_bjl_ResPlayerEnter_msg="5920",t.s2c_bjl_ResPlayerExit_msg="5931",t.s2c_bjl_ResTableBetInfo_msg="5928",t.s2c_bjl_ResPlayerChipChange_msg="5921",t.s2c_bjl_ResGameState_msg="5929",t.s2c_bjl_ResSendCards_msg="5925",t.s2c_bjl_ResGameResult_msg="5930",t.s2c_bjl_ResBill_msg="5926",t.s2c_bjl_ResBillStat_msg="5927",t.s2c_bjl_ResWayBill_msg="5922",t.s2c_bjl_ResShuffle_msg="5924",t}();t.BaccaratRes=e,__reflect(e.prototype,"baccarat.BaccaratRes")}(baccarat||(baccarat={}));var baccarat;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.onEnter=function(){e.prototype.onEnter.call(this),this.addLayer(LayerManager.UI_Main)},i.prototype.onExit=function(){e.prototype.onExit.call(this),App.SoundManager.stopBg(),App.SoundManager.stopEffect(),t.BaccaratMgr.finish(!0)},i}(BaseScene);t.BaccaratScene=e,__reflect(e.prototype,"baccarat.BaccaratScene")}(baccarat||(baccarat={}));var baccarat;!function(t){var e=function(){function e(){}return e.prototype.start=function(){App.SceneManager.register(SceneConsts.Game,new t.BaccaratScene),App.ResourceUtils.addConfig("resource/assets/games/baccarat/baccarat.res.json","resource/"),App.ResourceUtils.loadConfig(this.onConfigComplete,this),App.EasyLoading.showLoading("加载中 ...")},e.prototype.onConfigComplete=function(){App.ResourceUtils.loadGroup("baccarat_load",function(){App.EasyLoading.hideLoading(),App.SceneManager.runScene(SceneConsts.Game),App.ControllerManager.register(ControllerConst.Baccarat,new t.BaccaratController)},function(){},this)},e.prototype.finish=function(){var t=App.ViewManager.getView(ViewConst.Baccarat);t&&t.clear(!1),App.ViewManager.unregister(ViewConst.BaccaratLoad),App.ViewManager.unregister(ViewConst.Baccarat),App.ControllerManager.unregister(ControllerConst.Baccarat)},e}();t.BaccaratStart=e,__reflect(e.prototype,"baccarat.BaccaratStart")}(baccarat||(baccarat={}));var baccarat;!function(t){var e=function(){function t(t,e){this.imgLight=t,this.lbBet=e,this.imgLight.visible=!1,this.lbBet.visible=!1,this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}return t.prototype.setBet=function(t){this.lbBet.visible=!0,this.lbBet.text=t.toString()},t.prototype.setLight=function(){this.imgLight.visible=!0},t.prototype.clear=function(){this.imgLight.visible=!1,egret.Tween.get(this.imgLight).pause(),this.lbBet.visible=!1,this.lbBet.text=""},t}();t.BaccaratBetAreaItem=e,__reflect(e.prototype,"baccarat.BaccaratBetAreaItem")}(baccarat||(baccarat={}));var BaccaratLoad=function(t){function e(e,i){var n=t.call(this,e,i)||this;n.skinName="resource/skins/game/baccarat/BaccaratLoadSkin.exml";var r=new eui.Theme("resource/skins/game/baccarat/baccarat_theme.json",n.stage);return r.addEventListener(eui.UIEvent.COMPLETE,n.onThemeLoadComplete,n),n}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.pbLoad.minimum=0,this.pbLoad.maximum=100,this.pbLoad.value=0},e.prototype.initData=function(){t.prototype.initData.call(this)},e.prototype.onLoadComplete=function(){App.ControllerManager.applyFunc(ControllerConst.Baccarat,BaccaratConst.LoadCompleted)},e.prototype.onThemeLoadComplete=function(){var t="baccarat",e=["baccarat"];App.ResourceUtils.loadGroups(t,e,this.onLoadComplete,this.onLoadProgress,this)},e.prototype.onLoadProgress=function(t,e){this.pbLoad.value=t/e*100},e}(BaseEuiView);__reflect(BaccaratLoad.prototype,"BaccaratLoad");var baccarat;!function(t){var e=function(){function t(t){this.grp=t,this.lbBet=t.getChildAt(1),this.grp.visible=!1,this.x=t.x+t.width/2,this.y=t.y+t.height/2}return t.prototype.setMyBet=function(t){this.grp.visible=!0,this.lbBet.text=t.toString(),this.bet=t},t.prototype.clear=function(){this.grp.visible=!1,this.lbBet.text=""},t.prototype.myName=function(){return this.grp.name},t}();t.BaccaratMyBetItem=e,__reflect(e.prototype,"baccarat.BaccaratMyBetItem")}(baccarat||(baccarat={}));var baccarat;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.grp=e,i.imgResult=e.getChildAt(0),i.lbResult=e.getChildAt(1),i.grp.visible=!1,i}return __extends(e,t),e.prototype.showResult=function(t,e,i){var n=["bjl_wd_json.bjl_wd_zy","bjl_wd_json.bjl_wd_xy","bjl_wd_json.bjl_wd_he"];this.imgResult.source=RES.getRes(n[t]),0>i?this.lbResult.text=i.toString():this.lbResult.text="+"+i.toString(),this.grp.scaleX=.1,this.grp.scaleY=.1,this.grp.visible=!0;var r=egret.Tween.get(this.grp);r.to({scaleX:1,scaleY:1},500).call(function(){})},e.prototype.clear=function(){this.grp.visible=!1},e}(eui.Component);t.BaccaratResult=e,__reflect(e.prototype,"baccarat.BaccaratResult")}(baccarat||(baccarat={}));var baccarat;!function(t){var e=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n.skinName="resource/skins/game/baccarat/BaccaratSkin.exml",n}return __extends(i,e),i.prototype.initUI=function(){e.prototype.initUI.call(this),this.findUIChipBtns(),this.findUIBetAreaBtns(),this.findUIBetInfo(),this.findUIMyBetInfo(),this.findUISet(),this.imgXPB.visible=!1,this.imgZPB.visible=!1,this.resultPanel=new t.BaccaratResult(this.pnlResult),this.wayBillView=new t.BaccaratWayBillView,this.wayBillView.horizontalCenter=0,this.wayBillView.y=-950,this.grpPaim.visible=!0,this.imgPaim.y=95,App.SoundManager.playBg("bjl_bj0_mp3"),this.addChild(this.wayBillView),this.btnDuihuan.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onDuihuanClick,this),this.exchangeView.hide(),this.exchangeView.registerEvent(function(e,i){if(0>=i)return void GameApp.PromotManager.floatingTip("兑换筹码必须大于0");switch(e){case game.ExchangeType.CashIn:t.BaccaratReq.send_ReqExchangeGolds(i);break;case game.ExchangeType.CashOut:t.BaccaratReq.send_ReqExchangeChips(i)}},this),this.gameTime=0,this.gameState=0,this.timer=new egret.Timer(1e3),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerListener,this),this.timer.start()},i.prototype.initData=function(){e.prototype.initData.call(this),this.curBet=0,this.score=0,this.bankerChips=0,this.playerChips=0,this.firstResult=0,this.tableBets=[0,0,0,0,0,0,0,0,0,0,0,0],this.timerArray=new Array,this.isOpenPlayer=!1,this.tableChipArray=new Array,this.chipArray=new Array,this.pokerArray=new Array,this.pokerWaitArray=new Array,this.setGameState(0,0),App.ControllerManager.applyFunc(ControllerConst.Baccarat,BaccaratConst.RenderCompleted)},i.prototype.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.prototype.open.call(this,t)},i.prototype.setPlayerInfo=function(t){this.myInfo=t,this.lbNick.text=t.playerName.toString(),this.lbChip.text=t.chips.toString(),this.lbGold.text=GameApp.chips2Money(GameApp.PlayerInfo.safeGold),this.imgPlayerAvatar.texture=GameApp.PlayerInfo.getHeadTexture()},i.prototype.setGameState=function(t,e){switch(this.gameTime=t,this.gameState=e,e){case 1:this.btnDuihuan.enabled=!0,App.SoundManager.playEffect("bjl_beginXiazhu_mp3"),this.imgStatus.source=RES.getRes("bjl_wd_json.bjl_wd_qxz");break;case 2:this.btnDuihuan.enabled=!1,this.imgStatus.source=RES.getRes("bjl_wd_json.bjl_wd_kpz");break;case 3:this.clear(!1),this.imgStatus.source=RES.getRes("bjl_wd_json.bjl_wd_xxyx"),App.SoundManager.playEffect("bjl_READY_mp3"),this.lbRoundCnt.text=(this.score+1).toString();break;case 4:this.btnDuihuan.enabled=!1,this.imgStatus.source=RES.getRes("bjl_wd_json.bjl_wd_xpz");break;default:this.imgStatus.source=RES.getRes("bjl_wd_json.bjl_wd_xxyx")}},i.prototype.timerListener=function(){this.gameTime<=0||(this.gameTime--,this.lbClock.text=""+this.gameTime,1==this.gameState&&(this.gameTime<5&&App.SoundManager.playEffect("bjl_time_mp3"),0==this.gameTime&&App.SoundManager.playEffect("bjl_stopXiazhu_mp3")),2==this.gameState&&1==this.gameTime&&this.clear(!0))},i.prototype.doBet=function(e,i,n){App.SoundManager.playEffect("bjl_PAWN_BANKER_mp3"),this.btnClear.enabled=!0;var r=new t.ChipItem;r.setChip(e),r.scaleX=.4,r.scaleY=.4,this.chipArray.push(r);var s=this.betInfoArray[i].x+Math.floor(Math.random()*(this.betInfoArray[i].width-100+1)+30),o=this.betInfoArray[i].y+Math.floor(Math.random()*(this.betInfoArray[i].height-60+1)+10);this.grpChipPanel.addChildAt(r,0),this.myBetArray[i].setMyBet(n),r.sendChip(s,o)},i.prototype.clearBet=function(){this.chipArray.forEach(function(t){t.clear()});for(var t in this.myBetArray)this.myBetArray[t].clear();this.curBet=0,this.btnClear.enabled=!1,this.chipArray=new Array},i.prototype.tableBetInfo=function(e){for(var i=0;i<e.length;i++)if(this.betInfoArray[i]){var n=e[i];t.BaccaratMgr.bjlModel.myBet[i]&&(n-=t.BaccaratMgr.bjlModel.myBet[i]),n-=this.tableBets[i];for(var r=8;r>0;r--){var s=t.BaccaratMgr.bjlModel.roomInfo.betOptions[r-1],o=Math.floor(n/s);if(o>0){n-=o*s,App.SoundManager.playEffect("bjl_PAWN_BANKER_mp3");for(var a=0;o>a;a++){var h=new t.ChipItem;h.setChip(s),h.scaleX=.4,h.scaleY=.4,this.tableChipArray.push(h);var c=this.betInfoArray[i].x+Math.floor(Math.random()*(this.betInfoArray[i].width-100+1)+30),l=this.betInfoArray[i].y+Math.floor(Math.random()*(this.betInfoArray[i].height-60+1)+10);this.grpChipPanel.addChild(h),h.sendChip(c,l)}}}this.betInfoArray[i].setBet(e[i]),this.tableBets[i]=e[i]}},i.prototype.updateTableBetInfo=function(){for(var e=0;e<t.BaccaratMgr.bjlModel.totalBet.length;e++)this.betInfoArray[e]&&this.betInfoArray[e].setBet(t.BaccaratMgr.bjlModel.totalBet[e])},i.prototype.gameResult=function(t){var e=this;t=t.sort(),this.firstResult=t[0],this.grpWinLight.visible=!1,t.forEach(function(t){e.betInfoArray[t]&&e.betInfoArray[t].setLight()})},i.prototype.showGameResult=function(){this.setWayBill(t.BaccaratMgr.bjlModel.billWayInfo),this.grpWinLight.visible=!0;var e=egret.Tween.get(this.grpWinLight,{loop:!0});e.to({alpha:0},100).wait(200).to({alpha:1},100).wait(300),this.imgXPB.visible=!1,this.imgZPB.visible=!1;var i=0,n=new egret.Timer(1e3,3);n.addEventListener(egret.TimerEvent.TIMER,function(){if(0==i&&this.cardInfo[0]&&App.SoundManager.playEffect("bjl_xian"+this.cardInfo[0].point+"dian_mp3"),1==i&&this.cardInfo[1]&&App.SoundManager.playEffect("bjl_zhuang"+this.cardInfo[1].point+"dian_mp3"),2==i&&this.myInfo){var t=this.myInfo.icon%2,e=(new Date).getTime()%2;if(this.playerChips>0){var n=1==t?"bjl_M_WIN_"+e+"_mp3":"bjl_F_WIN_"+e+"_mp3";App.SoundManager.playEffect(n)}else{var r=1==t?"bjl_M_LOSE_"+e+"_mp3":"bjl_F_LOSE_"+e+"_mp3";App.SoundManager.playEffect(r)}}i++},this),n.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){this.resultPanel.showResult(this.firstResult,this.bankerChips,this.playerChips),this.setPlayerInfo(t.BaccaratMgr.bjlModel.me)},this),n.start(),this.timerArray.push(n)},i.prototype.gameBill=function(t,e){this.bankerChips=t,this.playerChips=e},i.prototype.gameStartProcess=function(e,i,n){if(this.cardIndex!=i){this.cardIndex=i,this.pokerArray.forEach(function(t){t.clear()}),this.pokerArray=new Array,this.grpPaim.visible=!0;var r=i/416*90;this.imgPaim.y=95-r,this.pokerBoxAnim(n),e.reverse(),this.cardInfo=e;var s=e[0].cards.length+e[1].cards.length,o=0,a=new egret.Timer(700,7);a.addEventListener(egret.TimerEvent.TIMER,function(){if(4>o){var i=Math.floor(o%2),n=Math.floor(o/2),r=0;r=0==i?this.grpXPool.x+160*n:this.grpZPool.x+160*n;var a=null;this.pokerWaitArray.length>0?a=this.pokerWaitArray.shift():(a=new t.PokerItem,a.scaleX=.9,a.scaleY=.9,a.x=this.grpBoxAnim.x,a.y=30),this.pokerArray.push(a),a.setCard(e[i].cards[n]),this.grpTop.addChild(a),a.sendCard(r,130,!0)}else if(6>o){var a=new t.PokerItem;a.x=this.grpBoxAnim.x,a.y=30,a.scaleX=.9,a.scaleY=.9,this.grpTop.addChild(a);var r=this.grpWPool.x+160*(o-4)-50;a.sendCard(r,this.grpWPool.y+30,!1),this.pokerWaitArray.push(a)}else s>4?this.dealPoker(e):this.showGameResult();o++},this),a.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){},this),a.start(),this.timerArray.push(a)}},i.prototype.gameStartNow=function(e,i,n){if(!(this.cardIndex==i&&this.pokerArray.length>0)){this.cardIndex=i,this.pokerArray.forEach(function(t){t.clear()}),this.pokerArray=new Array,this.grpPaim.visible=!0;var r=i/416*90;this.imgPaim.y=95-r,e.reverse(),this.cardInfo=e;for(var s=e[0].cards.length+e[1].cards.length,o=0;7>o;o++)if(4>o){var a=Math.floor(o%2),h=Math.floor(o/2),c=0;c=0==a?this.grpXPool.x+160*h:this.grpZPool.x+160*h;var l=null;this.pokerWaitArray.length>0?l=this.pokerWaitArray.shift():(l=new t.PokerItem,l.scaleX=.9,l.scaleY=.9,l.x=this.grpBoxAnim.x,l.y=30),this.pokerArray.push(l),l.setCard(e[a].cards[h]),l.showCard(),this.grpTop.addChild(l),l.x=c,l.y=130}else if(6>o){var l=new t.PokerItem;l.x=this.grpBoxAnim.x,l.y=30,l.scaleX=.9,l.scaleY=.9,this.grpTop.addChild(l);var c=this.grpWPool.x+160*(o-4)-50;l.x=c,l.y=this.grpWPool.y+30,this.pokerWaitArray.push(l)}else if(s>4){if(e[0].cards.length>2){var l=this.pokerWaitArray.shift();this.pokerArray.push(l),l.setCard(e[0].cards[2]),l.showCard(),this.grpTop.addChild(l);var c=this.grpXPool.x+220;l.ratateCard(c,190)}if(e[1].cards.length>2){var l=this.pokerWaitArray.shift();this.pokerArray.push(l),l.setCard(e[1].cards[2]),l.showCard(),this.grpTop.addChild(l);var c=this.grpZPool.x+220;l.ratateCard(c,190)}}}},i.prototype.setWayBill=function(t){this.wayBillView.setData(t)},i.prototype.setBillStat=function(t){this.score=t.score,this.lbRoundCnt.text=(this.score+1).toString(),this.wayBillView.setStat(t)},i.prototype.dealPoker=function(t){var e=this;t[0].cards.length>2&&t[1].cards.length>2?this.xianAinm(t[0].cards[2],function(){e.zhuangAinm(t[1].cards[2],function(){e.showGameResult()})}):t[0].cards.length>2&&2==t[1].cards.length?this.xianAinm(t[0].cards[2],function(){e.showGameResult()}):2==t[0].cards.length&&t[1].cards.length>2&&this.zhuangAinm(t[1].cards[2],function(){e.showGameResult()})},i.prototype.pokerBoxAnim=function(t){if(t){var e=RES.getRes("l2h_json"),i=RES.getRes("l2h_png"),n=new egret.MovieClipDataFactory(e,i),r=new egret.MovieClip(n.generateMovieClipData("h-l"));this.grpBoxAnim.addChild(r),r.gotoAndPlay("l2h",6),r.addEventListener(egret.Event.COMPLETE,function(t){r.parent.removeChild(r)},this)}else{var e=RES.getRes("l2l_json"),i=RES.getRes("l2l_png"),n=new egret.MovieClipDataFactory(e,i),r=new egret.MovieClip(n.generateMovieClipData("h-l"));this.grpBoxAnim.addChild(r),r.gotoAndPlay("l2l",6),r.addEventListener(egret.Event.COMPLETE,function(t){r.parent.removeChild(r)},this)}},i.prototype.xianAinm=function(t,e){App.SoundManager.playEffect("bjl_bopai_mp3"),this.imgXPB.visible=!0;var i=egret.Tween.get(this.imgXPB,{loop:!0});i.to({alpha:0},100).wait(200).to({alpha:1},100).wait(200);var n=new egret.Timer(900,2),r=0;n.addEventListener(egret.TimerEvent.TIMER,function(){if(0==r){var e=this.pokerWaitArray.shift();this.pokerArray.push(e),e.setCard(t),this.grpTop.addChild(e);var i=this.grpXPool.x+220;e.ratateCard(i,190)}r++},this),n.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){this.imgXPB.visible=!1,e&&e()},this),n.start(),this.timerArray.push(n)},i.prototype.zhuangAinm=function(t,e){App.SoundManager.playEffect("bjl_bopai_mp3"),this.imgZPB.visible=!0;var i=egret.Tween.get(this.imgZPB,{loop:!0});i.to({alpha:0},100).wait(200).to({alpha:1},100).wait(200);var n=0,r=new egret.Timer(900,2);r.addEventListener(egret.TimerEvent.TIMER,function(){if(0==n){var e=this.pokerWaitArray.shift();this.pokerArray.push(e),e.setCard(t),this.grpTop.addChild(e);var i=this.grpZPool.x+220;e.ratateCard(i,190)}n++},this),r.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){this.imgZPB.visible=!1,e&&e()},this),r.start(),this.timerArray.push(r)},i.prototype.findUIChipBtns=function(){var t=this;this.btnContinue.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onContineClick,this),this.btnClear.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClearBetClick,this),this.btnContinue.enabled=!1,this.btnClear.enabled=!1,this.btnChipArray=[this.btnChip1,this.btnChip2,this.btnChip3,this.btnChip4,this.btnChip5,this.btnChip6,this.btnChip7,this.btnChip8],this.btnChipArray.forEach(function(e){e.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onBetClick,t),e.enabled=!1})},i.prototype.findUIBetInfo=function(){this.betInfoArray={};var e=new Object;this.grpBetInfo.$children.forEach(function(t){e[t.name]=t}),this.grpWinLight.$children.forEach(function(t){e[t.name]=t});for(var i=0;12>i;i++){var n=e["imgBetArea"+i],r=e["lbBetArea"+i];if(null!=n&&null!=r){var s=new t.BaccaratBetAreaItem(n,r);this.betInfoArray[i]=s}}},i.prototype.findUIBetAreaBtns=function(){var e=this;this.btnAreaArray={},this.btnAreaArray[0]=this.btnBetArea0,this.btnAreaArray[1]=this.btnBetArea1,this.btnAreaArray[2]=this.btnBetArea2,this.btnAreaArray[4]=this.btnBetArea4,this.btnAreaArray[9]=this.btnBetArea9,this.btnAreaArray;var i=function(i){n.btnAreaArray[i].addEventListener(egret.TouchEvent.TOUCH_TAP,function(n){e.curBet>0&&e.curBet<=t.BaccaratMgr.bjlModel.me.chips&&t.BaccaratReq.send_ReqBet(e.curBet,Number(i))},n),n.btnAreaArray[i].enabled=!1},n=this;for(var r in this.btnAreaArray)i(r)},i.prototype.findUIMyBetInfo=function(){this.myBetArray={};var e=new Object;this.grpMyBet.$children.forEach(function(t){e[t.name]=t});for(var i=0;12>i;i++){var n=e["grpMyBet"+i];if(null!=n){var r=new t.BaccaratMyBetItem(n);this.myBetArray[i]=r}}},i.prototype.findUISet=function(){this.btnSetDrag.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetDragClick,this),this.btnSet.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetClick,this),this.btnExit.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitClick,this),this.btnSetClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetClick,this),this.grpHint.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHintPanelClick,this),this.btnPlayer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPlayerClick,this),this.musicGroup=new eui.RadioButtonGroup,this.musicGroup.addEventListener(eui.UIEvent.CHANGE,this.musicRadioChange,this),this.rabMusicOn.group=this.musicGroup,this.rabMusicOff.group=this.musicGroup,App.SoundManager.bgOn?this.rabMusicOn.selected=!0:this.rabMusicOff.selected=!0,this.voiceGroup=new eui.RadioButtonGroup,this.voiceGroup.addEventListener(eui.UIEvent.CHANGE,this.voiceRadioChange,this),this.rabVoiceOn.group=this.voiceGroup,this.rabVoiceOff.group=this.voiceGroup,App.SoundManager.effectOn?this.rabVoiceOn.selected=!0:this.rabVoiceOff.selected=!0},i.prototype.clear=function(t){this.imgXPB.visible=!1,this.imgZPB.visible=!1,this.btnDuihuan.enabled=!0,t&&this.curBet&&App.SoundManager.playEffect("bjl_PAWN_BANKER_mp3");for(var e in this.betInfoArray)this.betInfoArray[e].clear();for(var e in this.myBetArray)this.myBetArray[e].clear();for(this.chipArray.forEach(function(t){t.recyle()}),this.tableChipArray.forEach(function(t){t.recyle()}),this.pokerArray.forEach(function(t){t.recyle()});this.timerArray.length>0;){var i=this.timerArray.pop();i.stop()}this.tableBets=[0,0,0,0,0,0,0,0,0,0,0,0],this.tableChipArray=new Array,this.chipArray=new Array,this.pokerArray=new Array,this.resultPanel.clear(),this.grpWinLight.visible=!1},i.prototype.setBetBtnState=function(e,i,n,r){if(r)return this.btnChipArray.forEach(function(t){t.enabled=!1}),this.btnContinue.enabled=!1,void(this.btnClear.enabled=!1);for(var s=0;8>s;s++){var o=t.BaccaratMgr.bjlModel.roomInfo.betOptions[s];o>e||o>i?this.btnChipArray[s].enabled=!1:this.btnChipArray[s].enabled=!0}this.curBet>e&&(this.curBet=0),this.lastBets=n;var a=0;n.forEach(function(t){a+=t}),e>=a&&a>0&&(this.btnContinue.enabled=!0)},i.prototype.setBetAreaState=function(t,e){for(var i in this.btnAreaArray)this.btnAreaArray[i].enabled=!e},i.prototype.setChipBtnText=function(){for(var e=0;e<this.btnChipArray.length;e++){var i=this.btnChipArray[e];i.label=this.setChipText(t.BaccaratMgr.bjlModel.roomInfo.betOptions[e])}},i.prototype.setChipText=function(t){var e="";return e=t>=1e8?Math.floor(t/1e8)+"亿":t>=1e4?Math.floor(t/1e4)+"万":t.toString()},i.prototype.onPlayerClick=function(t){var e=this.isOpenPlayer?-285:0;this.isOpenPlayer=!this.isOpenPlayer,egret.Tween.get(this.grpPlayerInfo).to({left:e},500)},i.prototype.onBetClick=function(e){var i=this.btnChipArray.indexOf(e.currentTarget),n=t.BaccaratMgr.bjlModel.roomInfo.betOptions[i];this.curBet=n},i.prototype.onContineClick=function(){for(var e=0;e<this.lastBets.length;e++)this.lastBets[e]>0&&(this.curBet=this.lastBets[e],t.BaccaratReq.send_ReqBet(this.lastBets[e],e))},i.prototype.onClearBetClick=function(){t.BaccaratReq.send_ReqClearBet()},i.prototype.onExitClick=function(){GameApp.HomeManager.reqExitCurGameTable()},i.prototype.showShuffle=function(t){var e=this,i={x:387,y:298};this.grpPaim.visible=!1,this.grpShuffle.visible=!0,this.imgShuffleYellow.visible=!0,egret.Tween.get(this.imgShuffleYellow).to({x:387,y:500},600).call(function(){e.imgShuffleYellow.visible=!1,egret.Tween.get(e.imgShufflePair).to({height:0},1500).call(function(){e.imgShufflePair.visible=!1,e.imgShufflePaim.visible=!1,egret.Tween.get(e.imgShufflePaim).to({x:387,y:660},200).call(function(){e.imgShufflePair.visible=!0,e.imgShufflePaim.visible=!0,e.imgShufflePair.y=810,egret.Tween.get(e.imgShufflePaim).to(i,1500),egret.Tween.get(e.imgShufflePair).to({x:387,y:410,height:416},1500).call(function(){e.imgShufflePair.visible=!1,e.imgShufflePaim.visible=!1,e.showShuffleCards(t)})})})})},i.prototype.showShuffleCards=function(e){var i=new Array,n=0,r=new egret.Timer(800,e.length+4);r.addEventListener(egret.TimerEvent.TIMER,function(){if(n<e.length){var r=new t.PokerItem;r.scaleX=.9,r.scaleY=.9,r.x=this.grpBoxAnim.x,r.y=30,r.setCard(e[n]),this.grpShuffle.addChild(r);var s=0,o=0;if(0==n)s=895,o=300;else{var a=Math.floor((n-1)/6)+1,h=(n-1)%6;s=520+150*h,o=300+200*a}i.push(r),r.sendCard(s,o,!0)}n==e.length+2&&i.forEach(function(t){t.recyle()}),n++},this),r.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){this.grpShuffle.visible=!1,this.imgShuffleYellow.visible=!1,this.imgShufflePair.visible=!0,this.imgShufflePaim.visible=!0,this.grpPaim.visible=!0,this.imgPaim.y=95},this),r.start(),this.timerArray.push(r)},i.prototype.onXBLHintClick=function(){this.imgHint.source=RES.getRes("bjl_img_json.bjl_bi"),this.grpHint.visible=!0},i.prototype.onZBLHintClick=function(){this.imgHint.source=RES.getRes("bjl_img_json.bjl_bi1"),this.grpHint.visible=!0},i.prototype.onHintPanelClick=function(){this.grpHint.visible=!1},i.prototype.onSetDragClick=function(){var t=this,e=0==this.grpSetPanel.right?-320:0;egret.Tween.get(this.grpSetPanel).to({right:e},500).call(function(){var e=0==t.grpSetPanel.right?"bjl_img_json.bjl_s_in":"bjl_img_json.bjl_s_out";t.imgSetDrag.source=RES.getRes(e)})},i.prototype.onSetClick=function(){this.grpSet.visible=!this.grpSet.visible},i.prototype.musicRadioChange=function(t){var e=t.target;App.SoundManager.setBgOn("1"==e.selectedValue.toString())},i.prototype.voiceRadioChange=function(t){var e=t.target;App.SoundManager.setEffectOn("1"==e.selectedValue.toString())},i.prototype.onDuihuanClick=function(){this.exchangeView.show(GameApp.PlayerInfo.safeGold,this.myInfo.chips,t.BaccaratMgr.bjlModel.roomInfo)},i.prototype.showDuihuan=function(){this.myInfo.chips<=0&&this.exchangeView.show(GameApp.PlayerInfo.safeGold,this.myInfo.chips,t.BaccaratMgr.bjlModel.roomInfo)},i.prototype.close=function(){this.timer&&(this.timer.stop(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.timerListener,this),this.timer=null),e.prototype.close.call(this)},i}(BaseEuiView);t.BaccaratView=e,__reflect(e.prototype,"baccarat.BaccaratView")}(baccarat||(baccarat={}));var baccarat;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName="resource/skins/game/baccarat/BJLChipSkin.exml",t}return __extends(i,e),i.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.touchEnabled=!1},i.prototype.setChip=function(e){this.lbChip.text=e+"";var i=t.BaccaratMgr.bjlModel.roomInfo.betOptions.indexOf(e);this.imgChipBg.source=RES.getRes("bjl_chips_json.bjl_btn_cm"+(i+1)+"2")},i.prototype.sendChip=function(t,e){var i=egret.Tween.get(this);i.to({x:t,y:e},300),i.call(function(){})},i.prototype.clear=function(){this.parent.removeChild(this)},i.prototype.recyle=function(){var t=this,e=egret.Tween.get(this);e.to({x:0,y:-200},300),e.call(function(){t.parent.removeChild(t)})},i}(eui.Component);t.ChipItem=e,__reflect(e.prototype,"baccarat.ChipItem")}(baccarat||(baccarat={}));var baccarat;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/game/baccarat/BJLPokerSkin.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.imgPokerFront.visible=!1},e.prototype.setCard=function(t){var e=RES.getRes("poker_config_json");if(e){var i=e.baccarat_card_data[t];this.imgPokerFront.source=RES.getRes(i.card_big)}else this.imgPokerFront.source=RES.getRes("poker_json.FKK")},e.prototype.sendCard=function(t,e,i){var n=this;App.SoundManager.playEffect("bjl_outcard_mp3");var r=egret.Tween.get(this);r.to({x:t,y:e},200),r.call(function(){i&&n.showCard()})},e.prototype.ratateCard=function(t,e){var i=this,n=egret.Tween.get(this);n.to({x:t,y:e,rotation:90},200),n.call(function(){i.showCard()})},e.prototype.showCard=function(){var t=this;App.SoundManager.playEffect("bjl_OpenCard_mp3");var e=egret.Tween.get(this.imgPokerBack);e.to({skewY:90},200,egret.Ease.sineOut),e.call(function(){t.imgPokerFront.visible=!0,t.imgPokerFront.skewY=270,egret.Tween.get(t.imgPokerFront).to({skewY:360},200,egret.Ease.sineIn)
})},e.prototype.clear=function(){this.parent.removeChild(this)},e.prototype.recyle=function(){var t=this,e=egret.Tween.get(this);this.imgPokerFront.visible=!1,this.imgPokerBack.skewY=0,e.to({x:160,y:300,rotation:0},300).wait(200).to({scaleX:.8,scaleY:.8},100).call(function(){t.parent.removeChild(t)})},e}(eui.Component);t.PokerItem=e,__reflect(e.prototype,"baccarat.PokerItem")}(baccarat||(baccarat={}));var baccarat;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.loaded=!1,e.addEventListener(eui.UIEvent.COMPLETE,e.onUIComplete,e),e.skinName="resource/skins/game/baccarat/BJLBigEyeItemSkin.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.onUIComplete=function(){this.loaded=!0,this.touchEnabled=!1,this.type&&this.id&&this.show()},e.prototype.setType=function(t,e){this.type=t,this.id=e,this.loaded&&this.show()},e.prototype.show=function(){1==this.type?this.imgIcon.source=1==this.id?RES.getRes("ludan_json.bjl_a_hqd"):RES.getRes("ludan_json.bjl_a_lqd"):this.imgIcon.source=1==this.id?RES.getRes("ludan_json.bjl_a_hqd"):RES.getRes("ludan_json.bjl_a_jqd")},e.prototype.anim=function(){var t=egret.Tween.get(this,{loop:!0});t.to({alpha:0},100).wait(200).to({alpha:1},100).wait(300)},e.prototype.clear=function(){this.parent.removeChild(this)},e}(eui.Component);t.BaccaratBigEyeWayItem=e,__reflect(e.prototype,"baccarat.BaccaratBigEyeWayItem")}(baccarat||(baccarat={}));var baccarat;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.loaded=!1,e.addEventListener(eui.UIEvent.COMPLETE,e.onUIComplete,e),e.skinName="resource/skins/game/baccarat/BJLBigWayItemSkin.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.onUIComplete=function(){this.loaded=!0,this.touchEnabled=!1,this.type&&this.result&&this.show()},e.prototype.setType=function(t,e,i){this.type=t,this.result=e,this.drawNum=i,this.loaded&&this.show()},e.prototype.show=function(){this.fntHeNum.visible=!1,this.imgHeIcon.visible=!1,1==this.type?(this.imgBigIcon.source=1==this.result?RES.getRes("ludan_json.bjl_d_hquan"):RES.getRes("ludan_json.bjl_d_lquan"),this.imgHeIcon.visible=this.drawNum>=1,this.drawNum>1&&(this.fntHeNum.visible=!0,this.fntHeNum.text=this.drawNum.toString())):(this.imgBigIcon.source=1==this.result?RES.getRes("ludan_json.bjl_d_hquan"):RES.getRes("ludan_json.bjl_d_jquan"),this.imgHeIcon.visible=this.drawNum>=1,this.drawNum>1&&(this.fntHeNum.visible=!0,this.fntHeNum.text=this.drawNum.toString()))},e.prototype.anim=function(){var t=egret.Tween.get(this,{loop:!0});t.to({alpha:0},100).wait(200).to({alpha:1},100).wait(300)},e.prototype.clear=function(){this.parent.removeChild(this)},e}(eui.Component);t.BaccaratBigWayItem=e,__reflect(e.prototype,"baccarat.BaccaratBigWayItem")}(baccarat||(baccarat={}));var baccarat;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.loaded=!1,e.addEventListener(eui.UIEvent.COMPLETE,e.onUIComplete,e),e.skinName="resource/skins/game/baccarat/BJLMainWayItemSkin.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.onUIComplete=function(){this.loaded=!0,this.touchEnabled=!1,this.type&&this.id&&this.show()},e.prototype.setType=function(t,e){this.type=t,this.id=e,this.loaded&&this.show()},e.prototype.show=function(){this.imgZdui.visible=!1,this.imgXdui.visible=!1;var t=["ludan_json.z_zhuang","ludan_json.z_he","ludan_json.z_xian","ludan_json.z_da","ludan_json.z_xiao","ludan_json.z_long","ludan_json.z_hu"];if(1==this.type){var e=Math.floor(this.id/4),i=this.id%4;this.imgZX.source=RES.getRes(t[e]),1==i?this.imgXdui.visible=!0:2==i?this.imgZdui.visible=!0:3==i&&(this.imgXdui.visible=!0,this.imgZdui.visible=!0)}else 2==this.type?3==this.id?this.imgZX.source=t[3]:this.imgZX.source=t[4]:3==this.type&&(1==this.id?this.imgZX.source=t[5]:2==this.id?this.imgZX.source=t[1]:this.imgZX.source=t[6])},e.prototype.clear=function(){this.parent.removeChild(this)},e}(eui.Component);t.BaccaratMainWayItem=e,__reflect(e.prototype,"baccarat.BaccaratMainWayItem")}(baccarat||(baccarat={}));var baccarat;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.loaded=!1,e.addEventListener(eui.UIEvent.COMPLETE,e.onUIComplete,e),e.skinName="resource/skins/game/baccarat/BJLSmallQWayItemSkin.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.onUIComplete=function(){this.loaded=!0,this.touchEnabled=!1,this.type&&this.id&&this.show()},e.prototype.setType=function(t,e){this.type=t,this.id=e,this.loaded&&this.show()},e.prototype.show=function(){1==this.type?this.imgIcon.source=1==this.id?RES.getRes("ludan_json.bjl_d_htiao"):RES.getRes("ludan_json.bjl_d_ltiao"):this.imgIcon.source=1==this.id?RES.getRes("ludan_json.bjl_d_htiao"):RES.getRes("ludan_json.bjl_d_jtiao")},e.prototype.anim=function(){var t=egret.Tween.get(this,{loop:!0});t.to({alpha:0},100).wait(200).to({alpha:1},100).wait(300)},e.prototype.clear=function(){this.parent.removeChild(this)},e}(eui.Component);t.BaccaratSmallStrongItem=e,__reflect(e.prototype,"baccarat.BaccaratSmallStrongItem")}(baccarat||(baccarat={}));var baccarat;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.loaded=!1,e.addEventListener(eui.UIEvent.COMPLETE,e.onUIComplete,e),e.skinName="resource/skins/game/baccarat/BJLSmallWayItemSkin.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.onUIComplete=function(){this.loaded=!0,this.touchEnabled=!1,this.type&&this.id&&this.show()},e.prototype.setType=function(t,e){this.type=t,this.id=e,this.loaded&&this.show()},e.prototype.show=function(){1==this.type?this.imgIcon.source=1==this.id?"ludan_json.bjl_a_hqs":"ludan_json.bjl_a_lqs":this.imgIcon.source=1==this.id?"ludan_json.bjl_a_hqs":"ludan_json.bjl_a_jqs"},e.prototype.anim=function(){var t=egret.Tween.get(this,{loop:!0});t.to({alpha:0},100).wait(200).to({alpha:1},100).wait(300)},e.prototype.clear=function(){this.parent.removeChild(this)},e}(eui.Component);t.BaccaratSmallWayItem=e,__reflect(e.prototype,"baccarat.BaccaratSmallWayItem")}(baccarat||(baccarat={}));var baccarat;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.loaded=!1,t.addEventListener(eui.UIEvent.COMPLETE,t.onUIComplete,t),t.skinName="resource/skins/game/baccarat/BJLWayBillSkin.exml",t}return __extends(i,e),i.prototype.onUIComplete=function(){this.loaded=!0,this.touchEnabled=!0,this.m_max_list=new Array,this.btnShowLoad.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowClick,this),this.tabLoad.addEventListener(egret.Event.CHANGE,this.loadChange,this),this.btnBLoadBJL.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bjlClick,this),this.btnBLoadLH.addEventListener(egret.TouchEvent.TOUCH_TAP,this.lhClick,this),this.btnLLoadBJL.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bjlClick,this),this.btnLLoadLH.addEventListener(egret.TouchEvent.TOUCH_TAP,this.lhClick,this),this.btnBLoadLH.visible=!1,this.btnLLoadBJL.visible=!1,this.btnLLoadLH.visible=!1,this.btnBLoadXWL.addEventListener(egret.TouchEvent.TOUCH_TAP,this.xianAskWayClick,this),this.btnBLoadZWL.addEventListener(egret.TouchEvent.TOUCH_TAP,this.zhuangAskWayClick,this),this.btnLoadLWL.addEventListener(egret.TouchEvent.TOUCH_TAP,this.longAskWayClick,this),this.btnLoadHWL.addEventListener(egret.TouchEvent.TOUCH_TAP,this.huAskWayClick,this),this.mainItemBJLArray=new Array,this.bigItemBJLArray=new Array,this.bigEyeItemBJLArray=new Array,this.smallItemBJLArray=new Array,this.smallStrongItemBJLArray=new Array,this.mainItemLHArray=new Array,this.bigItemLHArray=new Array,this.bigEyeItemLHArray=new Array,this.smallItemLHArray=new Array,this.smallStrongItemLHArray=new Array},i.prototype.onShowClick=function(t){this.grpBJLLoad.visible=!0,this.grpLHLoad.visible=!1;var e=0==this.y?-950:0;egret.Tween.get(this).to({y:e},500)},i.prototype.loadChange=function(t){this.vsBJLMainLoad.selectedIndex=this.tabLoad.selectedIndex},i.prototype.setData=function(t){this.billInfo=t,this.loaded&&this.renderView()},i.prototype.setStat=function(t){this.statInfo=t,this.loaded&&this.renderView()},i.prototype.renderView=function(){this.billInfo&&(this.vsBJLMainLoad.selectedIndex=this.tabLoad.selectedIndex,this.renderBView(),this.renderLView()),this.statInfo&&(this.lbBJLGameNum.text=this.statInfo.score.toString(),this.lbBJLHeNum.text=this.statInfo.tie.toString(),this.lbBJLZhuangNum.text=this.statInfo.bankerWin.toString(),this.lbBJLZPairNum.text=this.statInfo.bankerPaire.toString(),this.lbBJLXianNum.text=this.statInfo.playerWin.toString(),this.lbBJLXPairNum.text=this.statInfo.playerPaire.toString(),this.lbLHGameNum.text=this.statInfo.score.toString(),this.lbLHHeNum.text=this.statInfo.dragonTigerTie.toString(),this.lbLHLongNum.text=this.statInfo.dragon.toString(),this.lbLHHuNum.text=this.statInfo.tiger.toString())},i.prototype.renderBView=function(){var t=this.exchangeBaccaratBigItemData(this.billInfo.hisWaybill);this.bigItemData=this.getBigItemData(t,!1),this.showExChangeImg(1,t),this.showBJLMainItem(),this.showBigWayItem(1,this.bigItemData);var e=this.getItemDataByK(1,this.bigItemData),i=this.getItemDataByK(2,this.bigItemData),n=this.getItemDataByK(3,this.bigItemData);this.showBigEyeItem(1,e),this.showSmallItem(1,i),this.showSmallStrong(1,n)},i.prototype.renderLView=function(){this.bigLHItemData=this.getBigItemData(this.billInfo.hisDragon,!1),this.showExChangeImg(2,this.billInfo.hisDragon),this.showLHMainItem(),this.showBigWayItem(2,this.bigLHItemData);var t=this.getItemDataByK(1,this.bigLHItemData),e=this.getItemDataByK(2,this.bigLHItemData),i=this.getItemDataByK(3,this.bigLHItemData);this.showBigEyeItem(2,t),this.showSmallItem(2,e),this.showSmallStrong(2,i)},i.prototype.bjlClick=function(){this.grpBJLLoad.visible=!0,this.grpLHLoad.visible=!1},i.prototype.lhClick=function(){this.grpBJLLoad.visible=!1,this.grpLHLoad.visible=!0},i.prototype.zhuangAskWayClick=function(){var t=this.exchangeBaccaratBigItemData(this.billInfo.hisWaybill);t.push(1),this.bigItemData=this.getBigItemData(t,!0),this.showBigWayItem(1,this.bigItemData);var e=this.getItemDataByK(1,this.bigItemData),i=this.getItemDataByK(2,this.bigItemData),n=this.getItemDataByK(3,this.bigItemData);this.showBigEyeItem(1,e),this.showSmallItem(1,i),this.showSmallStrong(1,n)},i.prototype.xianAskWayClick=function(){var t=this.exchangeBaccaratBigItemData(this.billInfo.hisWaybill);t.push(3),this.bigItemData=this.getBigItemData(t,!0),this.showBigWayItem(1,this.bigItemData);var e=this.getItemDataByK(1,this.bigItemData),i=this.getItemDataByK(2,this.bigItemData),n=this.getItemDataByK(3,this.bigItemData);this.showBigEyeItem(1,e),this.showSmallItem(1,i),this.showSmallStrong(1,n)},i.prototype.longAskWayClick=function(){var t=this.billInfo.hisDragon.slice(0);t.push(1),this.bigLHItemData=this.getBigItemData(t,!0),this.showBigWayItem(2,this.bigLHItemData);var e=this.getItemDataByK(1,this.bigLHItemData),i=this.getItemDataByK(2,this.bigLHItemData),n=this.getItemDataByK(3,this.bigLHItemData);this.showBigEyeItem(2,e),this.showSmallItem(2,i),this.showSmallStrong(2,n)},i.prototype.huAskWayClick=function(){var t=this.billInfo.hisDragon.slice(0);t.push(3),this.bigLHItemData=this.getBigItemData(t,!0),this.showBigWayItem(2,this.bigLHItemData);var e=this.getItemDataByK(1,this.bigLHItemData),i=this.getItemDataByK(2,this.bigLHItemData),n=this.getItemDataByK(3,this.bigLHItemData);this.showBigEyeItem(2,e),this.showSmallItem(2,i),this.showSmallStrong(2,n)},i.prototype.showBJLMainItem=function(){var e=this;this.mainItemBJLArray.forEach(function(t){t.parent.removeChild(t)}),this.mainItemBJLArray=new Array,this.billInfo.hisWaybill.forEach(function(i){var n=new t.BaccaratMainWayItem;n.setType(1,i),e.grpBJLZXMainLoad.addChild(n),e.mainItemBJLArray.push(n)}),this.billInfo.hisBigSmall.forEach(function(i){var n=new t.BaccaratMainWayItem;n.setType(2,i),e.grpBJLDXMainLoad.addChild(n),e.mainItemBJLArray.push(n)})},i.prototype.showLHMainItem=function(){var e=this;this.mainItemLHArray.forEach(function(t){t.parent.removeChild(t)}),this.mainItemLHArray=new Array,this.billInfo.hisDragon.forEach(function(i){var n=new t.BaccaratMainWayItem;n.setType(3,i),e.grpLHMainLoad.addChild(n),e.mainItemLHArray.push(n)})},i.prototype.showBigWayItem=function(e,i){var n=this;1==e?(this.bigItemBJLArray.forEach(function(t){t.parent.removeChild(t)}),this.bigItemBJLArray=new Array):(this.bigItemLHArray.forEach(function(t){t.parent.removeChild(t)}),this.bigItemLHArray=new Array),i&&i.forEach(function(i){if(i.n<=8){if(n.m_max>24){var r=n.m_max-24;i.m=i.m-r}if(i.m-1>=0){var s=new t.BaccaratBigWayItem;s.setType(e,i.result,i.drawNum),s.x=31*(i.m-1)+1.3*i.m,s.y=31*(i.n-1)+i.n+1,1==e?(n.grpBJLBigWay.addChild(s),n.bigItemBJLArray.push(s)):(n.grpLHBigWay.addChild(s),n.bigItemLHArray.push(s)),i.bEffect&&s.anim()}}})},i.prototype.showBigEyeItem=function(e,i){var n=this;1==e?(this.bigEyeItemBJLArray.forEach(function(t){t.parent.removeChild(t)}),this.bigEyeItemBJLArray=new Array):(this.bigEyeItemLHArray.forEach(function(t){t.parent.removeChild(t)}),this.bigEyeItemLHArray=new Array),i&&i.forEach(function(i){if(i.n<=8){if(n.m_max_list[1]>24){var r=n.m_max_list[1]-24;i.m=i.m-r}if(i.m-1>=0){var s=new t.BaccaratBigEyeWayItem;s.setType(e,i.result),s.x=31*(i.m-1)+1.3*i.m,s.y=31*(i.n-1)+i.n+1,1==e?(n.grpBJLBigEyeWay.addChild(s),n.bigEyeItemBJLArray.push(s)):(n.grpLHBigEyeWay.addChild(s),n.bigEyeItemLHArray.push(s)),i.bEffect&&s.anim()}}})},i.prototype.showSmallItem=function(e,i){var n=this;1==e?(this.smallItemBJLArray.forEach(function(t){t.parent.removeChild(t)}),this.smallItemBJLArray=new Array):(this.smallItemLHArray.forEach(function(t){t.parent.removeChild(t)}),this.smallItemLHArray=new Array),i&&i.forEach(function(i){if(i.n<=8){if(n.m_max_list[2]>12){var r=n.m_max_list[1]-12;i.m=i.m-r}if(i.m-1>=0){var s=new t.BaccaratSmallWayItem;s.setType(e,i.result),s.x=31*(i.m-1)+1.1*i.m,s.y=31*(i.n-1)+i.n,1==e?(n.grpBJLSmallWay.addChild(s),n.smallItemBJLArray.push(s)):(n.grpLHSmallWay.addChild(s),n.smallItemLHArray.push(s)),i.bEffect&&s.anim()}}})},i.prototype.showSmallStrong=function(e,i){var n=this;1==e?(this.smallStrongItemBJLArray.forEach(function(t){t.parent.removeChild(t)}),this.smallStrongItemBJLArray=new Array):(this.smallStrongItemLHArray.forEach(function(t){t.parent.removeChild(t)}),this.smallStrongItemLHArray=new Array),i&&i.forEach(function(i){if(i.n<=8){if(n.m_max_list[3]>12){var r=n.m_max_list[1]-12;i.m=i.m-r}if(i.m-1>=0){var s=new t.BaccaratSmallStrongItem;s.setType(e,i.result),s.x=389+31*(i.m-1)+1.1*i.m,s.y=31*(i.n-1)+i.n,1==e?(n.grpBJLSmallWay.addChild(s),n.smallStrongItemBJLArray.push(s)):(n.grpLHSmallWay.addChild(s),n.smallStrongItemLHArray.push(s)),i.bEffect&&s.anim()}}})},i.prototype.exchangeBaccaratBigItemData=function(t){var e=new Array;return t.forEach(function(t){e.push(Math.floor(t/4)+1)}),e},i.prototype.getBigItemData=function(t,e){var i=[],n=1,r=1;if(this.m_max=1,t)for(var s in t){var o=t[s];if(2!=o){i[i.length-1]&&(o==i[i.length-1].result?r++:(n++,r=1,this.m_max=n));var a=i.length;e&&parseInt(s)==t.length-1?i[a]={result:o,drawNum:0,m:n,n:r,bEffect:!0}:i[a]={result:o,drawNum:0,m:n,n:r}}else if(i[i.length-1]){var h=i[i.length-1];h.drawNum++}}return i},i.prototype.getItemDataByK=function(t,e){var i=1,n=1;this.m_max_list[t]=1;var r=[];if(e)for(var s in e){var o=e[s],a=this.getResult(e,o,t);if(a){r.length>0&&r[r.length-1]&&(r[r.length-1].result==a?n++:(n=1,i++,this.m_max_list[t]=i));var h=r.length;o.bEffect&&parseInt(s)==e.length-1?r[h]={result:a,m:i,n:n,bEffect:!0}:r[h]={result:a,m:i,n:n}}}return r},i.prototype.getResult=function(t,e,i){var n=null;return e.m&&e.n&&(e.n>1?e.m>i&&(n=this.getPByK(e.m-i,t)+1==e.n?2:1):e.m>i&&(n=this.getPByK(e.m-i,t)+1==e.n?1:2)),n},i.prototype.getPByK=function(t,e){var i=0;for(var n in e){var r=e[n];r.m==t&&i++}return i},i.prototype.showExChangeImg=function(t,e){if(e){var i=e.slice(0),n=e.slice(0);i.push(1),n.push(3);var r=this.getBigItemData(i,!1),s=this.getBigItemData(n,!1),o=r[r.length-1],a=s[s.length-1];o&&(1==t?(this.imgSmallIconZhuang.source=2==this.getResult(r,o,2)?RES.getRes("ludan_json.bjl_t_lqiu"):RES.getRes("ludan_json.bjl_t_fqiu"),this.imgXQIconZhuang.source=2==this.getResult(r,o,3)?RES.getRes("ludan_json.bjl_t_lg"):RES.getRes("ludan_json.bjl_t_fg")):(this.imgSmallIconLong.source=2==this.getResult(r,o,2)?RES.getRes("ludan_json.bjl_t_jqiu"):RES.getRes("ludan_json.bjl_t_fqiu"),this.imgXQIconLong.source=2==this.getResult(r,o,3)?RES.getRes("ludan_json.bjl_t_jg"):RES.getRes("ludan_json.bjl_t_fg"))),a&&(1==t?(this.imgSmallIconXian.source=1==this.getResult(r,o,2)?RES.getRes("ludan_json.bjl_t_fqiu"):RES.getRes("ludan_json.bjl_t_lqiu"),this.imgXQIconXian.source=1==this.getResult(r,o,3)?RES.getRes("ludan_json.bjl_t_fg"):RES.getRes("ludan_json.bjl_t_lg")):(this.imgSmallIconHu.source=1==this.getResult(r,o,2)?RES.getRes("ludan_json.bjl_t_fqiu"):RES.getRes("ludan_json.bjl_t_jqiu"),this.imgXQIconHu.source=1==this.getResult(r,o,3)?RES.getRes("ludan_json.bjl_t_fg"):RES.getRes("ludan_json.bjl_t_jg")))}},i}(eui.Component);t.BaccaratWayBillView=e,__reflect(e.prototype,"baccarat.BaccaratWayBillView")}(baccarat||(baccarat={}));var brnn;!function(t){var e;!function(t){t[t.FANG_KUAI=0]="FANG_KUAI",t[t.MEI_HUA=1]="MEI_HUA",t[t.HONG_TAO=3]="HONG_TAO",t[t.HEI_TAO=4]="HEI_TAO",t[t.XIAO_WANG=5]="XIAO_WANG",t[t.DA_WANG=6]="DA_WANG"}(e=t.CardType||(t.CardType={}));var i=function(){function t(){}return t.ImgResConfig={"续押高亮":{key:"续押高亮",resPath:"game/bairenniuniu_std/resource/button/xy2.png"},"清空高亮":{key:"清空高亮",resPath:"game/bairenniuniu_std/resource/button/qk2.png"},"上分高亮":{key:"上分高亮",resPath:"game/bairenniuniu_std/resource/button/sf2.png"},"下分高亮":{key:"上分高亮",resPath:"game/bairenniuniu_std/resource/button/xf2.png"},"我要上庄":{key:"我要上庄",resPath:"game/bairenniuniu_std/resource/button/sz2.png"},"取消申请":{key:"取消申请",resPath:"game/bairenniuniu_std/resource/button/qxsq2.png"},"我要下庄":{key:"我要下庄",resPath:"game/bairenniuniu_std/resource/button/wyxz2.png"},"下注区域一":{key:"下注区域一",resPath:"game/bairenniuniu_std/resource/image/xzk.png"},"下注区域二":{key:"下注区域二",resPath:"game/bairenniuniu_std/resource/image/xzk.png"},"下注区域三":{key:"下注区域三",resPath:"game/bairenniuniu_std/resource/image/xzk.png"},"下注区域四":{key:"下注区域四",resPath:"game/bairenniuniu_std/resource/image/xzk.png"},"下注筹码一":{key:"下注筹码一",resPath:"game/bairenniuniu_std/resource/image/xzk.png"},"下注筹码二":{key:"下注筹码二",resPath:"game/bairenniuniu_std/resource/image/xzk.png"},"下注筹码三":{key:"下注筹码三",resPath:"game/bairenniuniu_std/resource/image/xzk.png"},"下注筹码四":{key:"下注筹码四",resPath:"game/bairenniuniu_std/resource/image/xzk.png"},"下注筹码五":{key:"下注筹码五",resPath:"game/bairenniuniu_std/resource/image/xzk.png"},"下注筹码六":{key:"下注筹码六",resPath:"game/bairenniuniu_std/resource/image/xzk.png"},"下注筹码七":{key:"下注筹码七",resPath:"game/bairenniuniu_std/resource/image/xzk.png"},"下注筹码八":{key:"下注筹码八",resPath:"game/bairenniuniu_std/resource/image/xzk.png"}},t.EffectConfig={"翻牌1":{key:"fanp",remarks:"翻牌1",file:"brnn_atlas2",picName:"fanp%d.png",frameTime:.1,beginFrame:1,length:8,isLoop:0,lifeTime:0,isMove:0,moveTime:0,beginPos:"",endPos:"",musicId:0},"翻牌2":{key:"fanp",remarks:"翻牌2",file:"brnn_atlas2",picName:"fanp%d.png",frameTime:.1,beginFrame:9,length:1,isLoop:0,lifeTime:0,isMove:0,moveTime:0,beginPos:"",endPos:"",musicId:0},"庄通吃":{key:"ztc",remarks:"庄通吃",file:"brnn_atlas2",picName:"tc%d.png",frameTime:.2,beginFrame:1,length:4,isLoop:0,lifeTime:0,isMove:0,moveTime:0,beginPos:"",endPos:"",musicId:0},"庄通赔":{key:"ztp",remarks:"庄通赔",file:"brnn_atlas2",picName:"tp%d.png",frameTime:.2,beginFrame:1,length:4,isLoop:0,lifeTime:0,isMove:0,moveTime:0,beginPos:"",endPos:"",musicId:0},"星星":{key:"broken_stars",remarks:"星星",file:"brnn_atlas2",picName:"Broken_stars_00%d.png",frameTime:.12,beginFrame:1,length:9,isLoop:1,lifeTime:0,isMove:0,moveTime:0,beginPos:"",endPos:"",musicId:0},crying:{key:"crying",remarks:"crying",file:"brnn_atlas2",picName:"cry%d.png",frameTime:.1,beginFrame:1,length:3,isLoop:1,lifeTime:0,isMove:0,moveTime:0,beginPos:"",endPos:"",musicId:0},10:{key:"niuniu",remarks:"牛牛",file:"brnn_atlas2",picName:"nn%d.png",frameTime:.2,beginFrame:1,length:5,isLoop:1,lifeTime:0,isMove:0,moveTime:0,beginPos:"",endPos:"",musicId:0},11:{key:"sihua",remarks:"四花",file:"brnn_atlas2",picName:"shn%d.png",frameTime:.2,beginFrame:1,length:5,isLoop:1,lifeTime:0,isMove:0,moveTime:0,beginPos:"",endPos:"",musicId:0},12:{key:"sizha",remarks:"四炸",file:"brnn_atlas2",picName:"szn%d.png",frameTime:.2,beginFrame:1,length:5,isLoop:1,lifeTime:0,isMove:0,moveTime:0,beginPos:"",endPos:"",musicId:0},13:{key:"wuhua",remarks:"五花",file:"brnn_atlas2",picName:"whn%d.png",frameTime:.2,beginFrame:1,length:5,isLoop:1,lifeTime:0,isMove:0,moveTime:0,beginPos:"",endPos:"",musicId:0},14:{key:"wuxiao",remarks:"五小",file:"brnn_atlas2",picName:"wxn%d.png",frameTime:.2,beginFrame:1,length:5,isLoop:1,lifeTime:0,isMove:0,moveTime:0,beginPos:"",endPos:"",musicId:0}},t.MusicConfig={MusicTable:{1:{id:1,resPath:"brnn_music_BGSOUND_mp3",desc:"背景音乐"}},OtherTable:{1:{id:1,resPath:"brnn_music_gamestart_mp3",desc:"游戏开始发牌"},2:{id:2,resPath:"brnn_music_BANKER_LOSE_mp3",desc:"游戏结束后，所有闲家获胜时使用"},3:{id:3,resPath:"brnn_music_BANKER_WIN_mp3",desc:"游戏结束后，所有闲家失败时使用"},4:{id:4,resPath:"brnn_music_PAWN_BANKER_mp3",desc:"筹码移动时使用"},5:{id:5,resPath:"brnn_music_outcard_mp3",desc:"每次发牌时使用，发5张牌则使用5次"},6:{id:6,resPath:"brnn_music_OpenCard2_mp3",desc:"摊牌时使用"},7:{id:7,resPath:"brnn_music_TURN_CARD_mp3",desc:"倒计时剩余5秒后使用"},8:{id:8,resPath:"brnn_music_PlAYER_ADD_SCORE_mp3",desc:"闲家下注阶段开始时使用"}},MaleTable:{2:{id:2,resPath:"brnn_music_M_CHANGE_BANKER_mp3",desc:"男上庄3选1"},3:{id:3,resPath:"brnn_music_M_GET_BIG_BANKER_0_mp3",desc:"男上庄3选1"},4:{id:4,resPath:"brnn_music_M_GET_BIG_BANKER_1_mp3",desc:"男上庄3选1"},6:{id:6,resPath:"brnn_music_M_OX_4ZHA_mp3",desc:"闲四炸"},7:{id:7,resPath:"brnn_music_M_GIVE_UP_BANKER_1_mp3",desc:"闲不抢庄"},8:{id:8,resPath:"brnn_music_M_LOSE_0_mp3",desc:"男输，2选1"},9:{id:9,resPath:"brnn_music_M_LOSE_1_mp3",desc:"男输，2选1"},10:{id:10,resPath:"brnn_music_M_OX_0_mp3",desc:"闲无牛"},11:{id:11,resPath:"brnn_music_M_OX_1_mp3",desc:"闲牛1"},12:{id:12,resPath:"brnn_music_M_OX_2_mp3",desc:"闲牛2"},13:{id:13,resPath:"brnn_music_M_OX_3_mp3",desc:"闲牛3"},14:{id:14,resPath:"brnn_music_M_OX_4_mp3",desc:"闲牛4"},15:{id:15,resPath:"brnn_music_M_OX_5_mp3",desc:"闲牛5"},16:{id:16,resPath:"brnn_music_M_OX_6_mp3",desc:"闲牛6"},17:{id:17,resPath:"brnn_music_M_OX_7_mp3",desc:"闲牛7"},18:{id:18,resPath:"brnn_music_M_OX_8_mp3",desc:"闲牛8"},19:{id:19,resPath:"brnn_music_M_OX_9_mp3",desc:"闲牛9"},20:{id:20,resPath:"brnn_music_M_OX_NIUNIU_mp3",desc:"闲牛牛"},21:{id:21,resPath:"brnn_music_M_OX_XIAO_NIU_mp3",desc:"闲五小牛"},23:{id:23,resPath:"brnn_music_M_WIN_0_mp3",desc:"闲赢，2选1"},24:{id:24,resPath:"brnn_music_M_WIN_1_mp3",desc:"闲赢，2选1"},25:{id:25,resPath:"brnn_music_M_OX_TAURUS_mp3",desc:"闲五花"},26:{id:26,resPath:"brnn_music_M_OX_4HUA_mp3",desc:"闲四花"}},FemaleTable:{2:{id:2,resPath:"brnn_music_F_CHANGE_BANKER_mp3",desc:"女玩家上庄3选1"},3:{id:3,resPath:"brnn_music_F_GET_BIG_BANKER_0_mp3",desc:"女玩家上庄3选1"},4:{id:4,resPath:"brnn_music_F_GET_BIG_BANKER_1_mp3",desc:"女玩家上庄3选1"},6:{id:6,resPath:"brnn_music_F_OX_4ZHA_mp3",desc:"庄四炸"},8:{id:8,resPath:"brnn_music_F_LOSE_0_mp3",desc:"女输，2选1"},9:{id:9,resPath:"brnn_music_F_LOSE_1_mp3",desc:"女输，2选1"},10:{id:10,resPath:"brnn_music_F_OX_0_mp3",desc:"庄无牛"},11:{id:11,resPath:"brnn_music_F_OX_1_mp3",desc:"庄牛1"},12:{id:12,resPath:"brnn_music_F_OX_2_mp3",desc:"庄牛2"},13:{id:13,resPath:"brnn_music_F_OX_3_mp3",desc:"庄牛3"},14:{id:14,resPath:"brnn_music_F_OX_4_mp3",desc:"庄牛4"},15:{id:15,resPath:"brnn_music_F_OX_5_mp3",desc:"庄牛5"},16:{id:16,resPath:"brnn_music_F_OX_6_mp3",desc:"庄牛6"},17:{id:17,resPath:"brnn_music_F_OX_7_mp3",desc:"庄牛7"},18:{id:18,resPath:"brnn_music_F_OX_8_mp3",desc:"庄牛8"},19:{id:19,resPath:"brnn_music_F_OX_9_mp3",desc:"庄牛9"},20:{id:20,resPath:"brnn_music_F_OX_NIUNIU_mp3",desc:"庄牛牛"},21:{id:21,resPath:"brnn_music_F_OX_XIAO_NIU_mp3",desc:"庄五小牛"},23:{id:23,resPath:"brnn_music_F_WIN_0_mp3",desc:"女赢，2选1"},24:{id:24,resPath:"brnn_music_F_WIN_1_mp3",desc:"女赢，2选1"},25:{id:25,resPath:"brnn_music_F_OX_TAURUS_mp3",desc:"庄五花"},26:{id:26,resPath:"brnn_music_F_OX_4HUA_mp3",desc:"庄四花"}}},t.CardData={0:{name:"方块 A",power:1,mathpower:1,type:e.FANG_KUAI,card_big:"brnn_atlas3_json.FKA",card_sm:"brnn_atlas3_json._FKA",card_mini:"cardxiao_01.png"},1:{name:"方块 2",power:2,mathpower:2,type:e.FANG_KUAI,card_big:"brnn_atlas3_json.FK2",card_sm:"brnn_atlas3_json._FK2",card_mini:"cardxiao_02.png"},2:{name:"方块 3",power:3,mathpower:3,type:e.FANG_KUAI,card_big:"brnn_atlas3_json.FK3",card_sm:"brnn_atlas3_json._FK3",card_mini:"cardxiao_03.png"},3:{name:"方块 4",power:4,mathpower:4,type:e.FANG_KUAI,card_big:"brnn_atlas3_json.FK4",card_sm:"brnn_atlas3_json._FK4",card_mini:"cardxiao_04.png"},4:{name:"方块 5",power:5,mathpower:5,type:e.FANG_KUAI,card_big:"brnn_atlas3_json.FK5",card_sm:"brnn_atlas3_json._FK5",card_mini:"cardxiao_05.png"},5:{name:"方块 6",power:6,mathpower:6,type:e.FANG_KUAI,card_big:"brnn_atlas3_json.FK6",card_sm:"brnn_atlas3_json._FK6",card_mini:"cardxiao_06.png"},6:{name:"方块 7",power:7,mathpower:7,type:e.FANG_KUAI,card_big:"brnn_atlas3_json.FK7",card_sm:"brnn_atlas3_json._FK7",card_mini:"cardxiao_07.png"},7:{name:"方块 8",power:8,mathpower:8,type:e.FANG_KUAI,card_big:"brnn_atlas3_json.FK8",card_sm:"brnn_atlas3_json._FK8",card_mini:"cardxiao_08.png"},8:{name:"方块 9",power:9,mathpower:9,type:e.FANG_KUAI,card_big:"brnn_atlas3_json.FK9",card_sm:"brnn_atlas3_json._FK9",card_mini:"cardxiao_09.png"},9:{name:"方块 10",power:10,mathpower:10,type:e.FANG_KUAI,card_big:"brnn_atlas3_json.FK10",card_sm:"brnn_atlas3_json._FK10",card_mini:"cardxiao_10.png"},10:{name:"方块 J",power:11,mathpower:10,type:e.FANG_KUAI,card_big:"brnn_atlas3_json.FKJ",card_sm:"brnn_atlas3_json._FKJ",card_mini:"cardxiao_11.png"},11:{name:"方块 Q",power:12,mathpower:10,type:e.FANG_KUAI,card_big:"brnn_atlas3_json.FKQ",card_sm:"brnn_atlas3_json._FKQ",card_mini:"cardxiao_12.png"},12:{name:"方块 K",power:13,mathpower:10,type:e.FANG_KUAI,card_big:"brnn_atlas3_json.FKK",card_sm:"brnn_atlas3_json._FKK",card_mini:"cardxiao_13.png"},13:{name:"梅花 A",power:1,mathpower:1,type:e.MEI_HUA,card_big:"brnn_atlas3_json.MHA",card_sm:"brnn_atlas3_json._MHA",card_mini:"cardxiao_14.png"},14:{name:"梅花 2",power:2,mathpower:2,type:e.MEI_HUA,card_big:"brnn_atlas3_json.MH2",card_sm:"brnn_atlas3_json._MH2",card_mini:"cardxiao_15.png"},15:{name:"梅花 3",power:3,mathpower:3,type:e.MEI_HUA,card_big:"brnn_atlas3_json.MH3",card_sm:"brnn_atlas3_json._MH3",card_mini:"cardxiao_16.png"},16:{name:"梅花 4",power:4,mathpower:4,type:e.MEI_HUA,card_big:"brnn_atlas3_json.MH4",card_sm:"brnn_atlas3_json._MH4",card_mini:"cardxiao_17.png"},17:{name:"梅花 5",power:5,mathpower:5,type:e.MEI_HUA,card_big:"brnn_atlas3_json.MH5",card_sm:"brnn_atlas3_json._MH5",card_mini:"cardxiao_18.png"},18:{name:"梅花 6",power:6,mathpower:6,type:e.MEI_HUA,card_big:"brnn_atlas3_json.MH6",card_sm:"brnn_atlas3_json._MH6",card_mini:"cardxiao_19.png"},19:{name:"梅花 7",power:7,mathpower:7,type:e.MEI_HUA,card_big:"brnn_atlas3_json.MH7",card_sm:"brnn_atlas3_json._MH7",card_mini:"cardxiao_20.png"},20:{name:"梅花 8",power:8,mathpower:8,type:e.MEI_HUA,card_big:"brnn_atlas3_json.MH8",card_sm:"brnn_atlas3_json._MH8",card_mini:"cardxiao_21.png"},21:{name:"梅花 9",power:9,mathpower:9,type:e.MEI_HUA,card_big:"brnn_atlas3_json.MH9",card_sm:"brnn_atlas3_json._MH9",card_mini:"cardxiao_22.png"},22:{name:"梅花 10",power:10,mathpower:10,type:e.MEI_HUA,card_big:"brnn_atlas3_json.MH10",card_sm:"brnn_atlas3_json._MH10",card_mini:"cardxiao_23.png"},23:{name:"梅花 J",power:11,mathpower:10,type:e.MEI_HUA,card_big:"brnn_atlas3_json.MHJ",card_sm:"brnn_atlas3_json._MHJ",card_mini:"cardxiao_24.png"},24:{name:"梅花 Q",power:12,mathpower:10,type:e.MEI_HUA,card_big:"brnn_atlas3_json.MHQ",card_sm:"brnn_atlas3_json._MHQ",card_mini:"cardxiao_25.png"},25:{name:"梅花 K",power:13,mathpower:10,type:e.MEI_HUA,card_big:"brnn_atlas3_json.MHK",card_sm:"brnn_atlas3_json._MHK",card_mini:"cardxiao_26.png"},26:{name:"红桃 A",power:1,mathpower:1,type:e.HONG_TAO,card_big:"brnn_atlas3_json.RHA",card_sm:"brnn_atlas3_json._RHA",card_mini:"cardxiao_27.png"},27:{name:"红桃 2",power:2,mathpower:2,type:e.HONG_TAO,card_big:"brnn_atlas3_json.RH2",card_sm:"brnn_atlas3_json._RH2",card_mini:"cardxiao_28.png"},28:{name:"红桃 3",power:3,mathpower:3,type:e.HONG_TAO,card_big:"brnn_atlas3_json.RH3",card_sm:"brnn_atlas3_json._RH3",card_mini:"cardxiao_29.png"},29:{name:"红桃 4",power:4,mathpower:4,type:e.HONG_TAO,card_big:"brnn_atlas3_json.RH4",card_sm:"brnn_atlas3_json._RH4",card_mini:"cardxiao_30.png"},30:{name:"红桃 5",power:5,mathpower:5,type:e.HONG_TAO,card_big:"brnn_atlas3_json.RH5",card_sm:"brnn_atlas3_json._RH5",card_mini:"cardxiao_31.png"},31:{name:"红桃 6",power:6,mathpower:6,type:e.HONG_TAO,card_big:"brnn_atlas3_json.RH6",card_sm:"brnn_atlas3_json._RH6",card_mini:"cardxiao_32.png"},32:{name:"红桃 7",power:7,mathpower:7,type:e.HONG_TAO,card_big:"brnn_atlas3_json.RH7",card_sm:"brnn_atlas3_json._RH7",card_mini:"cardxiao_33.png"},33:{name:"红桃 8",power:8,mathpower:8,type:e.HONG_TAO,card_big:"brnn_atlas3_json.RH8",card_sm:"brnn_atlas3_json._RH8",card_mini:"cardxiao_34.png"},34:{name:"红桃 9",power:9,mathpower:9,type:e.HONG_TAO,card_big:"brnn_atlas3_json.RH9",card_sm:"brnn_atlas3_json._RH9",card_mini:"cardxiao_35.png"},35:{name:"红桃 10",power:10,mathpower:10,type:e.HONG_TAO,card_big:"brnn_atlas3_json.RH10",card_sm:"brnn_atlas3_json._RH10",card_mini:"cardxiao_36.png"},36:{name:"红桃 J",power:11,mathpower:10,type:e.HONG_TAO,card_big:"brnn_atlas3_json.RHJ",card_sm:"brnn_atlas3_json._RHJ",card_mini:"cardxiao_37.png"},37:{name:"红桃 Q",power:12,mathpower:10,type:e.HONG_TAO,card_big:"brnn_atlas3_json.RHQ",card_sm:"brnn_atlas3_json._RHQ",card_mini:"cardxiao_38.png"},38:{name:"红桃 K",power:13,mathpower:10,type:e.HONG_TAO,card_big:"brnn_atlas3_json.RHK",card_sm:"brnn_atlas3_json._RHK",card_mini:"cardxiao_39.png"},39:{name:"黑桃 A",power:1,mathpower:1,type:e.HEI_TAO,card_big:"brnn_atlas3_json.HTA",card_sm:"brnn_atlas3_json._HTA",card_mini:"cardxiao_40.png"},40:{name:"黑桃 2",power:2,mathpower:2,type:e.HEI_TAO,card_big:"brnn_atlas3_json.HT2",card_sm:"brnn_atlas3_json._HT2",card_mini:"cardxiao_41.png"},41:{name:"黑桃 3",power:3,mathpower:3,type:e.HEI_TAO,card_big:"brnn_atlas3_json.HT3",card_sm:"brnn_atlas3_json._HT3",card_mini:"cardxiao_42.png"},42:{name:"黑桃 4",power:4,mathpower:4,type:e.HEI_TAO,card_big:"brnn_atlas3_json.HT4",card_sm:"brnn_atlas3_json._HT4",card_mini:"cardxiao_43.png"},43:{name:"黑桃 5",power:5,mathpower:5,type:e.HEI_TAO,card_big:"brnn_atlas3_json.HT5",card_sm:"brnn_atlas3_json._HT5",card_mini:"cardxiao_44.png"},44:{name:"黑桃 6",power:6,mathpower:6,type:e.HEI_TAO,card_big:"brnn_atlas3_json.HT6",card_sm:"brnn_atlas3_json._HT6",card_mini:"cardxiao_45.png"},45:{name:"黑桃 7",power:7,mathpower:7,type:e.HEI_TAO,card_big:"brnn_atlas3_json.HT7",card_sm:"brnn_atlas3_json._HT7",card_mini:"cardxiao_46.png"},46:{name:"黑桃 8",power:8,mathpower:8,type:e.HEI_TAO,card_big:"brnn_atlas3_json.HT8",card_sm:"brnn_atlas3_json._HT8",card_mini:"cardxiao_47.png"},47:{name:"黑桃 9",power:9,mathpower:9,type:e.HEI_TAO,card_big:"brnn_atlas3_json.HT9",card_sm:"brnn_atlas3_json._HT9",card_mini:"cardxiao_48.png"},48:{name:"黑桃 10",power:10,mathpower:10,type:e.HEI_TAO,card_big:"brnn_atlas3_json.HT10",card_sm:"brnn_atlas3_json._HT10",card_mini:"cardxiao_49.png"},49:{name:"黑桃 J",power:11,mathpower:10,type:e.HEI_TAO,card_big:"brnn_atlas3_json.HTJ",card_sm:"brnn_atlas3_json._HTJ",card_mini:"cardxiao_50.png"},50:{name:"黑桃 Q",power:12,mathpower:10,type:e.HEI_TAO,card_big:"brnn_atlas3_json.HTQ",card_sm:"brnn_atlas3_json._HTQ",card_mini:"cardxiao_51.png"},51:{name:"黑桃 K",power:13,mathpower:10,type:e.HEI_TAO,card_big:"brnn_atlas3_json.HTK",card_sm:"brnn_atlas3_json._HTK",card_mini:"cardxiao_52.png"},52:{name:"小王",power:14,mathpower:0,type:e.XIAO_WANG,card_big:"brnn_atlas3_json.J2",card_sm:"brnn_atlas3_json._J2",card_mini:"cardxiao_53.png"},53:{name:"大王",power:15,mathpower:0,type:e.DA_WANG,card_big:"brnn_atlas3_json.J1",card_sm:"brnn_atlas3_json._J1",card_mini:"cardxiao_54.png"},54:{name:"背景",card_big:"brnn_atlas3_json.dp",card_sm:"brnn_atlas3_json.dp",card_mini:"cardxiao_55.png"},55:{name:"横背景",card_big:"brnn_atlas3_json.dp1",card_sm:"brnn_atlas3_json.dp1",card_mini:"cardxiao_55.png"},56:{name:"翻牌",card_big:"brnn_atlas3_json.f8",card_sm:"brnn_atlas3_json.f8",card_mini:"cardxiao_55.png"}},t
}();t.BrnnConfig=i,__reflect(i.prototype,"brnn.BrnnConfig")}(brnn||(brnn={}));var brnn;!function(t){var e=function(){function e(){}return e.gsplit=function(t){if(!t||t.length<=0)return null;for(var e=[],i=0;i<t.length;i++){var n=t.charCodeAt(i);(n>=48&&57>=n||n>=65&&90>=n||n>=97&&122>=n)&&e.push(t.charAt(i))}return e},e.playSound=function(e,i){var n;n=0==i?t.BrnnConfig.MusicConfig.MaleTable:1==i?t.BrnnConfig.MusicConfig.FemaleTable:t.BrnnConfig.MusicConfig.OtherTable,n&&n[e]&&App.SoundManager.playEffect(n[e].resPath)},Object.defineProperty(e,"ObjectPool",{get:function(){return t.ObjectPool.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ChipsManager",{get:function(){return t.ChipsManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"BigCard",{get:function(){return t.BigCardsManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SmallCard",{get:function(){return t.SmallCardsManager.getInstance()},enumerable:!0,configurable:!0}),e.setRoomInfo=function(i){if(e.mainMoel||(e.mainMoel=new t.MainModel),e.mainMoel.roomInfo=i,e.mainMoel.roomInfo.betOptions)for(var n=0;n<e.mainMoel.roomInfo.betOptions.length;n++)e.mainMoel.roomInfo.betOptions[n]=e.mainMoel.roomInfo.betOptions[n].toNumber()},e.isEnterScene=function(){return e.mainMoel&&e.mainMoel.isEnterScene},e.setEnterScene=function(t){e.mainMoel&&(e.mainMoel.isEnterScene=t)},e.registerListener=function(){GameApp.HomeManager.registerModuleReqFunc(7,t.BrnnReq.registerCommonReq,t.BrnnReq),GameApp.HomeManager.registerModuleResFunc(7,t.BrnnRes.registerResListener,t.BrnnRes)},e.start=function(){e.gameStart||(e.gameStart=new t.BrnnStart),e.mainMoel||(e.mainMoel=new t.MainModel),e.gameStart.start()},e.finish=function(){e.gameStart&&e.gameStart.finish(),t.BrnnReq.removeCommonReq(),t.BrnnRes.removeResListener(),e.gameStart=null,e.mainMoel=null},e}();t.BrnnMgr=e,__reflect(e.prototype,"brnn.BrnnMgr")}(brnn||(brnn={}));var brnn;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.onEnter=function(){e.prototype.onEnter.call(this),this.addLayer(LayerManager.UI_Main)},i.prototype.onExit=function(){e.prototype.onExit.call(this),t.BrnnMgr.finish(),App.SoundManager.stopBg(),App.SoundManager.stopEffect()},i}(BaseScene);t.BrnnScene=e,__reflect(e.prototype,"brnn.BrnnScene")}(brnn||(brnn={}));var brnn;!function(t){var e=function(){function e(){}return e.prototype.start=function(){App.SceneManager.register(SceneConsts.Brnn,new t.BrnnScene),App.ResourceUtils.addConfig("resource/assets/games/brnn/brnn.res.json","resource/"),App.ResourceUtils.loadConfig(this.onConfigComplete,this),App.EasyLoading.showLoading("加载中 ...")},e.prototype.onConfigComplete=function(){App.ResourceUtils.loadGroup("brnn_loading_asset",function(){App.EasyLoading.hideLoading(),App.ControllerManager.register(ControllerConst.BrnnLoad,new t.LoadingController),App.SceneManager.runScene(SceneConsts.Brnn),App.ViewManager.open(ViewConst.BrnnLoad),this.loadResource()},function(){},this)},e.prototype.loadResource=function(){var t="brnnAssets",e=["brnn_asset"];App.ResourceUtils.loadGroups(t,e,this.onLoadComplete,this.onLoadProgress,this)},e.prototype.onLoadComplete=function(){App.ControllerManager.register(ControllerConst.BrnnMain,new t.MainController),App.ViewManager.open(ViewConst.BrnnMain)},e.prototype.onLoadProgress=function(t,e){App.ControllerManager.applyFunc(ControllerConst.BrnnLoad,ControllerConst.BrnnLoad,t,e)},e.prototype.finish=function(){var t=App.ViewManager.getView(ViewConst.BrnnMain);t&&t.finish(),App.ViewManager.unregister(ViewConst.BrnnLoad),App.ViewManager.unregister(ViewConst.BrnnMain),App.ControllerManager.unregister(ControllerConst.BrnnLoad),App.ControllerManager.unregister(ControllerConst.BrnnMain)},e}();t.BrnnStart=e,__reflect(e.prototype,"brnn.BrnnStart")}(brnn||(brnn={}));var brnn;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/brnn/BrnnBetAreaSkin.exml",e}return __extends(e,t),e.prototype.registerEvent=function(t,e,i){this.groupParent.addEventListener(egret.TouchEvent.TOUCH_TAP,function(n){e.apply(i,[t])},this),this.imgWin.visible=!1,this.reset()},e.prototype.setWin=function(t){this.imgWin.visible=t,t&&egret.Tween.get(this.imgWin,{loop:!0}).to({alpha:.1},500).to({alpha:1},500)},e.prototype.setMyBetChips=function(t){this.bmpMyBet.text=t.toString(),this.bmpMyBet.visible=t>0},e.prototype.setTotalBetChips=function(t){this.bmpTotalBet.text=t.toString(),this.bmpTotalBet.visible=t>0},e.prototype.reset=function(){this.bmpMyBet.text="0",this.bmpTotalBet.text="0",this.bmpMyBet.visible=!1,this.bmpTotalBet.visible=!1,this.imgWin.visible=!1},e}(eui.Component);t.BetArea=e,__reflect(e.prototype,"brnn.BetArea")}(brnn||(brnn={}));var brnn;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/brnn/BrnnBetBtnSkin.exml",e.btnChips=[],e}return __extends(e,t),e.prototype.registerListener=function(){var t=this;this.btnChips.push(this.btnChip1,this.btnChip2,this.btnChip3,this.btnChip4,this.btnChip5,this.btnChip6,this.btnChip7,this.btnChip8),this.btnChips.forEach(function(e){e.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onClickHandler,t)});for(var e=0;e<this.btnChips.length;e++)this.btnChips[e].enabled=!1},e.prototype.initBetOptions=function(t){if(this.betOptions=t,t&&t.length>0)for(var e=0;e<this.btnChips.length;e++){var i=this.btnChips[e].getChildAt(1);i.text=t[e]}},e.prototype.setOnBetHandler=function(t,e){this.onBetHandler=t,this.onBetObj=e},e.prototype.updateBtnStatus=function(t){for(var e=0;e<this.btnChips.length;e++){var i=this.betOptions[e];t>=i?this.btnChips[e].enabled=!0:this.btnChips[e].enabled=!1}},e.prototype.onClickHandler=function(t){var e=this.btnChips.indexOf(t.target);this.onBetHandler&&this.onBetObj&&this.onBetHandler.apply(this.onBetObj,[e+1])},e}(eui.Component);t.BetBtn=e,__reflect(e.prototype,"brnn.BetBtn")}(brnn||(brnn={}));var brnn;!function(t){var e;!function(t){t[t.ResEnterGame=100001]="ResEnterGame",t[t.SetRoomInfo=100002]="SetRoomInfo",t[t.LoadScene=100003]="LoadScene",t[t.ResEnterTable=100004]="ResEnterTable",t[t.ResBackTable=100005]="ResBackTable",t[t.ResEnterScene=100006]="ResEnterScene",t[t.ResOtherEnterTable=100007]="ResOtherEnterTable",t[t.ResChangeChips=100008]="ResChangeChips",t[t.ResExitTable=100009]="ResExitTable",t[t.ResExitRoom=100010]="ResExitRoom",t[t.ResApplyZuoZLst=100011]="ResApplyZuoZLst",t[t.ResSendCard=100012]="ResSendCard",t[t.ResBet=100013]="ResBet",t[t.ResClearBet=100014]="ResClearBet",t[t.ResTableBet=100015]="ResTableBet",t[t.ResNewDealer=100016]="ResNewDealer",t[t.ResBill=100017]="ResBill",t[t.ResHistory=100018]="ResHistory",t[t.ResGameStage=100019]="ResGameStage"}(e=t.BrnnResConst||(t.BrnnResConst={}))}(brnn||(brnn={}));var brnn;!function(t){var e=function(){function e(){}return e.prototype.checkMaxNiuNiuPower=function(t){return this.checkIsWuXiao(t)?i.WU_XIAO:this.checkIsWuHua(t)?i.WU_HUA:this.checkIsSiZha(t)?i.SI_HUA:this.checkIsSiHua(t)?i.SI_ZHA:this.getNormalNiuNiuMaxPower(t)},e.prototype.checkIsWuXiao=function(e){for(var i=0,n=0;n<e.lenth;n++){if(t.BrnnConfig.CardData[n].power>6)return!1;i+=t.BrnnConfig.CardData[n].power}return 10>=i?!0:!1},e.prototype.checkIsWuHua=function(e){for(var i=0;i<e.lenth;i++)return t.BrnnConfig.CardData[i].power<11||t.BrnnConfig.CardData[i].power>13?!1:!0},e.prototype.checkIsSiHua=function(e){for(var i=0,n=!1,r=0;r<e.lenth;r++){if(t.BrnnConfig.CardData[r].power>=11||t.BrnnConfig.CardData[r].power<=13)return!1;10==t.BrnnConfig.CardData[r].power&&(n=!0)}return 4==i&&n},e.prototype.checkIsSiZha=function(e){for(var i={},n=0;n<e.lenth;n++)i[t.BrnnConfig.CardData[n].power]?i[t.BrnnConfig.CardData[n].power]++:i[t.BrnnConfig.CardData[n].power]=1;return 2!=Object.keys(i).length||1!=i[Object.keys(i)[0]]&&4!=i[Object.keys(i)[0]]?!1:!0},e.prototype.getNormalNiuNiuMaxPower=function(e){for(var n=0,r=0,s=0,o=[],a=0;a<e.lenth;a++)r+=t.BrnnConfig.CardData[a].mathpower,t.BrnnConfig.CardData[a].type==t.CardType.DA_WANG||t.BrnnConfig.CardData[a].type==t.CardType.XIAO_WANG?s++:o.push(t.BrnnConfig.CardData[a]);if(0==s)for(var a=0;5>a;a++)for(var h=a;5>h;h++)for(var c=h;5>c;c++){var l=o[a].mathpower+o[h].mathpower+o[c].mathpower;l%10==0&&(l=(r-l)%10,l>n&&(n=l))}else if(1==s)for(var a=0;4>a;a++)for(var h=a;4>h;h++){var l=o[a].mathpower+o[h].mathpower;l%10>n&&(n=l)}else 2==s&&(n=i.NIU_NIU);return n},e}();t.CardCheck=e,__reflect(e.prototype,"brnn.CardCheck");var i;!function(t){t[t.MEI_NIU=0]="MEI_NIU",t[t.NIU_1=1]="NIU_1",t[t.NIU_2=2]="NIU_2",t[t.NIU_3=3]="NIU_3",t[t.NIU_4=4]="NIU_4",t[t.NIU_5=5]="NIU_5",t[t.NIU_6=6]="NIU_6",t[t.NIU_7=7]="NIU_7",t[t.NIU_8=8]="NIU_8",t[t.NIU_9=9]="NIU_9",t[t.NIU_NIU=10]="NIU_NIU",t[t.SI_HUA=11]="SI_HUA",t[t.SI_ZHA=12]="SI_ZHA",t[t.WU_HUA=13]="WU_HUA",t[t.WU_XIAO=14]="WU_XIAO"}(i=t.CardsKinds||(t.CardsKinds={}))}(brnn||(brnn={}));var brnn;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.cardScale=1,i.cardTypeRes=["brnn_atlas1_json.wn","brnn_atlas1_json.n1","brnn_atlas1_json.n2","brnn_atlas1_json.n3","brnn_atlas1_json.n4","brnn_atlas1_json.n5","brnn_atlas1_json.n6","brnn_atlas1_json.n7","brnn_atlas1_json.n8","brnn_atlas1_json.n9"],i.skinName="resource/skins/brnn/BrnnCardItemSkin.exml",i.imgCards=[],i.cardNum=0,i.idx=t,i}return __extends(i,e),i.prototype.setCardInfo=function(t){this.cardList=t.cards,this.cardType=t.cardsType},i.prototype.reset=function(){this.groupType.visible=!1,this.cardList=null,this.cardType=null,this.cardNum=0,this.imgCards&&this.imgCards.forEach(function(t){t.resumeOrgin()}),this.imgCards=[],this.effectMc&&this.effectMc.parent&&(this.effectMc.parent.removeChild(this.effectMc),this.effectMc=null),this.flopEffectMc&&this.flopEffectMc.parent&&(this.flopEffectMc.parent.removeChild(this.flopEffectMc),this.flopEffectMc=null),this.imgFlopCard&&this.imgFlopCard.parent&&this.imgFlopCard.resumeOrgin()},i.prototype.addCard=function(){if(this.cardList&&this.cardNum<5){var e=void 0;if(this.cardNum++,5==this.cardNum)e=t.BrnnMgr.BigCard.get(55,{x:0,y:0});else{var i=this.cardList[this.cardNum-1];e=t.BrnnMgr.BigCard.get(i,{x:0,y:0})}this.groupCard.addChild(e),this.imgCards.push(e);for(var n=this.imgCards.length,r=-(n-1)*e.width*this.cardScale/8+this.groupCard.width/2,s=0;n>s;s++){if(4==s){var o=r+2*e.width*this.cardScale/4;this.imgCards[s].x=o-10,this.imgCards[s].y=this.groupCard.height/2+30}else{var o=r+s*e.width*this.cardScale/4;this.imgCards[s].x=o,this.imgCards[s].y=this.groupCard.height/2}this.cardsPosX=r+e.width}}},i.prototype.showHiddenCard=function(){t.BrnnMgr.playSound(6);var e=this.cardList[4];this.imgCards[4]=t.BrnnMgr.BigCard.get(e,{x:0,y:0}),this.imgCards[4].visible=!0,this.imgCards[4].x=this.cardsPosX+22,this.imgCards[4].y=this.groupCard.height/2-20},i.prototype.addFlopCard=function(){var e=this,i=this.cardList[4],n={x:this.groupEffect.width/2+40,y:this.groupEffect.height/2+87};this.imgFlopCard=t.BrnnMgr.SmallCard.get(i,n),this.groupEffect.addChild(this.imgFlopCard),egret.Tween.get(this).wait(8/9*1e3).call(function(){e.imgFlopCard.resumeOrgin()},this),egret.Tween.get(this).wait(7/9*1e3).call(function(){e.removeFlopCard()},this)},i.prototype.removeFlopCard=function(){var t=this;this.flopEffectMc.gotoAndPlay(8),egret.Tween.get(this).wait(2/9*1e3).call(function(){t.flopEffectMc&&t.flopEffectMc.parent&&(t.flopEffectMc.parent.removeChild(t.flopEffectMc),t.flopEffectMc=null,t.showHiddenCard())},this).wait(300).call(function(){t.showCards(),t.showCardType()},this)},i.prototype.playFlopAnimation=function(){var e=this;if(!(!this.imgCards||this.imgCards.length<=0||this.imgCards.length<5)){this.imgCards[4].visible=!1;var i=t.BrnnConfig.EffectConfig["翻牌1"];this.flopEffectMc=GameApp.getClipByFileName(i.file,i.key),this.flopEffectMc.anchorOffsetX=this.flopEffectMc.width/2,this.flopEffectMc.anchorOffsetY=this.flopEffectMc.height/2,this.groupEffect.addChild(this.flopEffectMc),this.flopEffectMc.gotoAndPlay(1),this.flopEffectMc.x=this.groupEffect.width/2-10,this.flopEffectMc.y=this.groupEffect.height/2+47,egret.Tween.get(this).wait(7/9*1e3).call(function(){e.flopEffectMc.gotoAndStop(7),e.addFlopCard()},this)}},i.prototype.showCardType=function(e){void 0===e&&(e=!0);var i=0;if(i=this.idx<5?0:1,e)switch(this.cardType){case t.CardsKinds.SI_ZHA:t.BrnnMgr.playSound(6,i);break;case t.CardsKinds.MEI_NIU:t.BrnnMgr.playSound(10,i);break;case t.CardsKinds.NIU_1:t.BrnnMgr.playSound(11,i);break;case t.CardsKinds.NIU_2:t.BrnnMgr.playSound(12,i);break;case t.CardsKinds.NIU_3:t.BrnnMgr.playSound(13,i);break;case t.CardsKinds.NIU_4:t.BrnnMgr.playSound(14,i);break;case t.CardsKinds.NIU_5:t.BrnnMgr.playSound(15,i);break;case t.CardsKinds.NIU_6:t.BrnnMgr.playSound(16,i);break;case t.CardsKinds.NIU_7:t.BrnnMgr.playSound(17,i);break;case t.CardsKinds.NIU_8:t.BrnnMgr.playSound(18,i);break;case t.CardsKinds.NIU_9:t.BrnnMgr.playSound(19,i);break;case t.CardsKinds.NIU_NIU:t.BrnnMgr.playSound(20,i);break;case t.CardsKinds.WU_XIAO:t.BrnnMgr.playSound(21,i);break;case t.CardsKinds.WU_HUA:t.BrnnMgr.playSound(25,i);break;case t.CardsKinds.SI_HUA:t.BrnnMgr.playSound(26,i)}if(this.cardType>=t.CardsKinds.NIU_NIU){var n=t.BrnnConfig.EffectConfig[this.cardType];this.effectMc=GameApp.getClipByFileName(n.file,n.key),this.groupEffect.addChild(this.effectMc),this.effectMc.gotoAndPlay("act",-1),this.effectMc.anchorOffsetX=this.effectMc.width/2,this.effectMc.anchorOffsetY=this.effectMc.height/2,this.effectMc.x=this.groupEffect.width/2-20,this.effectMc.y=this.groupEffect.height/2+80}else this.imgType.texture=RES.getRes(this.cardTypeRes[this.cardType]),this.groupType.visible=!0},i.prototype.showCards=function(){if(this.imgCards.forEach(function(t){t.parent&&t.parent.removeChild(t)}),this.imgCards=[],this.cardType>t.CardsKinds.MEI_NIU){for(var e=3;5>e;e++){var i=t.BrnnMgr.BigCard.get(this.cardList[e],{x:0,y:0}),n=-i.width/4+this.groupCard.width/2,r=n+(e-3)*i.width/2;i.x=r,i.y=-i.height/3+this.groupCard.height/2+10,this.imgCards.push(i),this.groupCard.addChild(i)}for(var e=0;3>e;e++){var i=t.BrnnMgr.BigCard.get(this.cardList[e],{x:0,y:0}),n=-i.width/2+this.groupCard.width/2,r=n+e*i.width/2;i.x=r,i.y=this.groupCard.height/2+10,this.imgCards.push(i),this.groupCard.addChild(i)}}else for(var e=0;5>e;e++){var i=t.BrnnMgr.BigCard.get(this.cardList[e],{x:0,y:0}),n=-4*i.width/8+this.groupCard.width/2,r=n+e*i.width/4;i.x=r,i.y=this.groupCard.height/2+10,this.imgCards.push(i),this.groupCard.addChild(i)}},i}(eui.Component);t.CardItem=e,__reflect(e.prototype,"brnn.CardItem")}(brnn||(brnn={}));var brnn;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.preCreated=function(t){return new i(t)},n.prototype.get=function(e,i){var n=t.BrnnMgr.ObjectPool.getObject(t.ObjectClassType.Chips,e);return n.x=i.x,n.y=i.y,n.visible=!0,n.setUseState(!0),n},n}(BaseClass);t.ChipsManager=e,__reflect(e.prototype,"brnn.ChipsManager");var i=function(t){function e(e){var i=t.call(this)||this;return i.objId=e.objId,i.dataId=e.id,i.init(),i}return __extends(e,t),e.prototype.init=function(){var t="brnn_atlas1_json."+this.dataId;this.texture=RES.getRes(t),this.scaleX=.8,this.scaleY=.8,this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.touchEnabled=!1,this.visible=!1,this.setUseState(!1)},e.prototype.resumeOrgin=function(){this.visible=!1,this.setUseState(!1),this.parent&&this.parent.removeChild(this),this.x=0,this.y=0},Object.defineProperty(e.prototype,"tag",{get:function(){return this._tag},set:function(t){this._tag=t},enumerable:!0,configurable:!0}),e.prototype.getDataId=function(){return this.dataId},e.prototype.getObjId=function(){return this.objId},e.prototype.setUseState=function(t){this.isUse=t},e.prototype.getUseState=function(){return this.isUse},e}(eui.Image);t.Chip=i,__reflect(i.prototype,"brnn.Chip");var n=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.preCreated=function(t){return new s(t,!0)},i.prototype.get=function(e,i){var n=t.BrnnMgr.ObjectPool.getObject(t.ObjectClassType.BigCards,e);return n.x=i.x,n.y=i.y,n.visible=!0,n.setUseState(!0),n},i}(BaseClass);t.BigCardsManager=n,__reflect(n.prototype,"brnn.BigCardsManager");var r=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.preCreated=function(t){return new s(t,!1)},i.prototype.get=function(e,i){var n=t.BrnnMgr.ObjectPool.getObject(t.ObjectClassType.SmallCards,e);return n.x=i.x,n.y=i.y,n.visible=!0,n.setUseState(!0),n},i}(BaseClass);t.SmallCardsManager=r,__reflect(r.prototype,"brnn.SmallCardsManager");var s=function(e){function i(t,i){var n=e.call(this)||this;return n.objId=t.objId,n.dataId=t.id,n.init(i),n}return __extends(i,e),i.prototype.init=function(e){var i=t.BrnnConfig.CardData[this.dataId],n=e?i.card_big:i.card_sm;this.texture=RES.getRes(n),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.touchEnabled=!1,this.visible=!1,this.setUseState(!1)},i.prototype.resumeOrgin=function(){this.visible=!1,this.setUseState(!1),this.parent&&this.parent.removeChild(this),this.x=0,this.y=0},i.prototype.getDataId=function(){return this.dataId},i.prototype.getObjId=function(){return this.objId},i.prototype.setUseState=function(t){this.isUse=t},i.prototype.getUseState=function(){return this.isUse},i}(eui.Image);t.Card=s,__reflect(s.prototype,"brnn.Card")}(brnn||(brnn={}));var brnn;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.starsPos=[{x:1032,y:236},{x:1311,y:456},{x:687,y:272},{x:584,y:510}],t.skinName="resource/skins/brnn/BrnnClearingSkin.exml",t}return __extends(i,e),i.prototype.show=function(t,e){this.bmpDealerResult.text=0>t?t.toString():"+"+t,this.bmpMeResult.text=0>e?e.toString():"+"+e,this.playEffect(e)},i.prototype.playEffect=function(e){var i=this;if(e>=0)this.imgCow.visible=!0,this.imgShadow.visible=!0,e>0&&t.BrnnMgr.playSound(App.MathUtils.range(23,24),App.MathUtils.range(0,1));else{t.BrnnMgr.playSound(App.MathUtils.range(8,9),App.MathUtils.range(0,1)),App.MathUtils,this.imgCow.visible=!1,this.imgShadow.visible=!1;var n=t.BrnnConfig.EffectConfig.crying;this.cryingMc=GameApp.getClipByFileName(n.file,n.key),this.cryingMc.anchorOffsetX=this.cryingMc.width/2,this.cryingMc.anchorOffsetY=this.cryingMc.height/2,this.cryingMc.skewY=180,this.cryingMc.gotoAndPlay("act",-1),this.cryingMc.x=600,this.cryingMc.y=690,this.addChild(this.cryingMc)}this.visible=!0;var r=[0,1,2,3];this.mcList=[];for(var s=0;4>s;s++)egret.Tween.get(this).wait(900*s).call(function(){var e=Math.floor(Math.random()*r.length);e>=r.length&&(e=r.length-1);var n=r[e];r.splice(e,1);var s=i.starsPos[n],o=t.BrnnConfig.EffectConfig["星星"],a=GameApp.getClipByFileName(o.file,o.key);a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,GameApp.playMoveClip(i.groupContent,a,"act",s,-1),i.mcList.push(a)},this)},i.prototype.hide=function(){this.visible=!1,this.bmpDealerResult.text="0",this.bmpMeResult.text="0",this.mcList&&this.mcList.length>0&&(this.mcList.forEach(function(t){t.parent&&t.parent.removeChild(t)}),this.mcList=[]),this.cryingMc&&this.cryingMc.parent&&(this.cryingMc.parent.removeChild(this.cryingMc),this.cryingMc=null),this.visible=!1},i}(eui.Component);t.ClearingView=e,__reflect(e.prototype,"brnn.ClearingView")}(brnn||(brnn={}));var brnn;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.loadingBgRes=function(){return"brnn_atlas0_json.loading"},e.prototype.fillBgRes=function(){return"brnn_atlas0_json.loadbg"},e.prototype.fillRes=function(){return"brnn_atlas0_json.loadt"},e}(BaseLoadingView);t.LoadingView=e,__reflect(e.prototype,"brnn.LoadingView");var i=function(t){function i(){var i=t.call(this)||this;return i.loadingView=new e(i,LayerManager.UI_Main),App.ViewManager.register(ViewConst.BrnnLoad,i.loadingView),i.registerFunc(ControllerConst.BrnnLoad,i.setProgress,i),i}return __extends(i,t),i.prototype.setProgress=function(t,e){this.loadingView.setProgress(t,e)},i}(BaseController);t.LoadingController=i,__reflect(i.prototype,"brnn.LoadingController")}(brnn||(brnn={}));var brnn;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.mainView=new t.MainView(i,LayerManager.UI_Main),App.ViewManager.register(ViewConst.BrnnMain,i.mainView),i.registerResListener(),i}return __extends(i,e),i.prototype.registerResListener=function(){var e=this;this.registerFunc(t.BrnnResConst.ResExitRoom,function(t){e.mainView.finish(),LoginMgr.start()},this),this.registerFunc(t.BrnnResConst.ResChangeChips,function(i){3!=t.BrnnMgr.mainMoel.state&&(e.mainView.updateChips(!1),e.mainView.updateWaitView())},this),this.registerFunc(t.BrnnResConst.ResOtherEnterTable,function(t){},this),this.registerFunc(t.BrnnResConst.ResExitTable,function(e){e.order==t.BrnnMgr.mainMoel.seatOrder},this),this.registerFunc(t.BrnnResConst.ResApplyZuoZLst,function(){e.mainView.updateWaitView()},this),this.registerFunc(t.BrnnResConst.ResHistory,function(){e.mainView.updateRecordView()},this),this.registerFunc(t.BrnnResConst.ResSendCard,function(i){t.BrnnMgr.playSound(1),i.sort(function(t,e){return t.id-e.id}),e.mainView.sendCardsStage(i)},this),this.registerFunc(t.BrnnResConst.ResBet,function(i){i&&(t.BrnnMgr.mainMoel.totalBetChipsMap[i.area]?t.BrnnMgr.mainMoel.totalBetChipsMap[i.area]+=i.chips.toNumber():t.BrnnMgr.mainMoel.totalBetChipsMap[i.area]=i.chips.toNumber(),t.BrnnMgr.mainMoel.curBetChipsMap[i.area]?t.BrnnMgr.mainMoel.curBetChipsMap[i.area]+=i.chips.toNumber():t.BrnnMgr.mainMoel.curBetChipsMap[i.area]=i.chips.toNumber(),e.mainView.addBetChips(i.area,i.chips.toNumber(),!0),e.mainView.updateChips(!1),e.mainView.updateTotalBetChips(),e.mainView.updatePlayerBetChips())},this),this.registerFunc(t.BrnnResConst.ResTableBet,function(i){i&&i.length>0?i.forEach(function(i){if(t.BrnnMgr.mainMoel.totalBetChipsMap[i.area]){var n=i.chips.toNumber()-t.BrnnMgr.mainMoel.totalBetChipsMap[i.area];t.BrnnMgr.mainMoel.totalBetChipsMap[i.area]=i.chips.toNumber(),n>0&&e.mainView.addBetChips(i.area,n,!1)}else if(t.BrnnMgr.mainMoel.totalBetChipsMap[i.area]=i.chips.toNumber(),t.BrnnMgr.mainMoel.curBetChipsMap[i.area]){var n=i.chips.toNumber()-t.BrnnMgr.mainMoel.curBetChipsMap[i.area];n>0&&e.mainView.addBetChips(i.area,n,!1)}else e.mainView.addBetChips(i.area,i.chips.toNumber(),!1)}):(t.BrnnMgr.mainMoel.totalBetChipsMap={},t.BrnnMgr.mainMoel.curBetChipsMap={}),e.mainView.updateTotalBetChips(),e.mainView.updatePlayerBetChips()},this),this.registerFunc(t.BrnnResConst.ResNewDealer,function(i){3!=t.BrnnMgr.mainMoel.state&&e.mainView.updateBankerInfo()},this),this.registerFunc(t.BrnnResConst.ResBill,function(e){t.BrnnMgr.mainMoel.billInfo=e},this),this.registerFunc(t.BrnnResConst.ResClearBet,function(t){e.mainView.clearBetChips()},this),this.registerFunc(t.BrnnResConst.ResGameStage,function(t){e.mainView.resetGame()},this),this.registerFunc(t.BrnnResConst.ResBackTable,function(i){t.BrnnMgr.setEnterScene(!0),e.mainView.pauseGame(!1),i.room?(t.BrnnMgr.setRoomInfo(i.room),i.mems.forEach(function(e){t.BrnnMgr.mainMoel.addMember(e)}),i.gameInfo?(t.BrnnMgr.mainMoel.gameStage={state:i.gameInfo.stage,time:i.gameInfo.stageTime.toNumber()},t.BrnnMgr.mainMoel.histories=i.gameInfo.historyList,t.BrnnMgr.mainMoel.applicants=i.gameInfo.bankerApplicants,t.BrnnMgr.mainMoel.banker=i.gameInfo.bankerInfo,1!=t.BrnnMgr.mainMoel.state&&(e.mainView.resetUI(),i.gameInfo.myBetInfos&&i.gameInfo.myBetInfos.length>0&&(e.mainView.clearBetChips(),t.BrnnMgr.mainMoel.curBetChipsMap={},t.BrnnMgr.mainMoel.totalBetChipsMap={},i.gameInfo.myBetInfos.forEach(function(i){t.BrnnMgr.mainMoel.totalBetChipsMap[i.area]?t.BrnnMgr.mainMoel.totalBetChipsMap[i.area]+=i.chips.toNumber():t.BrnnMgr.mainMoel.totalBetChipsMap[i.area]=i.chips.toNumber(),t.BrnnMgr.mainMoel.curBetChipsMap[i.area]?t.BrnnMgr.mainMoel.curBetChipsMap[i.area]+=i.chips.toNumber():t.BrnnMgr.mainMoel.curBetChipsMap[i.area]=i.chips.toNumber(),e.mainView.addBetChips(i.area,i.chips.toNumber(),!0)}),e.mainView.updateTotalBetChips(),e.mainView.updatePlayerBetChips()),(t.BrnnMgr.mainMoel.isBet()||2==t.BrnnMgr.mainMoel.state)&&i.gameInfo.tableBetInfos&&i.gameInfo.tableBetInfos.length>0&&(i.gameInfo.tableBetInfos.forEach(function(i){if(t.BrnnMgr.mainMoel.totalBetChipsMap[i.area]){var n=i.chips.toNumber()-t.BrnnMgr.mainMoel.totalBetChipsMap[i.area];t.BrnnMgr.mainMoel.totalBetChipsMap[i.area]=i.chips.toNumber(),n>0&&e.mainView.addBetChips(i.area,i.chips.toNumber(),!1)}else t.BrnnMgr.mainMoel.totalBetChipsMap[i.area]=i.chips.toNumber(),e.mainView.addBetChips(i.area,i.chips.toNumber(),!1)}),e.mainView.updateTotalBetChips(),e.mainView.updatePlayerBetChips())),e.mainView.backTable(),3==t.BrnnMgr.mainMoel.state&&i.gameInfo.cardsInfo&&(i.gameInfo.cardsInfo.sort(function(t,e){return t.id-e.id}),i.gameInfo.balanceInfo&&t.BrnnMgr.mainMoel.isBet()&&(t.BrnnMgr.mainMoel.billInfo=i.gameInfo.balanceInfo,e.mainView.showCards(i.gameInfo.cardsInfo,t.BrnnMgr.mainMoel.countDown))),e.mainView.updateWaitView(),e.mainView.updateRecordView()):e.mainView.backTable()):LoginMgr.start()},this)},i}(BaseController);t.MainController=e,__reflect(e.prototype,"brnn.MainController")}(brnn||(brnn={}));var brnn;!function(t){var e=function(){function t(){this.isEnterScene=!1,this.lastBetChips={},this.curBetChipsMap={},this.totalBetChips={},this.totalBetChipsMap={},this.lastBetChips={},this.curBetChipsMap={},this.chips=0,this.seatOrder=0,this.selectedChipIdx=null,this.totalBetChipsMap={}}return t.prototype.addMember=function(t){this.members||(this.members={}),t&&t.playerId&&(GameApp.PlayerInfo.isMySelf(t.playerId)&&(this.seatOrder=t.order,this.chips=t.chips.toNumber()),this.members[t.playerId.toNumber()]=t)},t.prototype.removeMember=function(t){this.members&&delete this.members[t]},t.prototype.getMember=function(t){return this.members?this.members[t]:null},t.prototype.updateMemberChips=function(t,e){if(this.members){var i=this.members[t];i&&(i.chips=e)}},t.prototype.applyList=function(){var t=this,e=[];return this.applicants&&this.applicants.length&&this.members&&this.applicants.forEach(function(i){var n=t.getMember(i.toNumber());n&&(GameApp.PlayerInfo.isMySelf(i)?e.push({nickname:GameApp.PlayerInfo.nickName,gold:t.chips}):e.push({nickname:n.playerName,gold:n.gold.toNumber()}))}),e},t.prototype.isApply=function(){if(this.applicants)for(var t=0;t<this.applicants.length;t++)if(this.applicants[t].equals(GameApp.PlayerInfo.id))return!0;return this.isBanker()},t.prototype.isBanker=function(){return this.banker&&GameApp.PlayerInfo.isMySelf(this.banker.playerId)},Object.defineProperty(t.prototype,"state",{get:function(){return this.gameStage?this.gameStage.state:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"countDown",{get:function(){return this.gameStage?this.gameStage.time:0},enumerable:!0,configurable:!0}),t.prototype.descTime=function(){this.gameStage&&this.gameStage.time>0&&(this.gameStage.time-=1)},t.prototype.getBankerIcon=function(){if(!this.banker)return null;var t=this.getMember(this.banker.playerId.toNumber());return t?t.icon:null},t.prototype.isBet=function(){if(this.curBetChipsMap&&Object.keys(this.curBetChipsMap).length>0){var t=0;for(var e in this.curBetChipsMap)this.curBetChipsMap[e]&&(t+=this.curBetChipsMap[e]);return t>0}return!1},t.prototype.getCurBetRequireChips=function(){if(this.curBetChipsMap&&Object.keys(this.curBetChipsMap).length>0){var t=0;for(var e in this.curBetChipsMap)this.curBetChipsMap[e]&&(t+=this.curBetChipsMap[e]);return t}return 0},t.prototype.isChipsEnoughForApplyBanker=function(){return this.chips>=this.roomInfo.beBankerChips.toNumber()},t.prototype.isCanContinue=function(){if(this.lastBetChips&&Object.keys(this.lastBetChips).length>0){var t=0;for(var e in this.lastBetChips)this.lastBetChips[e]&&(t+=this.lastBetChips[e]);return this.chips>t}return!1},t.prototype.getContinueRequireChips=function(){if(this.lastBetChips&&Object.keys(this.lastBetChips).length>0){var t=0;for(var e in this.lastBetChips)this.lastBetChips[e]&&(t+=this.lastBetChips[e]);return t}return 0},t}();t.MainModel=e,__reflect(e.prototype,"brnn.MainModel")}(brnn||(brnn={}));var brnn;!function(t){var e=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n.sendCards=[],n.chipsRes=["1","10","100","1000","10000","100000","1000000","10000000"],n.areaNumLst={1:[0,0,0,0,0,0,0,0],2:[0,0,0,0,0,0,0,0],3:[0,0,0,0,0,0,0,0],4:[0,0,0,0,0,0,0,0]},n.cardItemListPos={1:{x:127.5,y:70},2:{x:408.5,y:70},3:{x:688.5,y:70},4:{x:967.5,y:70},5:{x:545.5,y:-510}},n.binTable=[[0,0,0,0],[0,0,0,1],[0,0,1,0],[0,0,1,1],[0,1,0,0],[0,1,0,1],[0,1,1,0],[0,1,1,1],[1,0,0,0],[1,0,0,1],[1,0,1,0],[1,0,1,1],[1,1,0,0],[1,1,0,1],[1,1,1,0],[1,1,1,1]],n.playerChipsPos=[{x:30,y:647},{x:1858,y:868},{x:1890,y:440}],n.skinName="resource/skins/brnn/BrnnMainSkin.exml",n.chipsLst={},n}return __extends(i,e),i.prototype.initUI=function(){e.prototype.initUI.call(this),this.registerEvent(),this.createBetAreas(),this.createCardItems(),this.imgState.visible=!1,this.bmpClock.text="",this.bmpClock.visible=!1,t.BrnnMgr.ObjectPool.init()},i.prototype.initData=function(){e.prototype.initData.call(this),t.BrnnMgr.ObjectPool.registerObjectCreater(t.ObjectClassType.Chips,t.BrnnMgr.ChipsManager),this.chipsRes.forEach(function(e){t.BrnnMgr.ObjectPool.newSomeObject(t.ObjectClassType.Chips,e,20)}),t.BrnnMgr.ObjectPool.registerObjectCreater(t.ObjectClassType.BigCards,t.BrnnMgr.BigCard);for(var i in t.BrnnConfig.CardData)t.BrnnMgr.ObjectPool.newSomeObject(t.ObjectClassType.BigCards,i,2);t.BrnnMgr.ObjectPool.registerObjectCreater(t.ObjectClassType.SmallCards,t.BrnnMgr.SmallCard);for(var i in t.BrnnConfig.CardData)t.BrnnMgr.ObjectPool.newSomeObject(t.ObjectClassType.SmallCards,i,2)},i.prototype.open=function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];e.prototype.open.call(this,i),t.BrnnReq.send_ReqBackTable()},i.prototype.registerEvent=function(){this.recordView.registerTouchEvent(),this.recordView.hide(),this.clearingView.hide(),this.exchangeView.hide(),this.setView.show(!1),this.setView.registerEvent(function(){App.SoundManager.playBg(t.BrnnConfig.MusicConfig.MusicTable[1].resPath)},this),this.betBtn.visible=!1,this.waitView.visible=!1,this.groupCountdown.visible=!1,this.waitView.init(function(e){e?t.BrnnMgr.mainMoel.applicants&&t.BrnnMgr.mainMoel.applicants.length>=4?GameApp.PromotManager.floatingTip("对不起，当前庄家列队已满，请您稍后再试。"):t.BrnnMgr.mainMoel.isChipsEnoughForApplyBanker()?t.BrnnReq.send_ReqApplyZuoZ():GameApp.PromotManager.floatingTip("上庄筹码为："+t.BrnnMgr.mainMoel.roomInfo.beBankerChips+"，您的筹码不足"):t.BrnnMgr.mainMoel.isBanker()?1==t.BrnnMgr.mainMoel.state?t.BrnnReq.send_ReqApplyCancelZuoZ():GameApp.PromotManager.oneButtonTip("请在休息阶段下庄"):t.BrnnReq.send_ReqCancelZuoZ()},this),this.exchangeView.registerEvent(function(e,i){if(0>=i)return void GameApp.PromotManager.floatingTip("兑换筹码必须大于0");switch(e){case game.ExchangeType.CashIn:2!=t.BrnnMgr.mainMoel.state?t.BrnnReq.send_ReqExchangeGolds(i):GameApp.PromotManager.oneButtonTip("游戏阶段不能下分");break;case game.ExchangeType.CashOut:t.BrnnReq.send_ReqExchangeChips(i)}},this),this.btnExit.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.btnHelp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.btnHistory.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.btnSet.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.btnExchange.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.btnClear.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.btnContinue.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.btnSZLst.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.groupHelp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.betBtn.registerListener(),this.betBtn.setOnBetHandler(this.onBetHandler,this),this.timer=new egret.Timer(1e3),this.timer.addEventListener(egret.TimerEvent.TIMER,this.updateCountdownAndState,this),this.timer.start()
},i.prototype.resetGame=function(){this.calculateContinue(),this.betBtn.visible=!1,this.btnClear.enabled=!1,this.btnExchange.enabled=!1,1==t.BrnnMgr.mainMoel.state?(this.groupCountdown.visible=!0,this.btnExchange.enabled=!0,t.BrnnMgr.mainMoel.lastBetChips=GameApp.clone(t.BrnnMgr.mainMoel.curBetChipsMap),this.resetUI()):2==t.BrnnMgr.mainMoel.state?(this.clearingView.hide(),this.btnExchange.enabled=!0,t.BrnnMgr.mainMoel.selectedChipIdx=null,t.BrnnMgr.mainMoel.countDown>5&&t.BrnnMgr.playSound(8),t.BrnnMgr.mainMoel.isBanker()?(this.betBtn.visible=!1,this.groupCountdown.visible=!1):(this.betBtn.visible=!0,this.btnClear.enabled=t.BrnnMgr.mainMoel.isBet(),this.groupCountdown.visible=!0)):3==t.BrnnMgr.mainMoel.state&&(this.groupCountdown.visible=!0,t.BrnnMgr.mainMoel.lastBetChips={}),t.BrnnMgr.mainMoel.state&&(this.imgState.texture=RES.getRes("brnn_atlas1_json.bairenniuniu_state_"+t.BrnnMgr.mainMoel.state),this.imgState.visible=!0),this.bmpClock.text=t.BrnnMgr.mainMoel.countDown,this.bmpClock.visible=!0},i.prototype.resetUI=function(){this.removeSendCard();for(var e in this.cardItemList)this.cardItemList[e].reset();this.areaNumLst={1:[0,0,0,0,0,0,0,0],2:[0,0,0,0,0,0,0,0],3:[0,0,0,0,0,0,0,0],4:[0,0,0,0,0,0,0,0]};for(var e in this.chipsLst){var i=this.chipsLst[e];i&&i.length>0&&i.forEach(function(t){t.resumeOrgin()})}this.chipsLst={};for(var e in this.betAreas){var n=this.betAreas[e];n.reset()}this.clearingView.hide(),t.BrnnMgr.mainMoel.totalBetChipsMap={},t.BrnnMgr.mainMoel.curBetChipsMap={},this.updateTotalBetChips(),this.updatePlayerBetChips()},i.prototype.createCardItems=function(){this.cardItemList={};for(var e=1;5>=e;e++){var i=new t.CardItem(e);i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2;var n=this.cardItemListPos[e];i.x=n.x,i.y=n.y,this.groupCards.addChild(i),this.cardItemList[e]=i,i.reset()}},i.prototype.createBetAreas=function(){this.betAreas={};for(var e=1;4>=e;e++){var i=new t.BetArea;i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2;var n=this.cardItemListPos[e];i.x=n.x,i.y=i.height/2,this.groupChips.addChild(i),this.betAreas[e]=i,i.registerEvent(e,function(e){if(2==t.BrnnMgr.mainMoel.state&&t.BrnnMgr.mainMoel.selectedChipIdx){var i=t.BrnnMgr.mainMoel.selectedChipIdx-1;t.BrnnReq.send_ReqBet(e,t.BrnnMgr.mainMoel.roomInfo.betOptions[i])}},this)}},i.prototype.onClickHandler=function(e){switch(e.target){case this.btnExit:t.BrnnMgr.mainMoel.isBet()?1==t.BrnnMgr.mainMoel.state?t.BrnnReq.send_ReqExitTable():GameApp.PromotManager.floatingTip("游戏进行中，请在休息阶段退出"):t.BrnnReq.send_ReqExitTable();break;case this.btnHelp:this.groupHelp.visible=!0;break;case this.btnHistory:this.recordView.show(t.BrnnMgr.mainMoel.histories);break;case this.btnSet:this.setView.show(!0);break;case this.btnExchange:this.exchangeView.show(GameApp.PlayerInfo.safeGold,t.BrnnMgr.mainMoel.chips,t.BrnnMgr.mainMoel.roomInfo);break;case this.btnClear:t.BrnnReq.send_ReqClearBet();break;case this.btnContinue:this.continueBet();break;case this.btnSZLst:this.waitView.show(t.BrnnMgr.mainMoel.applyList(),t.BrnnMgr.mainMoel.isApply());break;case this.groupHelp:this.groupHelp.visible=!1}},i.prototype.onBetHandler=function(e){t.BrnnMgr.mainMoel.selectedChipIdx=e},i.prototype.sendCardsStage=function(e){for(var i=0;i<e.length;i++)this.cardItemList[i+1].setCardInfo(e[i]);var n=this,r=function(){for(var e=function(e){var i=function(){n.cardItemList[e].addCard(),t.BrnnMgr.playSound(5)},r=n.cardItemList[e].parent.localToGlobal(n.cardItemList[e].x,n.cardItemList[e].y);egret.Tween.get(n).wait(100*(e-1)).call(function(){n.showSendHandCardAction(r,i)})},i=1;5>=i;i++)e(i)},s=function(){for(var t=function(t){egret.Tween.get(n).wait(2400*(t-1)).call(function(){n.cardItemList[t].playFlopAnimation()})},e=1;5>=e;e++)t(e)};egret.Tween.get(n).wait(0).call(function(){for(var t=1;5>=t;t++)egret.Tween.get(n).wait(500*(t-1)).call(function(){r()})}).wait(3e3).call(function(){s()}).wait(12e3).call(function(){n.playBlinkAnimation()}).wait(1e3).call(function(){n.openClearingView()}).wait(1e3).call(function(){n.playBankerAnimation()})},i.prototype.showSendHandCardAction=function(e,i){var n=new eui.Image;this.sendCards.push(n),n.texture=RES.getRes(t.BrnnConfig.CardData[54].card_big),n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2;var r=this.cardStartRect.parent.localToGlobal(this.cardStartRect.x,this.cardStartRect.y);n.x=r.x,n.y=r.y,this.addChild(n),egret.Tween.get(n).to({x:e.x,y:e.y},200).call(function(){n.parent&&n.parent.removeChild(n),i()},this)},i.prototype.playBlinkAnimation=function(){if(t.BrnnMgr.mainMoel.histories&&t.BrnnMgr.mainMoel.histories.length>0)for(var e=t.BrnnMgr.mainMoel.histories[0],i=this.binTable[e],n=0;n<i.length;n++)this.betAreas[n+1].setWin(i[n]>0)},i.prototype.updateChips=function(e){(e||3!=t.BrnnMgr.mainMoel.state)&&this.updatePlayerInfo(),this.updateBtnChipsState()},i.prototype.updatePlayerInfo=function(){this.lbGold.text=t.BrnnMgr.mainMoel.chips,this.lbNick.text=GameApp.PlayerInfo.nickName,this.imgHead.texture=GameApp.PlayerInfo.getHeadTexture()},i.prototype.updateBtnChipsState=function(){this.betBtn.updateBtnStatus(t.BrnnMgr.mainMoel.chips),this.calculateContinue()},i.prototype.calculateContinue=function(){t.BrnnMgr.mainMoel.isBanker()||2!=t.BrnnMgr.mainMoel.state?this.btnContinue.enabled=!1:t.BrnnMgr.mainMoel.isCanContinue()?this.btnContinue.enabled=!0:this.btnContinue.enabled=!1},i.prototype.addBetChips=function(e,i,n){t.BrnnMgr.playSound(4);for(var r=t.BrnnMgr.mainMoel.roomInfo.betOptions,s=r.length,o=s-1;o>=0;o--){var a=i/r[o];if(a=Math.floor(a),a>0){i%=r[o];for(var h=0;a>h;h++){var c=this.betAreas[e],l=c.parent.localToGlobal(c.x,c.y);this.createChips(e,o,n,l)}}}this.btnClear.enabled=t.BrnnMgr.mainMoel.isBet()},i.prototype.createChips=function(e,i,n,r){if(this.areaNumLst[e][i]<15||n){var s={x:140*Math.random()+r.x-70,y:140*Math.random()+r.y-100},o=void 0;if(n)o=this.betBtn.parent.localToGlobal(this.betBtn.x,this.betBtn.y),o=this.groupChips.globalToLocal(o.x,o.y);else{var a=Math.floor(3*Math.random());o=this.playerChipsPos[a]}var h=t.BrnnMgr.ChipsManager.get(this.chipsRes[i],o);h.tag=n?"mybet":"totalBet",this.groupChips.addChild(h),this.chipsLst[e]||(this.chipsLst[e]=[]),this.chipsLst[e].push(h),s=this.groupChips.globalToLocal(s.x,s.y),egret.Tween.get(h).to({x:s.x,y:s.y},300),this.areaNumLst[e][i]+=1}},i.prototype.minusBetChips=function(e,i){var n=t.BrnnMgr.gsplit(i+"");if(n){n.reverse();for(var r=0;r<n.length;r++){var s=parseInt(n[r]),o=this.chipsRes[r],a=this.chipsLst[e];if(a&&a.length>0)for(var h=0;s>h;h++)for(var c=0;c<a.length;c++)if(a[c].getDataId()==o){a[c].resumeOrgin();break}}}},i.prototype.updateTotalBetChips=function(){for(var e=1;4>=e;e++)t.BrnnMgr.mainMoel.totalBetChipsMap[e]>0?this.betAreas[e].setTotalBetChips(t.BrnnMgr.mainMoel.totalBetChipsMap[e]):this.betAreas[e].setTotalBetChips(0)},i.prototype.updatePlayerBetChips=function(){for(var e=1;4>=e;e++)t.BrnnMgr.mainMoel.curBetChipsMap[e]>0?this.betAreas[e].setMyBetChips(t.BrnnMgr.mainMoel.curBetChipsMap[e]):this.betAreas[e].setMyBetChips(0)},i.prototype.clearBetChips=function(){for(var e=1;4>=e;e++)t.BrnnMgr.mainMoel.curBetChipsMap[e]&&(t.BrnnMgr.mainMoel.totalBetChipsMap[e]-=t.BrnnMgr.mainMoel.curBetChipsMap[e],t.BrnnMgr.mainMoel.curBetChipsMap[e]=0);t.BrnnMgr.mainMoel.curBetChipsMap={};for(var i=1;4>=i;i++)if(this.chipsLst[i])for(var n=this.chipsLst[i],e=0;e<n.length;e++)"mybet"==n[e].tag&&n[e].resumeOrgin();this.btnClear.enabled=t.BrnnMgr.mainMoel.isBet(),this.updateTotalBetChips(),this.updatePlayerBetChips(),this.updatePlayerInfo()},i.prototype.updateBankerInfo=function(){if(this.waitView.visible&&this.waitView.show(t.BrnnMgr.mainMoel.applyList(),t.BrnnMgr.mainMoel.isApply()),t.BrnnMgr.mainMoel.banker)if(this.lbDealerNick.text=t.BrnnMgr.mainMoel.banker.name,t.BrnnMgr.mainMoel.banker.playerId>0){if(GameApp.PlayerInfo.isMySelf(t.BrnnMgr.mainMoel.banker.playerId))this.imgDealer.texture=GameApp.PlayerInfo.getHeadTexture(),this.imgDealer.scaleX=.5,this.imgDealer.scaleY=.5;else{var e=t.BrnnMgr.mainMoel.getBankerIcon(),i=null;e&&(i=GameApp.PlayerInfo.getHeadTexture(e)),i?(this.imgDealer.texture=i,this.imgDealer.scaleX=.5,this.imgDealer.scaleY=.5):(this.imgDealer.texture=RES.getRes("brnn_atlas1_json.tx"),this.imgDealer.scaleX=1,this.imgDealer.scaleY=1)}this.lbDealerGold.text=t.BrnnMgr.mainMoel.banker.chips}else this.imgDealer.texture=RES.getRes("brnn_atlas1_json.banker"),this.lbDealerGold.text=t.BrnnMgr.mainMoel.banker.score,this.imgDealer.scaleX=1,this.imgDealer.scaleY=1},i.prototype.updateWaitView=function(){this.waitView.visible&&this.waitView.show(t.BrnnMgr.mainMoel.applyList(),t.BrnnMgr.mainMoel.isApply())},i.prototype.updateRecordView=function(){this.recordView.visible&&this.recordView.show(t.BrnnMgr.mainMoel.histories)},i.prototype.openClearingView=function(){var e=this;t.BrnnMgr.mainMoel.billInfo&&(this.clearingView.show(t.BrnnMgr.mainMoel.billInfo.bankerChips,t.BrnnMgr.mainMoel.billInfo.playerChips),egret.Tween.get(this).wait(1e3).call(function(){e.clearChips()},this).wait(1e3).call(function(){e.updateChips(!0),e.updateBankerInfo()},this))},i.prototype.playBankerAnimation=function(){if(t.BrnnMgr.mainMoel.histories&&t.BrnnMgr.mainMoel.histories.length>0){var e=t.BrnnMgr.mainMoel.histories[0],i="";15==e?(t.BrnnMgr.playSound(2),i="庄通赔"):0==e&&(i="庄通吃",t.BrnnMgr.playSound(3));var n=t.BrnnConfig.EffectConfig[i];if(n){var r=GameApp.getClipByFileName(n.file,n.key);GameApp.playMoveClip(this,r,"act",{x:1480,y:270},1,function(){r.parent&&r.parent.removeChild(r)},this)}}},i.prototype.clearChips=function(){if(this.chipsLst){var e=this;if(t.BrnnMgr.mainMoel.histories&&t.BrnnMgr.mainMoel.histories.length>0){var i=t.BrnnMgr.mainMoel.histories[0],n=this.binTable[i];egret.Tween.get(this).wait(1).call(function(){e.flyToMe(n)}).wait(300).call(function(){e.flyToBanker()}).wait(300).call(function(){e.chipsLst={}})}}},i.prototype.flyToMe=function(t){if(t){var e=this.betBtn.parent.localToGlobal(this.betBtn.x,this.betBtn.y);e=this.groupChips.globalToLocal(e.x,e.y);for(var i=0;i<t.length;i++){var n=t[i];if(1==n){var r=this.chipsLst[i+1];r&&r.length>0&&r.forEach(function(t){egret.Tween.get(t).to({x:e.x,y:e.y},300).call(function(){t.resumeOrgin()})})}}}},i.prototype.flyToBanker=function(){var t=this.groupDealer.parent.localToGlobal(this.groupDealer.x,this.groupDealer.y);t=this.groupChips.globalToLocal(t.x,t.y);for(var e in this.chipsLst){var i=this.chipsLst[e];i&&i.length>0&&i.forEach(function(e){egret.Tween.get(e).to({x:t.x,y:t.y},300).call(function(){e.resumeOrgin()})})}this.areaNumLst={1:[0,0,0,0,0,0,0,0],2:[0,0,0,0,0,0,0,0],3:[0,0,0,0,0,0,0,0],4:[0,0,0,0,0,0,0,0]}},i.prototype.continueBet=function(){if(t.BrnnMgr.mainMoel.isCanContinue()){var e=t.BrnnMgr.mainMoel.getContinueRequireChips(),i=t.BrnnMgr.mainMoel.getCurBetRequireChips();if(e+i<=t.BrnnMgr.mainMoel.chips)for(var n=1;4>=n;n++){var r=t.BrnnMgr.mainMoel.lastBetChips[n];r&&t.BrnnReq.send_ReqBet(n,r)}else GameApp.PromotManager.floatingTip("对不起，您的筹码不足")}},i.prototype.updateCountdownAndState=function(){t.BrnnMgr.isEnterScene()&&(this.updateChips(!1),2==t.BrnnMgr.mainMoel.state&&t.BrnnMgr.mainMoel.countDown>0&&t.BrnnMgr.mainMoel.countDown<=5&&t.BrnnMgr.playSound(7),t.BrnnMgr.mainMoel.state&&(this.imgState.texture=RES.getRes("brnn_atlas1_json.bairenniuniu_state_"+t.BrnnMgr.mainMoel.state),this.imgState.visible=!0),this.bmpClock.text=t.BrnnMgr.mainMoel.countDown,this.bmpClock.visible=!0,t.BrnnMgr.mainMoel.countDown&&t.BrnnMgr.mainMoel.countDown>0&&t.BrnnMgr.mainMoel.descTime())},i.prototype.backTable=function(){App.SoundManager.playBg(t.BrnnConfig.MusicConfig.MusicTable[1].resPath),this.betBtn.initBetOptions(t.BrnnMgr.mainMoel.roomInfo.betOptions),this.resetGame(),t.BrnnMgr.mainMoel.state&&(this.imgState.texture=RES.getRes("brnn_atlas1_json.bairenniuniu_state_"+t.BrnnMgr.mainMoel.state),this.imgState.visible=!0),t.BrnnMgr.mainMoel.chips<=0&&this.exchangeView.show(GameApp.PlayerInfo.safeGold,t.BrnnMgr.mainMoel.chips,t.BrnnMgr.mainMoel.roomInfo),this.updateBankerInfo(),this.updatePlayerInfo()},i.prototype.showCards=function(t,e){for(var i=this,n=0;n<t.length;n++)this.cardItemList[n+1].setCardInfo(t[n]);for(var n=1;5>=n;n++)for(var r=1;5>=r;r++)this.cardItemList[n].addCard();if(14>e){for(var n=1;5>=n;n++)this.cardItemList[n].showCards(),this.cardItemList[n].showCardType(!1);egret.Tween.get(i).wait(500).call(function(){i.playBlinkAnimation()}),egret.Tween.get(i).wait(1e3).call(function(){i.openClearingView()})}else{var s=function(){for(var t=function(t){egret.Tween.get(i).wait(2e3*(t-1)).call(function(){i.cardItemList[t].playFlopAnimation()})},e=1;5>=e;e++)t(e)};egret.Tween.get(i).call(function(){s()}).wait(13e3).call(function(){i.playBlinkAnimation()}).wait(1e3).call(function(){i.openClearingView()}).wait(1e3).call(function(){i.playBankerAnimation()})}},i.prototype.removeSendCard=function(){this.sendCards.forEach(function(t){t.parent&&t.parent.removeChild(t)}),this.sendCards=[]},i.prototype.pauseGame=function(t){egret.Tween.removeAllTweens(),this.resetUI(),t&&(App.SoundManager.stopBg(),App.SoundManager.stopEffect())},i.prototype.finish=function(){this.timer&&(this.timer.stop(),this.timer.hasEventListener(egret.TimerEvent.TIMER)&&this.timer.removeEventListener(egret.TimerEvent.TIMER,this.updateCountdownAndState,this),this.timer=null),this.resetUI(),t.BrnnMgr.ObjectPool.destroy(),egret.Tween.removeAllTweens(),this.removeSendCard()},i}(BaseEuiView);t.MainView=e,__reflect(e.prototype,"brnn.MainView")}(brnn||(brnn={}));var brnn;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.objectClsssLst={},e.default_size=5,e}return __extends(e,t),e.prototype.init=function(){var t=this;Object.keys(i).filter(function(e){isNaN(Number(i[e]))&&(t.objectClsssLst[e]={objId:0,objLst:{},creater:null})})},e.prototype.destroy=function(){var t=this;Object.keys(i).filter(function(e){if(isNaN(Number(i[e]))){var n=t.objectClsssLst[e];if(n)for(var r in n.objLst){var s=n.objLst[r];s.resumeOrgin()}}}),this.objectClsssLst={}},e.prototype.registerObjectCreater=function(t,e){var i=this.objectClsssLst[t];i&&(i.creater=e)},e.prototype.newSomeObject=function(t,e,i){var n=this.objectClsssLst[t];if(n&&n.creater)for(var r=0;i>r;r++){n.objId+=1;var s={objId:n.objId,id:e},o=n.creater,a=o.preCreated(s);n.objLst[n.objId]=a}},e.prototype.getObject=function(t,e){var i=null,n=this.objectClsssLst[t];if(n)for(var r in n.objLst){var s=n.objLst[r];if(s&&!s.getUseState()&&s.getDataId()==e){i=s;break}}return i||(this.newSomeObject(t,e,this.default_size),n=this.objectClsssLst[t],n&&(i=n.objLst[n.objId])),i},e}(BaseClass);t.ObjectPool=e,__reflect(e.prototype,"brnn.ObjectPool");var i;!function(t){t[t.Chips=1]="Chips",t[t.BigCards=2]="BigCards",t[t.SmallCards=3]="SmallCards"}(i=t.ObjectClassType||(t.ObjectClassType={}))}(brnn||(brnn={}));var brnn;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.binTable=[[0,0,0,0],[0,0,0,1],[0,0,1,0],[0,0,1,1],[0,1,0,0],[0,1,0,1],[0,1,1,0],[0,1,1,1],[1,0,0,0],[1,0,0,1],[1,0,1,0],[1,0,1,1],[1,1,0,0],[1,1,0,1],[1,1,1,0],[1,1,1,1]],e.skinName="resource/skins/brnn/BrnnRecordSkin.exml",e.ggTexture=RES.getRes("brnn_atlas1_json.gg"),e.xxTexture=RES.getRes("brnn_atlas1_json.xx"),e.itemLsit={},e}return __extends(e,t),e.prototype.registerTouchEvent=function(){var t=this;this.groupParent.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){e.target==t.groupParent&&t.hide()},this);for(var e=0;44>e;e++){var n=new i(this.ggTexture);this.groupContent.addChild(n),n.visible=!1,this.itemLsit[e%11]||(this.itemLsit[e%11]=[]),this.itemLsit[e%11].push(n)}},e.prototype.show=function(t){if(t&&t.length>0){var e=GameApp.clone(t);e.length>11&&e.splice(11,e.length-11),e.reverse();for(var i=0;i<e.length;i++){var n=e[i],r=this.binTable[n];if(11>i)for(var s=0;s<r.length;s++){var o=r[s];o?this.itemLsit[i][s].setTexture(this.ggTexture):this.itemLsit[i][s].setTexture(this.xxTexture),this.itemLsit[i][s].visible=!0}}}this.visible=!0},e.prototype.hide=function(){this.visible=!1},e}(eui.Component);t.RecordView=e,__reflect(e.prototype,"brnn.RecordView");var i=function(t){function e(e){var i=t.call(this)||this;return i.imgItem=new eui.Image,i.addChild(i.imgItem),i.imgItem.verticalCenter=0,i.imgItem.horizontalCenter=0,i.imgItem.texture=e,i}return __extends(e,t),e.prototype.setTexture=function(t){this.imgItem.texture=t},e}(eui.Group);t.RecordItem=i,__reflect(i.prototype,"brnn.RecordItem")}(brnn||(brnn={}));var brnn;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/brnn/BrnnWaitSkin.exml",e}return __extends(e,t),e.prototype.init=function(t,e){var n=this;this.lstWait=new eui.List;var r=new eui.VerticalLayout;r.verticalAlign=egret.VerticalAlign.MIDDLE,r.horizontalAlign=egret.HorizontalAlign.CENTER,r.gap=0,this.lstWait.layout=r,this.lstWait.itemRenderer=i,this.lstWait.itemRendererSkinName="resource/skins/brnn/BrnnWaitItemSkin.exml",this.lstWait.width=380,this.lstWait.height=41,this.scroller.viewport=this.lstWait,this.array=new eui.ArrayCollection,this.lstWait.dataProvider=this.array,this.groupParent.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){n.groupParent==t.target&&n.hide()},this),this.btnXiaZ.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.apply(e,[!1])},this),this.btnShangZ.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.apply(e,[!0])},this)},e.prototype.show=function(t,e){var i=this;this.array.removeAll(),t&&t.length>0&&t.forEach(function(t){i.array.addItem(t)}),e?(this.btnXiaZ.visible=!0,this.btnShangZ.visible=!1):(this.btnXiaZ.visible=!1,this.btnShangZ.visible=!0),this.visible=!0,egret.Tween.get(this.groupContent).to({top:0},500)},e.prototype.hide=function(){var t=this;egret.Tween.get(this.groupContent).to({top:-408},500).call(function(){t.visible=!1},this)},e}(eui.Component);t.WaitView=e,__reflect(e.prototype,"brnn.WaitView");var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.lbNick&&(this.lbNick.text=this.data.nickname),this.lbGold&&(this.lbGold.text=this.data.gold)},e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i),this.data&&(i==this.lbNick&&(this.lbNick.text=this.data.nickname),this.lbGold&&(this.lbGold.text=this.data.gold))},e}(eui.ItemRenderer);t.WaitItem=i,__reflect(i.prototype,"brnn.WaitItem")}(brnn||(brnn={}));var brnn;!function(t){var e=function(){function e(){}return e.send_ReqEnterGameHall=function(){var t={id:e.c2s_brnn_ReqEnterGameHall_msg};App.Socket.send(t,function(e,i){App.EasyLoading.hideLoading(),e==t.id?(GameApp.PlayerInfo.myRoomTypeInfo=i.roomTypes,GameApp.PlayerInfo.curGameID=7,GameApp.HomeManager.resEnterGameHall("百人牛牛")):PlayerManager.resCommonMsg(i)},this)},e.send_ReqEnterRoom=function(t){},e.send_ReqFastEnterTable=function(t){var i={id:e.c2s_brnn_ReqFastEnterTable_msg,roomId:t};App.Socket.send(i,function(t,e){App.EasyLoading.hideLoading(),t==i.id||PlayerManager.resCommonMsg(e)},this)},e.send_ReqExitRoom=function(){var t={id:e.c2s_brnn_ReqExitRoom_msg};App.Socket.send(t,function(e,i){e==t.id||GameApp.PromotManager.floatingTip(i.errorCode)},this)},e.send_ReqExitTable=function(){var t={id:e.c2s_brnn_ReqExitTable_msg};App.Socket.send(t,function(e,i){e==t.id?GameApp.HomeManager.reqExitCurGameRoom():GameApp.PromotManager.floatingTip(i.errorCode)},this)},e.send_ReqApplyZuoZ=function(){var t={id:e.c2s_brnn_ApplyZuoZ_msg};App.Socket.send(t,function(e,i){e==t.id||PlayerManager.resCommonMsg(i)},this)},e.send_ReqCancelZuoZ=function(){var t={id:e.c2s_brnn_CancelZuoZ_msg};App.Socket.send(t,function(e,i){e==t.id},this)},e.send_ReqApplyCancelZuoZ=function(){var t={id:e.c2s_brnn_ApplyCancelZuoZ_msg};App.Socket.send(t,function(e,i){e==t.id},this)},e.send_ReqBet=function(i,n){var r={id:e.c2s_brnn_Bet_msg,area:i,chips:n};App.Socket.send(r,function(e,i){e==r.id?App.ControllerManager.applyFunc(ControllerConst.BrnnMain,t.BrnnResConst.ResBet,i):PlayerManager.resCommonMsg(i)},this)},e.send_ReqClearBet=function(){var i={id:e.c2s_brnn_ClearingBet_msg};App.Socket.send(i,function(e,n){e==i.id&&App.ControllerManager.applyFunc(ControllerConst.BrnnMain,t.BrnnResConst.ResClearBet,n)},this)},e.send_ReqExchangeChips=function(t){var i={id:e.c2s_brnn_ReqExchangeChips_msg,gold:t};App.Socket.send(i,function(t,e){t==i.id||GameApp.PromotManager.floatingTip(e.errorCode)},this)},e.send_ReqExchangeGolds=function(t){var i={id:e.c2s_brnn_ReqExchangeGold_msg,chips:t};App.Socket.send(i,function(t,e){t==i.id||GameApp.PromotManager.floatingTip(e.errorCode)},this)},e.send_ReqBackTable=function(){var i={id:e.c2s_brnn_ReqBackTable_msg};App.Socket.send(i,function(e,n){e==i.id&&App.ControllerManager.applyFunc(ControllerConst.BrnnMain,t.BrnnResConst.ResBackTable,n)},this)},e.setRoomInfo=function(e){t.BrnnMgr.setRoomInfo(e)},e.loadScene=function(){App.ViewManager.isShow(ViewConst.BrnnMain)?e.send_ReqBackTable():t.BrnnMgr.start()},e.pauseGame=function(){if(App.ViewManager.isShow(ViewConst.BrnnMain)){var t=App.ViewManager.getView(ViewConst.BrnnMain);t&&t.pauseGame(!0)}},e.registerCommonReq=function(){GameApp.HomeManager.registerModuleReq(7,CommonReq.SetRoomInfo,e.setRoomInfo,e),GameApp.HomeManager.registerModuleReq(7,CommonReq.LoadGameScene,e.loadScene,e),GameApp.HomeManager.registerModuleReq(7,CommonReq.ReqEnterCurGame,e.send_ReqEnterGameHall,e),GameApp.HomeManager.registerModuleReq(7,CommonReq.ReqEnterCurGameRoom,e.send_ReqEnterRoom,e),GameApp.HomeManager.registerModuleReq(7,CommonReq.ReqExitCurGameRoom,e.send_ReqExitRoom,e),GameApp.HomeManager.registerModuleReq(7,CommonReq.ReqQuickEnterCurGame,e.send_ReqFastEnterTable,e),GameApp.HomeManager.registerModuleReq(7,CommonReq.ReqExitCurGameTable,e.send_ReqExitTable,e),GameApp.HomeManager.registerModuleReq(7,CommonReq.PauseGame,e.pauseGame,e)},e.removeCommonReq=function(){GameApp.HomeManager.removeModuleReq(7)},e.c2s_brnn_ReqEnterGameHall_msg=6001,e.c2s_brnn_ReqExitTable_msg=6004,e.c2s_brnn_ReqExitRoom_msg=6005,e.c2s_brnn_ApplyZuoZ_msg=6006,e.c2s_brnn_CancelZuoZ_msg=6007,e.c2s_brnn_ApplyCancelZuoZ_msg=6008,e.c2s_brnn_Bet_msg=6009,e.c2s_brnn_ClearingBet_msg=6010,e.c2s_brnn_ReqBackTable_msg=6011,e.c2s_brnn_ReqExchangeGold_msg=6012,e.c2s_brnn_ReqExchangeChips_msg=6013,e.c2s_brnn_ReqFastEnterTable_msg=6014,e}();t.BrnnReq=e,__reflect(e.prototype,"brnn.BrnnReq")}(brnn||(brnn={}));var brnn;!function(t){var e=function(){function e(){}return e.rec_ResExitRoom=function(e){t.BrnnMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.BrnnMain,t.BrnnResConst.ResExitRoom,e)},e.rec_ResChipsChange=function(e){GameApp.PlayerInfo.isMySelf(e.playerId)&&(t.BrnnMgr.mainMoel.chips=e.chips.toNumber()),t.BrnnMgr.mainMoel.updateMemberChips(e.playerId.toNumber(),e.chips),t.BrnnMgr.isEnterScene()&&GameApp.PlayerInfo.isMySelf(e.playerId)&&App.ControllerManager.applyFunc(ControllerConst.BrnnMain,t.BrnnResConst.ResChangeChips,e)},e.rec_ResEnterTable=function(e){e.mems&&(e.mems.forEach(function(e){t.BrnnMgr.mainMoel.addMember(e)}),t.BrnnMgr.mainMoel.chips=e.totalChips.toNumber(),t.BrnnMgr.start())},e.rec_ResOtherEnterTable=function(e){t.BrnnMgr.mainMoel.addMember(e.mem),t.BrnnMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.BrnnMain,t.BrnnResConst.ResOtherEnterTable,e.mem)},e.rec_ResExitTable=function(e){t.BrnnMgr.mainMoel.removeMember(e.playerId.toNumber()),t.BrnnMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.BrnnMain,t.BrnnResConst.ResExitTable,e)},e.rec_ResApplyZuoZLst=function(e){t.BrnnMgr.mainMoel.applicants=e.applicants,t.BrnnMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.BrnnMain,t.BrnnResConst.ResApplyZuoZLst,e)},e.rec_ResSendCard=function(e){t.BrnnMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.BrnnMain,t.BrnnResConst.ResSendCard,e.cardsInfo)},e.rec_ResTableBet=function(e){t.BrnnMgr.mainMoel.totalBetChips=e.betInfo,t.BrnnMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.BrnnMain,t.BrnnResConst.ResTableBet,e.betInfo)},e.rec_ResNewDealer=function(e){t.BrnnMgr.mainMoel.banker=e,t.BrnnMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.BrnnMain,t.BrnnResConst.ResNewDealer,e)},e.rec_ResBill=function(e){t.BrnnMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.BrnnMain,t.BrnnResConst.ResBill,e)},e.rec_ResHistory=function(e){t.BrnnMgr.mainMoel.histories=e.result,t.BrnnMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.BrnnMain,t.BrnnResConst.ResHistory,e)},e.rec_ResGameStage=function(e){t.BrnnMgr.mainMoel.gameStage=e,t.BrnnMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.BrnnMain,t.BrnnResConst.ResGameStage,e)},e.registerResListener=function(){App.MessageCenter.addListener(e.s2c_brnn_ResExitRoom_msg,e.rec_ResExitRoom,e),App.MessageCenter.addListener(e.s2c_brnn_ResChangeChips_msg,e.rec_ResChipsChange,e),App.MessageCenter.addListener(e.s2c_brnn_ResEnterTable_msg,e.rec_ResEnterTable,e),App.MessageCenter.addListener(e.s2c_brnn_ResOtherEnterTable_msg,e.rec_ResOtherEnterTable,e),App.MessageCenter.addListener(e.s2c_brnn_ResExitTable_msg,e.rec_ResExitTable,e),App.MessageCenter.addListener(e.s2c_brnn_ResApplyZuoZLst_msg,e.rec_ResApplyZuoZLst,e),App.MessageCenter.addListener(e.s2c_brnn_ResSendCard_msg,e.rec_ResSendCard,e),App.MessageCenter.addListener(e.s2c_brnn_ResBet_msg,e.rec_ResTableBet,e),App.MessageCenter.addListener(e.s2c_brnn_ResNewDealer_msg,e.rec_ResNewDealer,e),App.MessageCenter.addListener(e.s2c_brnn_ResBill_msg,e.rec_ResBill,e),App.MessageCenter.addListener(e.s2c_brnn_ResHistory_msg,e.rec_ResHistory,e),App.MessageCenter.addListener(e.s2c_brnn_ResGameStage_msg,e.rec_ResGameStage,e)},e.removeResListener=function(){App.MessageCenter.removeAll(e)},e.s2c_brnn_ResExitRoom_msg="6051",e.s2c_brnn_ResChangeChips_msg="6052",e.s2c_brnn_ResEnterTable_msg="6053",e.s2c_brnn_ResOtherEnterTable_msg="6054",e.s2c_brnn_ResExitTable_msg="6055",e.s2c_brnn_ResApplyZuoZLst_msg="6057",e.s2c_brnn_ResSendCard_msg="6058",e.s2c_brnn_ResBet_msg="6059",e.s2c_brnn_ResNewDealer_msg="6060",e.s2c_brnn_ResBill_msg="6061",e.s2c_brnn_ResHistory_msg="6062",e.s2c_brnn_ResGameStage_msg="6063",e}();t.BrnnRes=e,__reflect(e.prototype,"brnn.BrnnRes")}(brnn||(brnn={}));var fish;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"Config",{get:function(){return t.FishConfigManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"BackgroundManager",{get:function(){return t.BackgroundManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ActionEffect",{get:function(){return t.ActionEffect.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FishLabelManager",{get:function(){return t.FishLabelManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FishNetManager",{get:function(){return t.FishNetManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MusicManager",{get:function(){return t.MusicManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FishGoldManager",{get:function(){return t.FishGoldManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FishManager",{get:function(){return t.FishManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"BatteryManager",{get:function(){return t.BatteryManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FishObjectPool",{get:function(){return t.FishObjectPool.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"BulletManager",{get:function(){return t.BulletManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CollisionManager",{get:function(){return t.CollisionManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SkillManager",{get:function(){return t.SkillManager.getInstance()},enumerable:!0,configurable:!0}),e.randomSelectId=function(t){for(var e=Math.random(),i=0,n=0;n<t.length;n++)if(i+=t[n].gi,i>e)return t[n].id;return-1},e.registerListener=function(){t.FishReq.registerListener(9)},e.setRoomInfo=function(i){e.fishModel||(e.fishModel=new t.FishMainModel),e.fishModel.roomInfo=i},e.isEnterScene=function(){return e.fishModel&&e.fishModel.isEnterScene},e.start=function(i){e.fishModule=i,e.fishModel||(e.fishModel=new t.FishMainModel),e.fishStart||(e.fishStart=new t.FishStart),e.fishStart.start()},e.finish=function(){e.fishStart&&e.fishStart.finish(),t.FishReq.removeListener(),e.fishStart=null,e.fishModel=null},e.seatId=4,e.fishModel=new t.FishMainModel,e}();t.FishMgr=e,__reflect(e.prototype,"fish.FishMgr")}(fish||(fish={}));var fish;!function(t){var e=function(){function e(){}return e.send_ReqFire=function(e){switch(t.FishMgr.fishModule){case"jc":jcby.FishReq.send_ReqFire(e);break;case"lk":}},e.send_ReqSwitchBattery=function(e){switch(t.FishMgr.fishModule){case"jc":jcby.FishReq.send_ReqSwitchBattery(e);break;case"lk":}},e.send_ReqHitFish=function(e,i,n){switch(t.FishMgr.fishModule){case"jc":jcby.FishReq.send_ReqHitFish(e,i,n);break;case"lk":}},e.send_ReqExitTable=function(){switch(t.FishMgr.fishModule){case"jc":jcby.FishReq.send_ReqExitTable();break;case"lk":}},e.send_ReqScene=function(){switch(t.FishMgr.fishModule){case"jc":jcby.FishReq.send_ReqScene();break;case"lk":}},e.send_ReqLockFish=function(e,i){switch(t.FishMgr.fishModule){case"jc":jcby.FishReq.send_ReqLockFish(e,i);break;case"lk":}},e.send_ReqCancelLockFish=function(){switch(t.FishMgr.fishModule){case"jc":jcby.FishReq.send_ReqCancelLockFish();break;case"lk":}},e.send_ReqExchangeChip=function(e,i){switch(t.FishMgr.fishModule){case"jc":switch(e){case game.ExchangeType.CashIn:jcby.FishReq.send_ReqExchangeGolds(i);break;case game.ExchangeType.CashOut:jcby.FishReq.send_ReqExchangeChips(i)}break;case"lk":}},e.send_ReqBackTable=function(){switch(t.FishMgr.fishModule){case"jc":jcby.FishReq.send_ReqBackTable();break;case"lk":}},e.registerListener=function(t){switch(t){case 9:GameApp.HomeManager.registerModuleReqFunc(t,jcby.FishReq.registerCommonReq,jcby.FishReq),GameApp.HomeManager.registerModuleResFunc(t,jcby.FishRes.registerResListener,jcby.FishRes);break;case 14:}},e.removeListener=function(){switch(t.FishMgr.fishModule){case"jc":jcby.FishReq.removeCommonReq(),jcby.FishRes.removeResListener();break;case"lk":}},e}();t.FishReq=e,__reflect(e.prototype,"fish.FishReq")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.onEnter=function(){e.prototype.onEnter.call(this),this.addLayer(LayerManager.UI_Main)},i.prototype.onExit=function(){e.prototype.onExit.call(this),t.FishMgr.finish(),App.SoundManager.stopBg(),App.SoundManager.stopEffect()},i}(BaseScene);t.FishScene=e,__reflect(e.prototype,"fish.FishScene")}(fish||(fish={}));var fish;!function(t){var e=function(){function e(){}return e.prototype.start=function(){App.SceneManager.register(SceneConsts.Fish,new t.FishScene),App.ResourceUtils.addConfig("resource/assets/games/fish_common.res.json","resource/"),App.ResourceUtils.addConfig("resource/assets/games/"+t.FishMgr.fishModule+"_fish_asset.res.json","resource/"),App.ResourceUtils.loadConfig(this.onConfigComplete,this),App.EasyLoading.showLoading("加载中 ...")},e.prototype.onConfigComplete=function(){App.ResourceUtils.loadGroup(t.FishMgr.fishModule+"_loading_asset",function(){App.EasyLoading.hideLoading(),App.ControllerManager.register(ControllerConst.FishLoad,new t.FishLoadingController),App.SceneManager.runScene(SceneConsts.Fish),App.ViewManager.open(ViewConst.FishLoad),this.loadFishResource()},function(){},this)},e.prototype.loadFishResource=function(){var e="fishAssets",i=["fish_common_asset",t.FishMgr.fishModule+"_fish_asset"];App.ResourceUtils.loadGroups(e,i,this.onLoadComplete,this.onLoadProgress,this)},e.prototype.onLoadComplete=function(){App.ControllerManager.register(ControllerConst.FishMain,new t.FishMainSceneController),App.ViewManager.open(ViewConst.FishMain)},e.prototype.onLoadProgress=function(t,e){App.ControllerManager.applyFunc(ControllerConst.FishLoad,ControllerConst.FishLoad,t,e)
},e.prototype.finish=function(){var t=App.ViewManager.getView(ViewConst.FishMain);t&&t.finish(),App.ViewManager.unregister(ViewConst.FishLoad),App.ViewManager.unregister(ViewConst.FishMain),App.ControllerManager.unregister(ControllerConst.FishLoad),App.ControllerManager.unregister(ControllerConst.FishMain)},e}();t.FishStart=e,__reflect(e.prototype,"fish.FishStart")}(fish||(fish={}));var fish;!function(t){var e=function(){function t(){this.actionArray={},this.actionArray={},this.actionArray.move_to=this.__move_to,this.actionArray.move_by=this.__move_by,this.actionArray.scale_to=this.__scale_to,this.actionArray.scale_by=this.__scale_by,this.actionArray.rotate_to=this.__rotate_to,this.actionArray.rotate_by=this.__rotate_by,this.actionArray.skew_to=this.__skew_to,this.actionArray.skew_by=this.__skew_by,this.actionArray.jump_to=this.__jump_to,this.actionArray.jump_by=this.__jump_by,this.actionArray.blink=this.__move_to,this.actionArray.fade_in=this.__move_to,this.actionArray.fade_out=this.__move_to,this.actionArray.tint_to=this.__tint_by,this.actionArray.tint_by=this.__tint_to,this.actionArray.delay=this.__delay,this.actionArray.shake=this.__shake,this.actionArray.ffshake=this.__fallofshake,this.actionArray.circle=this.__circle}return t.prototype.create=function(t,e){return this.actionArray[t]?this.actionArray[t](e):null},t.prototype.__move_to=function(t){return{prop:{x:t.param.pos.x,y:t.param.pos.y},t:t.param.t}},t.prototype.__move_by=function(t){return-1==t.loop?{prop:{x:1e6*t.param.pos.x,y:1e6*t.param.pos.y},t:1e6*t.param.t}:{prop:{x:t.param.pos.x*t.loop,y:t.param.pos.y*t.loop},t:t.param.t*t.loop}},t.prototype.__scale_to=function(t){return{prop:{scaleX:t.sx,scaleY:t.sy},t:t.param.t}},t.prototype.__scale_by=function(t){return-1==t.loop?{prop:{scaleX:1e6*t.param.sx,scaleY:1e6*t.param.sy},t:1e6*t.param.t}:{prop:{scaleX:t.param.sx*t.loop,scaleY:t.param.sy*t.loop},t:t.param.t*t.loop}},t.prototype.__rotate_to=function(t){return{prop:{rotation:t.angle},t:t.param.t}},t.prototype.__rotate_by=function(t){return-1==t.loop?{prop:{rotation:1e6*t.param.angle},t:1e6*t.param.t}:{prop:{rotation:t.param.angle*t.loop},t:t.param.t*t.loop}},t.prototype.__skew_to=function(t){return{prop:{skewX:t.sx,skewY:t.sy},t:t.param.t}},t.prototype.__skew_by=function(t){return-1==t.loop?{prop:{skewX:1e6*t.param.sx,skewY:1e6*t.param.sy},t:1e6*t.param.t}:{prop:{skewX:t.param.sx*t.loop,skewY:t.param.sy*t.loop},t:t.param.t*t.loop}},t.prototype.__jump_to=function(t){return null},t.prototype.__jump_by=function(t){return null},t.prototype.__blink=function(t){return null},t.prototype.__fade_in=function(t){return{prop:{alpha:1},t:t.param.t}},t.prototype.__fade_out=function(t){return{prop:{alpha:0},t:t.param.t}},t.prototype.__tint_to=function(t){return null},t.prototype.__tint_by=function(t){return null},t.prototype.__delay=function(t){return{t:t.param.t}},t.prototype.__shake=function(t){return null},t.prototype.__fallofshake=function(t){return null},t.prototype.__circle=function(t){return null},t}();t.ActionCreater=e,__reflect(e.prototype,"fish.ActionCreater")}(fish||(fish={}));var fish;!function(t){var e=function(){function e(t){this.piAngle=180,this.dt=.001,this.startPos={x:0,y:0},this.ratio=19.2,this.curDefWay=1,this.curActionTime=0,this.breserve=!1,this.rotateAngle=0,this.curveLst=[],this.curveLst=[],t.spos&&(this.startPos=t.pos),this.ratio=19.2,t.ratio&&(this.ratio=t.ratio),this.ratio||(this.ratio=1),this.curDefWay=1,this.curActionTime=0,this.breserve=!1,this.rotateAngle=0}return e.prototype.addCurve=function(t){if(t){var e={};e.time=t.t,e.s=t.x2-t.x1,e.v=e.s/e.time,e.ftype=t.ftype,e.fparam=GameApp.clone(t.fparam),e.x1=t.x1,e.x2=t.x2,this.breserve&&(e.s=t.x1-t.x2,e.v=e.s/e.time,e.x1=t.x2,e.x2=t.x1);var i=this.curveLst.length;if(0>=i)return e.t1=0,e.t2=e.t1+e.time,this.curveLst.push(e),!0;var n=this.curveLst[i-1];if(n.x2==e.x1)return e.t1=n.t2,e.t2=e.t1+e.time,this.curveLst.push(e),!0}return!1},e.prototype.getAllTime=function(){var t=0;return App.ArrayUtils.forEach(this.curveLst,function(e){t+=e.time},this),t},e.prototype.setStartPos=function(t){this.startPos.x=t.x,this.startPos.y=t.y},e.prototype.setRatio=function(t){this.ratio=t,(!this.ratio||this.ratio<=0)&&(this.ratio=1)},e.prototype.getFunctionRuleByTime=function(t){var e=0,i=this.curveLst.length;if(0>=i)return null;var n=this.curveLst[i-1];if(t>n.t2)return n;for(var r=0;i>r;r++){var s=this.curveLst[r];if(t>=s.t1&&t<s.t2){e=r;break}}return this.curveLst[e]},e.prototype.getPositionByTime=function(e){var i={x:0,y:0},n=this.curveLst.length;if(0>=n)return i;var r=this.curveLst[n-1];if(e>r.t2){var s={a:r.fparam.a,b:r.fparam.b,c:r.fparam.c,way:r.fparam.way,r:r.fparam.r,k:r.fparam.k,x:r.v*r.t2},o=t.frule.getInstance().getPos(r.ftype,s);i.x=i.x+o.x,i.y=i.y+o.y,r.x1>r.x2?this.curDefWay=-1:this.curDefWay=1}else for(var a=0;a<this.curveLst.length;a++){var h=this.curveLst[a];if(e>=h.t1&&e<h.t2){var s={a:h.fparam.a,b:h.fparam.b,c:h.fparam.c,way:h.fparam.way,r:h.fparam.r,k:h.fparam.k,x:h.v*(e-h.t1)},o=t.frule.getInstance().getPos(h.ftype,s);i.x=i.x+o.x,i.y=i.y+o.y,h.x1>h.x2?this.curDefWay=-1:this.curDefWay=1;break}var s={a:h.fparam.a,b:h.fparam.b,c:h.fparam.c,way:h.fparam.way,r:h.fparam.r,k:h.fparam.k,x:h.v*h.time},o=t.frule.getInstance().getPos(h.ftype,s);i.x=i.x+o.x,i.y=i.y+o.y}if(this.rotateAngle&&0!=this.rotateAngle){var c=i.x*Math.cos(this.rotateAngle/this.piAngle*Math.PI)+i.y*Math.sin(this.rotateAngle/this.piAngle*Math.PI),l=i.y*Math.cos(this.rotateAngle/this.piAngle*Math.PI)-i.x*Math.sin(this.rotateAngle/this.piAngle*Math.PI);i.x=c,i.y=l}return{x:this.startPos.x+i.x,y:this.startPos.y+i.y}},e.prototype.getPosAndSlopeByTime=function(t){this.curActionTime=t;var e=this.getPositionByTime(t),i=this.getPositionByTime(t+this.dt);this.rotateAngle&&0!=this.rotateAngle&&(e.x>i.x?this.curDefWay=-1:this.curDefWay=1);var n=i.x-e.x,r=i.y-e.y;return Math.abs(n)<=1e-6?(this.rotateAngle&&0!=this.rotateAngle&&(e.y<=i.y?this.curDefWay=-1:this.curDefWay=1),{pos:e,k:null}):{pos:e,k:r/n}},e.prototype.getPosAndAngleByTime=function(t){this.curActionTime=t;var e=this.getPosAndSlopeByTime(t),i=0;if(null!=e.k)if(1==this.curDefWay){Math.atan(e.k)*this.piAngle/Math.PI;i=2*this.piAngle-Math.atan(e.k)*this.piAngle/Math.PI}else{Math.atan(e.k)*this.piAngle/Math.PI;i=this.piAngle-Math.atan(e.k)*this.piAngle/Math.PI}else i=-1==this.curDefWay?270:90;return{pos:e.pos,angle:i}},e.prototype.isCurveEnd=function(){var t=!0,e=this.curveLst[this.curveLst.length-1];return e&&e.t2>this.curActionTime&&(t=!1),t},e.prototype.resetInfo=function(){this.curActionTime=0},e.prototype.setActionReserve=function(t){null!=t&&(this.breserve=t,this.breserve&&App.ArrayUtils.forEach(this.curveLst,function(t){t.x1;t.x1=t.x2,t.x2=t.x1,t.s=t.x2-t.x1,t.v=t.s/t.time},this))},e.prototype.setActionRotation=function(t){t&&t>=0&&360>=t&&(this.rotateAngle=t)},e.prototype.clearAllCurve=function(){this.curveLst=[]},e.prototype.setCurveRatio=function(t){t&&(this.ratio=t)},e}();t.ActionCurve=e,__reflect(e.prototype,"fish.ActionCurve")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.play=function(e,i,n,r){if(e&&n&&-1!=n){var s=t.FishMgr.Config.Action[n],o=this.analyze(s);this.setInitParam(s.init_param,e,r);for(var a=o.length,h=function(n){for(var r=o[n].length,s=o[n],h=egret.Tween.get(e),c=[],l=0;r>l;l++){var p=(new t.ActionCreater).create(s[l].key,s[l]);p&&c.push(p)}c.length>0&&c.forEach(function(t){t.prop?h.to(t.prop,1e3*t.t):h.wait(1e3*t.t)}),n==a-1&&h.call(function(){i&&i()})},c=0;a>c;c++)h(c)}else i&&i()},i.prototype.analyze=function(t){var e=[];if(t){var i=t.eff_lst,n=0;e.push([]);for(var r=i.length,s=0;r>s;s++)e[n].push(i[s]),-1==i[s].nxt_id&&r>s&&(e.push([]),n=e.length)}return e},i.prototype.isCanReserver=function(t){return"move_by"==t||"scale_by"==t||"rotate_by"==t||"skew_by"==t||"jump_by"==t||"tint_by"==t?!0:!1},i.prototype.setInitParam=function(t,e,i){t&&e&&(t.angle&&(e.rotation=t.angle),t.sax&&(e.scaleX=t.sax),t.say&&(e.scaleY=t.say),t.skx&&(e.skewX=t.skx),t.sky&&(e.skewY=t.sky))},i}(BaseClass);t.ActionEffect=e,__reflect(e.prototype,"fish.ActionEffect")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.width=1920,t.height=1080,t.touchEnabled=!1,t.x=1920,t}return __extends(i,e),i.prototype.create=function(e,i,n){this.musicId=n.bk_mus_id;var r=t.FishMgr.Config.BgMusic[this.musicId];r&&App.SoundManager.playBg(r.file);var s=t.FishMgr.Config.Sprite[n.bk_pic_id].file;if(s){var o=RES.getRes(s),a=new eui.Image(o);a.percentWidth=100,a.percentHeight=100,a.x=0,a.y=0,this.addChild(a)}0==e&&(this.x=0),this.createGrass(n.view_inf),1==e&&egret.Tween.get(this).to({x:0},1e3*i)},i.prototype.createGrass=function(e){App.ArrayUtils.forEach(e,function(e){var i=t.FishMgr.Config.Sprite[e.src_id];if(1==i.stype){var n=GameApp.getClipByFileName(i.file,i.key);this.addChild(n),n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.x=e.pos.x,n.y=1080-e.pos.y,n.gotoAndPlay("act",-1)}else if(2==i.stype){var r=new eui.Image(i.file);this.addChild(r),r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,r.x=e.pos.x,r.y=1080-e.pos.y}else 3==i.stype},this)},i.prototype.getBkMusicId=function(){return this.musicId},i}(eui.Group);t.Background=e,__reflect(e.prototype,"fish.Background")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.curSceneId=-1,t.frontSceneId=-1,t.useWaterWave=!0,t}return __extends(i,e),i.prototype.init=function(e,i){this.groupContent=e,this.groupWater=i,this.config=t.FishMgr.Config.Background.common,this.curState=0,this.switchTime=this.config.cut_t,this.createSeawaveObj(),this.createWaterObj()},i.prototype.destroy=function(){this.groupContent=null,this.config=null,this.curScene=null,this.frontScene=null,this.curState=-1,this.switchTime=-1,this.curSceneId=-1,this.frontSceneId=-1,this.useWaterWave=!0},i.prototype.switchBaground=function(e){t.FishMgr.BatteryManager.clearAllLockState(),this.curScene&&(this.frontScene=this.curScene,this.curScene=null);var i=t.FishMgr.Config.Background.data[e-1];if(i&&(this.curScene=new t.Background,this.groupContent.addChild(this.curScene),this.frontSceneId=this.curSceneId,this.curSceneId=e,this.curScene.create(this.curState,this.switchTime,i),this.waveMc.x=1920-this.waveMc.width/4,this.groupContent.swapChildren(this.curScene,this.waveMc)),0==this.curState?this.waveMc.visible=!1:(this.waveMc.visible=!0,this.waveMc.gotoAndPlay("act",-1)),1==this.curState){t.FishMgr.MusicManager.play(this.config.mus_id);var n=(.75*this.waveMc.width+1920)/1920*this.switchTime;egret.Tween.get(this.waveMc).to({x:-this.waveMc.width},1e3*n).call(function(){this.waveMc.visible=!1,this.frontScene&&(this.groupContent.removeChild(this.frontScene),this.frontScene=null),this.curState=1,this.waveMc.gotoAndStop("act"),t.FishMgr.FishManager.clearAllFish()},this),this.curState=2}else this.curState=1,t.FishMgr.FishManager.clearAllFish()},i.prototype.getSceneState=function(){return this.curState},i.prototype.getCurrentSceneId=function(){return this.curSceneId},i.prototype.initState=function(t){this.curState=t},i.prototype.createSeawaveObj=function(){var e=t.FishMgr.Config.Sprite[this.config.wave_src_id];this.waveMc=GameApp.getClipByFileName(e.file,e.key),this.groupContent.addChild(this.waveMc),this.waveMc.x=1920-this.waveMc.width/4,this.waveMc.visible=!1},i.prototype.createWaterObj=function(){for(var e=t.FishMgr.Config.Water,i=0;i<e.length;i++){var n=e[i],r=GameApp.getClipByFileName(n.pattern,"water");r.touchEnabled=!1,r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,r.x=n.pos.x,r.y=n.pos.y,this.groupWater.addChild(r),r.gotoAndPlay("act",-1)}},i.prototype.playBkMusic=function(){t.FishMgr.MusicManager.play(this.config.mus_id)},i}(BaseClass);t.BackgroundManager=e,__reflect(e.prototype,"fish.BackgroundManager")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.piAngle=180,i.sendBulletSpeed=1100,i.isAutoLockFire=!1,i.sumIdelSendTime=.25,i.isAutoLock=!1,i.isAutoFire=!1,i.curBarrelIdx=1,i.isPower=!1,i.lvNum=0,i.inited=!1,i.bulletSendDis=150,i.curAngle=0,i.autoExitTime=30,i.autoExitTimeSum=0,1==t?i.skinName="resource/skins/fish/BatterySkin1.exml":i.skinName="resource/skins/fish/BatterySkin2.exml",i.cusSkin=t,i.barrelMc=new egret.MovieClip,i.barrelMc.rotation=270,i.gpParent.addChild(i.barrelMc),i.gpParent.swapChildren(i.barrelMc,i.imgBarrel),i.barrelMc.touchEnabled=!1,i.touchEnabled=!1,i.gpParent.touchEnabled=!1,i.registerEvent(),i}return __extends(i,e),i.prototype.registerEvent=function(){this.btnAdd.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.FishReq.send_ReqSwitchBattery(1)},this),this.btnMinus.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.FishReq.send_ReqSwitchBattery(0)},this)},i.prototype.setBatteryInfo=function(e,i){this.config=t.FishMgr.Config.Battery[e.configId],this.sendBulletSpeed=this.config.send_v,this.userInfo=e.userInfo?e.userInfo:{},this.side=e.side?e.side:4,this.imgGoldLimit.visible=!1,this.showBtns(this.userInfo.isLocal),this.createLockFish(),this.setBatteryByConfig(),this.setRotationAndPosBySide(this.side),this.setPosition(e.posCfg.pos),this.bmpGold.text=e.userInfo.chips,this.visible=!1,this.showEnterAnim(i),this.visible=!0},i.prototype.showBtns=function(t){this.btnAdd.visible=t,this.btnMinus.visible=t},i.prototype.setBatteryByConfig=function(){this.bulletSendDis=this.config.offset_dis;var e=this.config.bubr_info[this.curBarrelIdx-1][2];this.userInfo.isLocal||(e=this.config.bubr_info[this.curBarrelIdx-1][3]),this.isPower&&(e=this.config.bubr_info[this.curBarrelIdx-1][4]);var i=t.FishMgr.Config.Sprite[e];this.barrelMc.movieClipData=GameApp.getMovieDataByFileName(i.file,i.key),i.width&&i.height?(this.barrelMc.width=i.width,this.barrelMc.height=i.height):(this.barrelMc.width=this.imgBarrel.width,this.barrelMc.height=this.imgBarrel.height),this.barrelMc.anchorOffsetX=.15*this.barrelMc.width,this.barrelMc.anchorOffsetY=.5*this.barrelMc.height,this.barrelMc.x=this.imgBarrel.x,this.barrelMc.y=this.imgBarrel.y,this.imgBarrel.visible=!1,this.imgGold.texture=RES.getRes(this.config.frame_key)},i.prototype.showEnterAnim=function(e){if(this.visible=!0,this.userInfo.isLocal){var i=t.FishMgr.Config.System.selfbat_enter_ani_id,n=t.FishMgr.Config.Sprite[i],r=GameApp.getClipByFileName(n.file,n.key);this.gpParent.addChild(r);var s=null;1==this.cusSkin?s={x:-200,y:-140}:(r.skewY=180,s={x:800,y:-140}),GameApp.playMoveClip(this.gpParent,r,"act",s,1,function(){this.inited=!0,r.parent&&r.parent.removeChild(r)},this);var o=t.FishMgr.Config.System.selfbat_hit_ani_id,a=t.FishMgr.Config.Sprite[o],h=GameApp.getClipByFileName(a.file,a.key);this.gpParent.addChild(h);var c=null;c=1==this.cusSkin?{x:70,y:-120}:{x:315,y:-120},GameApp.playMoveClip(this.gpParent,h,"act",c,4,function(){h.parent&&h.parent.removeChild(h)},this),this.alpha=0,egret.Tween.get(this).to({alpha:1},800)}else{if(e){var i=t.FishMgr.Config.System.otherbat_enter_ani_id,n=t.FishMgr.Config.Sprite[i],l=GameApp.getClipByFileName(n.file,n.key);this.gpParent.addChild(l);var p=null;1==this.cusSkin?p={x:-200,y:-140}:(l.skewY=180,p={x:800,y:-140}),GameApp.playMoveClip(this.gpParent,l,"act",p,1,function(){l.parent&&l.parent.removeChild(l)},this),this.alpha=0,egret.Tween.get(this).to({alpha:1},800)}this.inited=!0}},i.prototype.setPosition=function(t){this.x=t.x,this.y=t.y},i.prototype.setRotationAndPosBySide=function(t){switch(t){case 1:case 2:break;case 3:this.curAngle=270,this.rotation=180,this.bulletAngle=180;break;case 4:this.curAngle=270,this.rotation=0,this.bulletAngle=0}},i.prototype.rotationBatteryByPos=function(e){var i=this.gpParent.localToGlobal(this.barrelMc.x,this.barrelMc.y);if(this.curAngle=this.getRotationAngle(e,i,this.side)+this.piAngle,this.curAngle=parseInt(this.curAngle.toFixed(0)),this.barrelMc.rotation=this.curAngle,this.isAutoLock||this.isAutoFire){if(this.isAutoLock)if(this.lockFishByPos(e),this.isLockFish())this.setAutoLockFire(!0),this.clearLockStateCall&&this.clearLockStateCall();else{var n=t.FishMgr.BackgroundManager.getSceneState();1==n&&this.isHaveEnoughChips()&&t.FishReq.send_ReqFire(this.curAngle)}else if(this.isAutoFire){t.FishReq.send_ReqLockFish(0,this.curAngle);var n=t.FishMgr.BackgroundManager.getSceneState();1==n&&this.isHaveEnoughChips()&&t.FishReq.send_ReqFire(this.curAngle)}}else{var n=t.FishMgr.BackgroundManager.getSceneState();1==n&&this.isHaveEnoughChips()&&t.FishReq.send_ReqFire(this.curAngle)}},i.prototype.getRotationAngle=function(t,e,i){var n=0;if(t.x==e.x)1==i||2==i?t.y>=e.y?n=90:t.y<e.y&&(n=270):3==i?n=270:4==i&&(n=90);else{var r=(t.y-e.y)/(t.x-e.x);n=Math.atan(r)*this.piAngle/Math.PI,1==i&&0>=n?n=2*this.piAngle+n:2==i?n=this.piAngle+n:3==i&&0>=n?n=this.piAngle+n:4==i&&0>=n&&(n=this.piAngle+n)}return n},i.prototype.getBarrelPos=function(){return this.gpParent.localToGlobal(this.barrelMc.x,this.barrelMc.y)},i.prototype.setBarrelIndex=function(t,e,i){this.barrelMc.gotoAndStop("act"),this.isPower=i,this.curBarrelIdx!=t&&(this.curBarrelIdx=t,this.setBatteryByConfig()),this.lvNum=e,this.bmpLevel.text=e.toString()},i.prototype.getBatteryPos=function(){return this.gpParent.localToGlobal(this.imgBattery.x+this.imgBattery.width/2,this.imgBattery.y+this.imgBattery.height/2)},i.prototype.setChips=function(t){this.userInfo.chips=t,this.bmpGold.text=t,this.isHaveEnoughChips()},i.prototype.isHaveEnoughChips=function(){if(this.userInfo.isLocal&&this.inited){if(this.lvNum>this.userInfo.chips){if(this.imgGoldLimit.visible)return;return this.imgGoldLimit.scaleX=.1,this.imgGoldLimit.scaleY=.1,this.imgGoldLimit.visible=!0,egret.Tween.get(this.imgGoldLimit).to({scaleX:1,scaleY:1},1.5),!1}this.imgGoldLimit.visible=!1}return!0},i.prototype.createLockFish=function(){if(!this.lockFishObj){var e=this.getBatteryPos(),i={side:this.side,seatId:this.userInfo.seatId,isLocal:this.userInfo.isLocal,key:this.config.lock_line_key,bulletOffset:this.bulletSendDis,offsetPos:{x:e.x,y:e.y}};this.lockFishObj=new t.LockFish(i);var n=this;this.lockFishObj.setLockCall(function(t){n.sendLockMsg(t)}),t.FishMgr.BatteryManager.getLockParent().addChild(this.lockFishObj)}},i.prototype.sendLockMsg=function(e){this.userInfo.isLocal&&this.isAutoLock&&t.FishReq.send_ReqLockFish(e,-1)},i.prototype.getSendBulletPos=function(){var t=this.gpParent.localToGlobal(this.barrelMc.x,this.barrelMc.y),e=this.bulletSendDis*Math.cos((this.curAngle+this.bulletAngle)/this.piAngle*Math.PI),i=this.bulletSendDis*Math.sin((this.curAngle+this.bulletAngle)/this.piAngle*Math.PI);return{x:t.x+e,y:t.y+i}},i.prototype.sendBullet=function(e){this.sumIdelSendTime>=this.sendBulletSpeed?(this.sumIdelSendTime=0,this.isCanSendBullet()&&(this.curAngle=parseInt(this.curAngle.toFixed(0)),t.FishReq.send_ReqFire(this.curAngle))):this.sumIdelSendTime+=e},i.prototype.runSendBullet=function(e,i){if(this.userInfo.isLocal){var n=this.config.mus_eff_lst[0];this.isPower&&(n=this.config.mus_eff_lst[1]),t.FishMgr.MusicManager.play(n)}i>0&&180>i&&(i+=180),this.userInfo.isLocal||this.isLockFish()||(2==t.FishMgr.seatId||4==t.FishMgr.seatId?1==this.userInfo.seatId||3==this.userInfo.seatId?this.curAngle=this.piAngle-i:this.curAngle=i:(1==t.FishMgr.seatId||3==t.FishMgr.seatId)&&(2==this.userInfo.seatId||4==this.userInfo.seatId?this.curAngle=this.piAngle-i:this.curAngle=i),this.barrelMc.rotation=this.curAngle);var r=this.config.bubr_info[this.curBarrelIdx-1][0];this.isPower&&(r=this.config.bubr_info[this.curBarrelIdx-1][1]);var s={id:r,pos:this.getSendBulletPos(),angle:this.curAngle+this.bulletAngle,side:this.side,userInfo:GameApp.clone(this.userInfo),lockfishId:-1};s.userInfo.serverId=e,this.lockFishObj&&(s.lockfishId=this.getLockFishId()),this.userInfo.isLocal&&(s.angle=this.curAngle,this.autoExitTimeSum=0),this.setBatteryByConfig(),t.FishMgr.BulletManager.sendBullet(s),this.barrelMc.gotoAndPlay("act",1)},i.prototype.isCanSendBullet=function(){var e=!1,i=t.FishMgr.BackgroundManager.getSceneState();return(this.isAutoLockFire||this.isAutoFire)&&this.userInfo.isLocal&&1==i&&this.isHaveEnoughChips()&&(e=!0),e},i.prototype.isLongTimeNoSendBullet=function(){var t=!1;return this.userInfo.isLocal&&(t=this.autoExitTimeSum>this.autoExitTime),t},i.prototype.lockFish=function(){this.lockFishObj&&1==t.FishMgr.BackgroundManager.getSceneState()&&this.lockFishObj.lock()},i.prototype.unLockFish=function(){this.lockFishObj&&this.lockFishObj.unlock()},i.prototype.setUnLockFish=function(){this.lockFishObj&&!this.userInfo.isLocal&&this.lockFishObj.unlock(),this.isAutoFire=!1,this.isAutoLock=!1},i.prototype.setLockFish=function(t){this.lockFishObj&&this.lockFishObj.setLockFish(t)},i.prototype.forceToLockFish=function(t){this.lockFishObj&&this.lockFishObj.forceToLockFish(t)},i.prototype.resetLockFishLst=function(t){this.lockFishObj&&this.lockFishObj.resetLockLst(t)},i.prototype.isLockFish=function(){return this.lockFishObj&&this.lockFishObj.getLockState()&&-1!=this.lockFishObj.getCurrentLockFishId()?!0:!1},i.prototype.getLockFishId=function(){return this.lockFishObj?this.lockFishObj.getCurrentLockFishId():-1},i.prototype.getLockAngle=function(){return this.lockFishObj?this.lockFishObj.getCurrentLockAngle():0},i.prototype.getSide=function(){return this.side},i.prototype.isMyBattery=function(){return this.userInfo.isLocal},i.prototype.setUserInfo=function(t){this.userInfo=t},i.prototype.getChips=function(){return this.userInfo.chips},i.prototype.setAutoLockFire=function(t){this.userInfo.isLocal&&(this.isAutoLockFire=t)},i.prototype.setAutoLockFish=function(t){this.isAutoLock=t,this.isAutoLock?this.isAutoFire=!1:this.lockFishObj.unlock()},i.prototype.setAutoFire=function(e){this.isAutoFire=e,this.isAutoFire&&(this.lockFishObj.unlock(),this.isAutoLockFire=!1,this.isAutoLock=!1,this.userInfo.isLocal&&(this.curAngle=parseInt(this.curAngle.toFixed(0)),t.FishReq.send_ReqLockFish(0,this.curAngle)))},i.prototype.setAutoAngle=function(t){this.curAngle=t,this.barrelMc.rotation=this.curAngle},i.prototype.lockFishByPos=function(e){if(this.isAutoLock){var i=t.FishMgr.FishManager.clickFish(e);i&&this.lockFishObj.forceToLockFish(i.getObjId())}},i.prototype.getSeatId=function(){return this.userInfo.seatId},i.prototype.getPlayerId=function(){return this.userInfo.playerId?this.userInfo.playerId:0},i.prototype.setClearLockStateCall=function(t){this.clearLockStateCall=t},i.prototype.onDestroy=function(){this.parent&&this.parent.removeChild(this),this.lockFishObj&&this.lockFishObj.onDestroy()},i.prototype.update=function(t){if(this.inited){if(this.lockFishObj&&this.lockFishObj.update(t),this.isAutoLock&&this.isLockFish()){this.setAutoLockFire(!0);var e=this.lockFishObj.getCurrentLockAngle();this.curAngle=e;var i=0;1==this.side?i=2*this.piAngle-e-this.piAngle/2:2==this.side?i=2*this.piAngle-e-3*this.piAngle/2:3==this.side?(i=this.piAngle+e,this.curAngle=e-this.piAngle):4==this.side&&(i=e),this.barrelMc.rotation=i}else this.setAutoLockFire(!1);this.sendBullet(t),this.userInfo.isLocal&&this.autoExitTimeSum<this.autoExitTime&&(this.autoExitTimeSum+=t)}},i.prototype.getCusSkin=function(){return this.cusSkin},i}(eui.Component);t.Battery=e,__reflect(e.prototype,"fish.Battery")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.batteryLst={},t}return __extends(i,e),i.prototype.init=function(t,e){this.parentObj=t,this.lockParent=e},i.prototype.destroy=function(){this.parentObj=null,this.lockParent=null,this.batteryLst={},this.clearCallback=null},i.prototype.getLockParent=function(){return this.lockParent},i.prototype.createBattery=function(e,i){if(this.parentObj){var n=this.getRelativePosition(e.userInfo.seatId),r=this.batteryLst[n];if(r)r.setUserInfo(e.userInfo);else{var s=t.FishMgr.Config.BatteryPos[n];r=new t.Battery(s.skin);var o={configId:s.batt_cfg_id,userInfo:e.userInfo,side:s.side,posCfg:s};this.parentObj.addChild(r),r.setBatteryInfo(o,i),r.setUserInfo(e.userInfo),this.batteryLst[n]=r}}},i.prototype.removeBatteryBySeatId=function(t){if(t){var e=this.getRelativePosition(t),i=this.batteryLst[e];i&&i.onDestroy(),delete this.batteryLst[e]}},i.prototype.getBatteryBySeatId=function(t){if(t){var e=this.getRelativePosition(t);return this.batteryLst[e]}return null},i.prototype.resetLockFishLst=function(t){for(var e in this.batteryLst){var i=this.batteryLst[e];i&&i.resetLockFishLst(t)}},i.prototype.clearAllLockState=function(){for(var t in this.batteryLst){var e=this.batteryLst[t];e&&(e.resetLockFishLst([]),e.unLockFish())}this.clearCallback&&this.clearCallback()},i.prototype.getMyBattery=function(){for(var t in this.batteryLst){var e=this.batteryLst[t];if(e&&e.isMyBattery())return e}return null},i.prototype.getBatteryByPId=function(t){for(var e in this.batteryLst){var i=this.batteryLst[e];if(i&&0==t.compare(i.getPlayerId()))return i}return null},i.prototype.rotateByPos=function(t){var e=this.getMyBattery();e&&e.rotationBatteryByPos(t)},i.prototype.setClearLockStateCall=function(t){this.clearCallback=t;for(var e in this.batteryLst){var i=this.batteryLst[e];i&&i.isMyBattery()&&i.setClearLockStateCall(t)}},i.prototype.update=function(t){for(var e in this.batteryLst)this.batteryLst[e]&&this.batteryLst[e].update(t)},i.prototype.getRelativePosition=function(e){var i=e;return t.FishMgr.seatId==e?4:(1==t.FishMgr.seatId?2==e?i=3:3==e?i=2:4==e&&(i=1):2==t.FishMgr.seatId?1==e?i=3:3==e?i=1:4==e&&(i=2):3==t.FishMgr.seatId&&(1==e?i=2:2==e?i=1:4==e&&(i=3)),i)},i}(BaseClass);t.BatteryManager=e,__reflect(e.prototype,"fish.BatteryManager")}(fish||(fish={}));var fish;!function(t){var e=function(e){function n(t){var i=e.call(this)||this;return i.moveSpeed=600,i.frontPos={x:0,y:0},i.curPos={x:0,y:0},i.curAngle=0,i.curSide=0,i.dataId=0,i.objId=0,i.userInfo={playerId:0,seatId:0,isLocal:!1,serverId:-1},i.curLockFishId=-1,i.curLineRunTime=0,i.isUse=!1,i.init(t),i}return __extends(n,e),n.prototype.init=function(e){this.config=t.FishMgr.Config.Bullet[e.id],this.image=new eui.Image,this.image.texture=RES.getRes(this.config.src_key),this.image.anchorOffsetX=this.image.width/2,this.image.anchorOffsetY=this.image.height/2,this.visible=!1,this.moveSpeed=this.config.act_v,this.bondingBox=this.config.bonding_box,this.dataId=this.config.id,this.objId=e.objId,this.addChild(this.image),this.image.touchEnabled=!1,this.touchEnabled=!1},n.prototype.resumeOrgin=function(){this.visible=!1,this.rotation=0,this.x=0,this.y=0,this.userInfo={playerId:0,seatId:0,isLocal:!0,serverId:-1},this.curLineRunTime=0,this.frontPos={x:0,y:0}},n.prototype.getCurActPos=function(){return{x:this.curPos.x+this.frontPos.x,y:this.curPos.y+this.frontPos.y}},n.prototype.setStartPosAndAngle=function(t,e,i,n){this.visible=!0,this.curAngle=e,this.curSide=i,this.curPos=t,this.frontPos={x:0,y:0},this.curLineRunTime=0,this.curLockFishId=n,this.setPosAngAngle(this.curPos,this.curAngle)},n.prototype.createBoundbox=function(){for(var t=0;t<this.bondingBox.length;t++){var e=this.bondingBox[t],i=new egret.Shape;i.graphics.beginFill(65280),i.graphics.drawCircle(e.a,e.b,e.r),i.graphics.endFill(),i.width=e.r,i.height=e.r,this.addChild(i)}},n.prototype.getNewAngleAndSide=function(t,e,n){var r=this.getNewSide(n,{width:1920,height:1080});if(90==t||270==t)return{angle:360-t,side:r};if(0==t||360==t)return{angle:180,side:r};if(180==t)return{angle:0,side:r};if(e==i.Bottom){if(r==i.Right)return{angle:180-t,side:r};if(r==i.Top)return{angle:360-t,side:r};if(r==i.Left)return{angle:180-t,side:r}}else if(e==i.Top){if(r==i.Left)return{angle:540-t,side:r};if(r==i.Right)return{angle:540-t,side:r};if(r==i.Bottom)return{angle:360-t,side:r}}else if(e==i.Left){if(r==i.Top)return{angle:360-t,side:r};if(r==i.Bottom)return{angle:360-t,side:r};if(r==i.Right)return t>90?{angle:540-t,side:r}:{angle:180-t,side:r}}else if(e==i.Right){if(r==i.Top)return{angle:360-t,side:r};if(r==i.Bottom)return{angle:360-t,side:r};if(r==i.Left)return t>180?{angle:540-t,side:r}:{angle:180-t,side:r}}return{angle:null,side:r}},n.prototype.getNewSide=function(t,e){var n=i.None;return t.x<e.width/2&&t.y>e.height/2&&t.x<=e.height-t.y?n=i.Left:t.x<e.width/2&&t.y>e.height/2&&t.x>e.height-t.y?n=i.Bottom:t.x<e.width/2&&t.y<e.height/2&&t.x<=t.y?n=i.Left:t.x<e.width/2&&t.y<e.height/2&&t.x>t.y?n=i.Top:t.x>e.width/2&&t.y>e.height/2&&e.width-t.x<=e.height-t.y?n=i.Right:t.x>e.width/2&&t.y>e.height/2&&e.width-t.x>e.height-t.y?n=i.Bottom:t.x>e.width/2&&t.y<e.height/2&&e.width-t.x<=t.y?n=i.Right:t.x>e.width/2&&t.y<e.height/2&&e.width-t.x>t.y&&(n=i.Top),n},n.prototype.isBulletOutOfBondingRect=function(){for(var t=this.getCurActPos(),e=0;e<this.bondingBox.length;e++){var i=this.bondingBox[e],n={x:i.a+t.x,y:i.b+t.y};if(n.x<i.r||1920-n.x<i.r||n.y<i.r||1080-n.y<i.r)return!0}return!1},n.prototype.getBondingBox=function(){var t=this,e=this.parent?this.parent.localToGlobal(this.x,this.y):{x:this.x,y:this.y},i=[];return this.bondingBox.forEach(function(n){var r={},s=-t.curAngle,o=n.a*Math.cos(s/180*Math.PI)+n.b*Math.sin(s/180*Math.PI),a=n.b*Math.cos(s/180*Math.PI)-n.a*Math.sin(s/180*Math.PI);r.a=o+e.x,r.b=a+e.y,r.r=n.r,i.push(r)}),i},n.prototype.shotSomething=function(){var e={};e.pos=this.parent.localToGlobal(this.x,this.y),this.userInfo.isLocal?e.id=this.config.my_fnet_id:e.id=this.config.oth_net_id,t.FishMgr.FishNetManager.play(e)},n.prototype.setUserInfo=function(t){this.userInfo=t},n.prototype.getUserInfo=function(){return this.userInfo},n.prototype.setPosAngAngle=function(t,e){t&&(this.x=t.x,this.y=t.y),e&&(this.rotation=e)},n.prototype.getDataId=function(){return this.dataId},n.prototype.getObjId=function(){return this.objId},n.prototype.setUseState=function(t){this.isUse=t},n.prototype.getUseState=function(){return this.isUse},n.prototype.isMyBullet=function(){return this.userInfo.isLocal},n.prototype.getBulletSeatId=function(){return this.userInfo.seatId},n.prototype.getBulletPlayerId=function(){return this.userInfo.playerId},n.prototype.getBulletServerId=function(){return this.userInfo.serverId},n.prototype.getCurLockFishId=function(){return this.curLockFishId},n.prototype.update=function(e){if(this.isBulletOutOfBondingRect()){var i=this.getNewAngleAndSide(this.curAngle,this.curSide,this.getCurActPos());this.curLineRunTime=0,this.curPos.x=this.curPos.x+this.frontPos.x,this.curPos.y=this.curPos.y+this.frontPos.y,this.frontPos={x:0,y:0},this.curSide=i.side,this.curLockFishId=-1,i.angle&&(this.curAngle=i.angle),this.setPosAngAngle(null,this.curAngle)}var n=t.FishMgr.BatteryManager.getBatteryBySeatId(this.userInfo.seatId);n&&n.isLockFish()&&n.getLockFishId()==this.curLockFishId&&-1!=this.curLockFishId&&(this.curAngle=n.getLockAngle(),this.setPosAngAngle(null,this.curAngle)),this.curLineRunTime+=e;var r=this.moveSpeed*this.curLineRunTime;this.frontPos.x=r*Math.cos(this.curAngle/180*Math.PI),this.frontPos.y=r*Math.sin(this.curAngle/180*Math.PI);var s={x:this.curPos.x+this.frontPos.x,y:this.curPos.y+this.frontPos.y};this.setPosAngAngle(s,null)},n}(eui.Group);t.Bullet=e,__reflect(e.prototype,"fish.Bullet");var i;!function(t){t[t.None=0]="None",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.Top=3]="Top",t[t.Bottom=4]="Bottom"}(i=t.Side||(t.Side={}))}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.aliveLst={},t.aliveBBXLst={},t}return __extends(i,e),i.prototype.init=function(t){this.parentObj=t},i.prototype.preCreated=function(e){var i=new t.Bullet(e);return i},i.prototype.destroy=function(){this.parentObj=null,this.aliveLst={},this.aliveBBXLst={}},i.prototype.sendBullet=function(e){if(this.parentObj){var i=t.FishMgr.FishObjectPool.getObject(t.ObjectClassType.TypeBullet,e.id);if(i){this.parentObj.addChild(i);var n=this.parentObj.globalToLocal(e.pos.x,e.pos.y);e.pos={x:n.x,y:n.y},i.setStartPosAndAngle(e.pos,e.angle,e.side,e.lockfishId),i.setUserInfo(e.userInfo),i.setUseState(!0),this.aliveLst[i.getObjId()]=i,this.aliveBBXLst[i.getObjId()]=i.getBondingBox()}}},i.prototype.update=function(t){for(var e in this.aliveLst){var i=this.aliveLst[e];i&&(i.update(t),this.aliveBBXLst[i.getObjId()]=i.getBondingBox())}},i.prototype.getBulletAliveLst=function(){var t=[];
for(var e in this.aliveLst){var i=this.aliveLst[e];i&&t.push(i)}return t},i.prototype.removeBulletObject=function(t){var e=this.aliveLst[t];e&&(delete this.aliveLst[t],delete this.aliveBBXLst[t],e.shotSomething(),e.resumeOrgin(),e.setUseState(!1),e.parent&&e.parent.removeChild(e))},i.prototype.removeBulletObjectBySetId=function(t){for(var e in this.aliveLst){var i=this.aliveLst[e];i&&t==i.getBulletSeatId()&&(i.setUseState(!1),i.resumeOrgin(),delete this.aliveLst[i.getObjId()],delete this.aliveBBXLst[i.getObjId()])}},i.prototype.getBulletBBX=function(t){return this.aliveBBXLst[t]},i}(BaseClass);t.BulletManager=e,__reflect(e.prototype,"fish.BulletManager")}(fish||(fish={}));var fish;!function(t){var e=function(){function t(){}return t.prototype.__parabola=function(t){return t.a*Math.pow(t.x,2)+t.b*t.x+t.c},t.prototype.__acubiccve=function(t){return t.a*Math.pow(t.x,3)},t.prototype.__aexponential=function(t){return Math.pow(t.a,t.x)},t.prototype.__alogarithm=function(t){return t.a*Math.log(t.x)},t.prototype.__asin=function(t){return t.a*Math.sin(t.b*t.x)},t.prototype.__acos=function(t){return t.a*Math.cos(t.b*t.x)},t.prototype.__circle=function(t){return 1==t.way?Math.sqrt(Math.pow(t.r,2)-Math.pow(t.x+t.a,2))-t.b:0-Math.sqrt(Math.pow(t.r,2)-Math.pow(t.x+t.a,2))-t.b},t.prototype.__kline=function(t){return t.k*t.x},t}();t.CaculatRule=e,__reflect(e.prototype,"fish.CaculatRule");var i;!function(t){t[t.pbl=1]="pbl",t[t.ccve=2]="ccve",t[t.expt=3]="expt",t[t.logh=4]="logh",t[t.sin=5]="sin",t[t.cos=6]="cos",t[t.cicle=7]="cicle",t[t.line=8]="line"}(i=t.CurveRuleType||(t.CurveRuleType={}));var n=function(t){function n(){var n=t.call(this)||this;return n._caculatRule=new e,n.funLst={},n.funLst[i.pbl]=n._caculatRule.__parabola,n.funLst[i.ccve]=n._caculatRule.__acubiccve,n.funLst[i.expt]=n._caculatRule.__aexponential,n.funLst[i.logh]=n._caculatRule.__alogarithm,n.funLst[i.sin]=n._caculatRule.__asin,n.funLst[i.cos]=n._caculatRule.__acos,n.funLst[i.cicle]=n._caculatRule.__circle,n.funLst[i.line]=n._caculatRule.__kline,n}return __extends(n,t),n.prototype.getPos=function(t,e){var i={x:0,y:0};if(t){var n=this.funLst[t];if(n){var r=n(e);i.x=e.x,i.y=r}}return i},n}(BaseClass);t.frule=n,__reflect(n.prototype,"fish.frule")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.registerCallback=function(t,e){this.callBack=[t,e]},i.prototype.destroy=function(){this.callBack=null},i.prototype.update=function(e){var i=[],n=t.FishMgr.BulletManager.getBulletAliveLst();n&&n.length>0&&n.forEach(function(e){var n=e.getObjId(),r=t.FishMgr.BulletManager.getBulletBBX(n),s=e.getBulletSeatId(),o=t.FishMgr.BatteryManager.getBatteryBySeatId(s);if(o){var a=o.getLockFishId(),h=t.FishMgr.FishManager.getFishObjById(a);if(h&&e.getCurLockFishId()==a){var c=h.isShotFish(r);if(c){var l={bullet:e,fish:h};i.push(l)}}else{var p=t.FishMgr.FishManager.shotFish(r);if(p){var l={bullet:e,fish:p};i.push(l)}}}else{var p=t.FishMgr.FishManager.shotFish(r);if(p){var l={bullet:e,fish:p};i.push(l)}}}),this.callBack&&this.callBack[0].apply(this.callBack[1],[i])},i}(BaseClass);t.CollisionManager=e,__reflect(e.prototype,"fish.CollisionManager")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.startPos={x:0,y:0},i.runTime=0,i.curPos={x:0,y:0},i.curAngle=0,i.goldEndPos={x:0,y:0},i.userInfo={playerId:-1,seatId:1},i.fishScore=0,i.curLineObjLst=[],i.curLineObj=null,i.fishLevel=0,i.sceneId=-1,i.initData(t),i.initUI(),i.touchEnabled=!1,i}return __extends(i,e),i.prototype.initData=function(e){var i=this;this.preObjId=e.objId,this.dataId=e.id,this.fishCfg=t.FishMgr.Config.Fish[e.id],this.bbxCfg=t.FishMgr.Config.BondingBox[this.fishCfg.bbx_id],-1!=this.fishCfg.cve_id&&(this.curveCfg=t.FishMgr.Config.Curve[this.fishCfg.cve_id]);var n={};this.curveCfg&&(n={spos:this.startPos,ratio:this.curveCfg.ratio}),this.fishCurve=new t.ActionCurve(n),this.curveCfg&&(this.curveCfg.data.forEach(function(t){i.fishCurve.addCurve(t)}),this.setCurveRotation(this.curveCfg.angle)),this.runTime=0,this.curPos={x:0,y:0},this.curAngle=0,this.goldEndPos={x:0,y:0},this.userInfo={playerId:-1,seatId:1},this.fishScore=0,this.curLineObjLst=[],this.curLineObj=null,this.fishLevel=0,this.sceneId=-1,this.aliveLst=[],this.deathLst=[]},i.prototype.initUI=function(){this.createFishItem(this.fishCfg.alive,this.aliveLst),this.createFishItem(this.fishCfg.death,this.deathLst)},i.prototype.resumeOrgin=function(){this.setUseState(!1),this.userInfo={playerId:-1,seatId:1},this.runTime=0,this.goldEndPos={x:0,y:0},this.fishCurve.resetInfo(),this.curLineObj&&this.curLineObj.parent&&this.curLineObj.parent.removeChild(this.curLineObj),this.curLineObjLst=[],this.parent&&this.parent.removeChild(this)},i.prototype.createBoundbox=function(){for(var t=0;t<this.bbxCfg.data.length;t++){var e=this.bbxCfg.data[t],i=new egret.Shape;i.graphics.beginFill(16711680),i.graphics.drawCircle(e.a,e.b,e.r),i.graphics.endFill(),i.width=e.r,i.height=e.r,this.addChild(i)}},i.prototype.runStartEff=function(e){var i=this;e.forEach(function(e){1==e.stype?e.spr&&e.spr.gotoAndPlay("act",e.loop):2==e.stype||3==e.stype;var n=i;e.spr&&t.FishMgr.ActionEffect.play(e.spr,function(){n.startEffEndCall()},e.act_id),t.FishMgr.MusicManager.play(t.FishMgr.randomSelectId(i.fishCfg.alive.mus_lst));for(var r=0;r<i.fishCfg.alive.skl_id_lst.length;r++)t.FishMgr.SkillManager.play(i,i.fishCfg.alive.skl_id_lst[r])})},i.prototype.startEffEndCall=function(){},i.prototype.runDeadEff=function(e){var i=this;e.forEach(function(e){1==e.stype?e.spr&&e.spr instanceof egret.MovieClip&&e.spr.gotoAndPlay("act",e.loop):2==e.stype||3==e.stype;var n=i;e.spr&&t.FishMgr.ActionEffect.play(e.spr,function(){n.deadEffEndCall()},e.act_id)}),t.FishMgr.FishLabelManager.play(this.getCurrentPos(),this.fishScore),t.FishMgr.MusicManager.play(t.FishMgr.randomSelectId(this.fishCfg.death.mus_lst));for(var n=0;n<this.fishCfg.death.skl_id_lst.length;n++)t.FishMgr.SkillManager.play(this,this.fishCfg.death.skl_id_lst[n])},i.prototype.deadEffEndCall=function(){if(this.parent){var e={startPos:this.getCurrentPos(),angle:this.curAngle,number:this.fishScore,endPos:GameApp.clone(this.goldEndPos)};t.FishMgr.FishGoldManager.play(e),this.resumeOrgin()}},i.prototype.createFishItem=function(e,i){for(var n=e.view_inf.length,r=0;n>r;r++){var s=t.FishMgr.Config.Sprite[e.view_inf[r].src_id],o={};if(o.loop=e.view_inf[r].loop,o.act_id=e.view_inf[r].act_id,o.src_id=e.view_inf[r].src_id,o.stype=s.stype,o.sspos=e.view_inf[r].pos,o.ani_key=s.key,1==s.stype){var a=GameApp.getClipByFileName(s.file,s.key);s.width&&s.height&&(a.width=s.width,a.height=s.height),a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,a.touchEnabled=!1,o.spr=a,this.addChild(o.spr),o.spr.x=e.view_inf[r].pos.x+this.width/2,o.spr.y=e.view_inf[r].pos.y+this.height/2,o.spr.visible=!0}else if(2==s.stype){var h=new eui.Image;h.texture=RES.getRes(s.file),h.anchorOffsetX=h.width/2,h.anchorOffsetY=h.height/2,o.spr=h,h.touchEnabled=!1,this.addChild(o.spr),o.spr.x=e.view_inf[r].pos.x+this.width/2,o.spr.y=e.view_inf[r].pos.y+this.height/2,o.spr.visible=!0}else 3==s.styoe;i.push(o)}},i.prototype.setFishCurveId=function(e){var i=this;if(e&&-1!=e){var n=t.FishMgr.Config.Curve[e];n&&(this.curveCfg=n,this.fishCurve.clearAllCurve(),this.fishCurve.setCurveRatio(this.curveCfg.ratio),this.curveCfg.data.forEach(function(t){i.fishCurve.addCurve(t)}),this.setCurveRotation(this.curveCfg.angle))}},i.prototype.setStartPos=function(t){this.startPos=t,this.fishCurve.setStartPos(t),this.setPos(t)},i.prototype.setPos=function(e){if(e&&e.x&&e.y){switch(this.parent&&(e=this.parent.globalToLocal(e.x,1080-e.y)),t.FishMgr.seatId){case 1:e.y=1080-e.y;break;case 2:e.y=1080-e.y,e.x=1920-e.x;break;case 3:e.x=1920-e.x;break;case 4:}this.x=e.x,this.y=e.y}},i.prototype.setFishPosAndAngle=function(e,i){if(this.setPos(e),i){switch(t.FishMgr.seatId){case 1:i=-i;break;case 2:i=180+i;break;case 3:i=180-i;break;case 4:}this.curAngle=i,this.rotation=i}},i.prototype.isOutofTime=function(){return this.fishCurve.isCurveEnd()},i.prototype.setRunTime=function(t){t&&(this.runTime=t)},i.prototype.showAliveSpr=function(t){this.aliveLst.forEach(function(e){e.spr.visible=t})},i.prototype.showDeadSpr=function(t){this.deathLst.forEach(function(e){e.spr.visible=t})},i.prototype.fishDead=function(){this.showAliveSpr(!1),this.showDeadSpr(!0),this.runDeadEff(this.deathLst)},i.prototype.fishOut=function(){this.showAliveSpr(!1),this.showDeadSpr(!1),this.resumeOrgin()},i.prototype.fishStart=function(){this.showAliveSpr(!0),this.showDeadSpr(!1),this.runStartEff(this.aliveLst);var t=this.fishCurve.getPosAndAngleByTime(.001);t.pos&&t.pos.x&&t.pos.y&&(this.curPos=t.pos),t.angle&&(this.curAngle=t.angle),this.setFishPosAndAngle(t.pos,t.angle)},i.prototype.setCurveRotation=function(t){this.fishCurve.setActionRotation(t)},i.prototype.setReserve=function(t){this.fishCurve.setActionReserve(t)},i.prototype.setUserInfo=function(t){t&&(this.userInfo=t)},i.prototype.setFishSceneId=function(t){this.sceneId=t},i.prototype.isShotFish=function(t){if(this.curPos)for(var e=this.parent?this.parent.localToGlobal(this.x,this.y):{x:this.x,y:this.y},i=0;i<t.length;i++)for(var n=t[i],r=0;r<this.bbxCfg.data.length;r++){var s=this.bbxCfg.data[r],o=-this.curAngle,a=s.a*Math.cos(o/180*Math.PI)+s.b*Math.sin(o/180*Math.PI),h=s.b*Math.cos(o/180*Math.PI)-s.a*Math.sin(o/180*Math.PI),c={x:a+e.x,y:h+e.y},l=App.MathUtils.getDistance(c.x,c.y,n.a,n.b);if(n.r+s.r>l)return!0}return!1},i.prototype.getCurrentBBX=function(){for(var t=GameApp.clone(this.bbxCfg.data),e=this.getCurrentPos(),i=0;i<this.bbxCfg.data.length;i++){var n=this.bbxCfg.data[i],r=-this.curAngle;t[i].a=n.a*Math.cos(r/180*Math.PI)+n.b*Math.sin(r/180*Math.PI)+e.x,t[i].b=n.b*Math.cos(r/180*Math.PI)-n.a*Math.sin(r/180*Math.PI)+e.y}return t},i.prototype.getObjId=function(){return this.objId},i.prototype.setObjId=function(t){this.objId=t},i.prototype.getDataId=function(){return this.dataId},i.prototype.getCurrentPos=function(){return this.parent?this.parent.localToGlobal(this.x,this.y):{x:this.x,y:this.y}},i.prototype.setShotSeatId=function(t){this.userInfo.seatId=t},i.prototype.getShotSeatId=function(){return this.userInfo.seatId},i.prototype.getLockLevel=function(){return this.fishCfg.lock_level},i.prototype.addLineRelObj=function(t){t&&this.curLineObjLst.push(t)},i.prototype.getLineRelObjLst=function(){return this.curLineObjLst},i.prototype.setFishLevel=function(t){t&&(this.fishLevel=t)},i.prototype.getFishLevel=function(){return this.fishLevel},i.prototype.setFishScore=function(t){this.fishScore=t},i.prototype.getFishScore=function(){return this.fishScore},i.prototype.setGoldMoveEndPos=function(t){this.goldEndPos={x:t.x,y:t.y}},i.prototype.getFishSceneId=function(){return this.sceneId},i.prototype.setCurrentLineObj=function(t){this.curLineObj=t},i.prototype.getCurrentLineObj=function(){return this.curLineObj},i.prototype.update=function(e){2==t.FishMgr.BackgroundManager.getSceneState()&&this.sceneId!=t.FishMgr.BackgroundManager.getCurrentSceneId()&&-1!=this.sceneId&&(e*=t.FishMgr.Config.System.cut_scene_fish_vx),this.runTime+=e;var i=this.fishCurve.getPosAndAngleByTime(this.runTime);i.pos&&i.pos.x&&i.pos.y&&(this.curPos=i.pos),i.angle&&(this.curAngle=i.angle),this.setFishPosAndAngle(i.pos,i.angle)},i.prototype.setUseState=function(t){this.isUse=t},i.prototype.getUseState=function(){return this.isUse},i}(eui.Group);t.Fish=e,__reflect(e.prototype,"fish.Fish")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.curFish=t.FishMgr.fishModule,i.config=RES.getRes(i.curFish+"_fish_config_json"),i}return __extends(i,e),i.prototype.getConfig=function(t){return this.config[t]},Object.defineProperty(i.prototype,"Battery",{get:function(){return this.getConfig("Battery")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BatteryPos",{get:function(){return this.getConfig("BatteryPos")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Action",{get:function(){return this.getConfig("Action")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Background",{get:function(){return this.getConfig("Background")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BgMusic",{get:function(){return this.getConfig("BgMusic")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BondingBox",{get:function(){return this.getConfig("BondingBox")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Bullet",{get:function(){return this.getConfig("Bullet")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Curve",{get:function(){return this.getConfig("Curve")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Fish",{get:function(){return this.getConfig("Fish")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FishGold",{get:function(){return this.getConfig("FishGold")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LabelFnt",{get:function(){return this.getConfig("LabelFnt")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Net",{get:function(){return this.getConfig("Net")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Water",{get:function(){return this.getConfig("Water")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Music",{get:function(){return this.getConfig("Music")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Skill",{get:function(){return this.getConfig("Skill")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Sprite",{get:function(){return this.getConfig("Sprite")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"System",{get:function(){return this.getConfig("System")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Sound",{get:function(){return this.getConfig("Sound")},enumerable:!0,configurable:!0}),i}(BaseClass);t.FishConfigManager=e,__reflect(e.prototype,"fish.FishConfigManager")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.endPos={x:0,y:0},i.startPos={x:0,y:0},i.info=t,i.init(),i}return __extends(i,e),i.prototype.resumeOrgin=function(){this.visible=!1,this.startPos={x:0,y:0},this.endPos={x:0,y:0},this.finishCall=null,this.x=0,this.y=0},i.prototype.init=function(){this.dataId=this.info.id,this.objId=this.info.objId;var e=t.FishMgr.Config.FishGold[this.info.id],i=t.FishMgr.Config.Sprite[e.src_id];this.movieClipData=GameApp.getMovieDataByFileName(i.file,i.key),e.width&&e.height&&(this.width=e.width,this.height=e.height),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.visible=!1,this.touchEnabled=!1},i.prototype.startPlay=function(t,e){this.setUseState(!0),this.x=t.x,this.y=t.y,this.startPos=t,this.endPos=e,this.visible=!0,this.gotoAndPlay("act",-1);var i=this.getEndMoveTime();egret.Tween.get(this).to({x:this.endPos.x,y:this.endPos.y},1e3*i).call(function(){this.gotoAndStop("act"),this.finishCall&&this.finishCall[0].apply(this.finishCall[1],[this])},this)},i.prototype.setFinishCall=function(t,e){t&&e&&(this.finishCall=[t,e])},i.prototype.getDataId=function(){return this.dataId},i.prototype.getObjId=function(){return this.objId},i.prototype.setUseState=function(t){this.isUse=t},i.prototype.getUseState=function(){return this.isUse},i.prototype.getEndMoveTime=function(){var e=App.MathUtils.getDistanceByPoint(this.startPos,this.endPos);return e/t.FishMgr.Config.System.gold_move_v},i}(egret.MovieClip);t.FishGold=e,__reflect(e.prototype,"fish.FishGold")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.fishGoldList=[],t}return __extends(i,e),i.prototype.init=function(e){this.parentObj=e,this.goldCfg=t.FishMgr.Config.FishGold,this.goldMusicId=t.FishMgr.Config.System.gold_mus_id},i.prototype.destroy=function(){this.parentObj=null,this.goldCfg=null,this.goldMusicId=null},i.prototype.preCreated=function(e){var i=new t.FishGold(e);return i},i.prototype.clear=function(){this.fishGoldList.forEach(function(t){t.resumeOrgin(),t.setUseState(!1),t.parent&&t.parent.removeChild(t)}),this.fishGoldList=[]},i.prototype.play=function(e){if(this.parentObj){this.goldCfg||(this.goldCfg=t.FishMgr.Config.FishGold);var i=1;for(var n in this.goldCfg)if(e.number>this.goldCfg[n].gold_num){i=this.goldCfg[n].id;break}var r=Math.ceil(e.number/this.goldCfg[i].gold_num);r>10&&(r=10);for(var s=0,o=0;r>o;o++){var a=t.FishMgr.FishObjectPool.getObject(t.ObjectClassType.TypeGold,i);this.parentObj.addChild(a),this.fishGoldList.push(a);var h=o;h>=r/2&&r>1&&(h=r-o),s=h*Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2))+t.FishMgr.Config.System.gold_distance;var c=this.getObjPos(r,o,e.angle,t.FishMgr.Config.System.gold_arrang_way,s);a.setFinishCall(function(t){t.resumeOrgin(),t.setUseState(!1),t.parent&&t.parent.removeChild(t)},this),e.startPos=this.parentObj.localToGlobal(e.startPos.x,e.startPos.y),e.endPos=this.parentObj.localToGlobal(e.endPos.x,e.endPos.y),c.x=e.startPos.x-c.x,c.y=e.startPos.y-c.y,a.startPlay(c,e.endPos)}t.FishMgr.MusicManager.play(this.goldMusicId)}},i.prototype.getObjPos=function(t,e,i,n,r){var s={x:0,y:0};return 1==n&&(t/2>e?(s.x=r*Math.cos(Math.PI-i/180*Math.PI),s.y=r*Math.sin(Math.PI-i/180*Math.PI)):(s.x=-r*Math.cos(Math.PI-i/180*Math.PI),s.y=-r*Math.sin(Math.PI-i/180*Math.PI))),s},i}(BaseClass);t.FishGoldManager=e,__reflect(e.prototype,"fish.FishGoldManager")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.info=t,i.init(),i}return __extends(i,e),i.prototype.init=function(){this.dataId=this.info.id,this.objId=this.info.objId;var e=t.FishMgr.Config.LabelFnt[this.info.id],i=RES.getRes(e.src);this.font=i,this.setUseState(!1),this.visible=!1,this.width=500,this.height=120,this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.x=0,this.y=0,this.touchEnabled=!1},i.prototype.resumeOrgin=function(){this.visible=!1,this.finishCall=null,this.text="0",this.x=0,this.y=0},i.prototype.play=function(t,e){this.setUseState(!0),this.text=e,this.x=t.x,this.y=t.y,this.textAlign=egret.HorizontalAlign.CENTER,this.visible=!0;var i=this.y;egret.Tween.get(this).to({y:i+120},600).to({y:i},400).call(function(){this.finishCall&&this.finishCall[0].apply(this.finishCall[1],[this])},this)},i.prototype.setFinishCall=function(t,e){t&&e&&(this.finishCall=[t,e])},i.prototype.getDataId=function(){return this.dataId},i.prototype.getObjId=function(){return this.objId},i.prototype.setUseState=function(t){this.isUse=t},i.prototype.getUseState=function(){return this.isUse},i}(eui.BitmapLabel);t.FishLabel=e,__reflect(e.prototype,"fish.FishLabel")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.fishLabelList=[],t}return __extends(i,e),i.prototype.init=function(t){this.parentObj=t},i.prototype.destroy=function(){this.parentObj=null},i.prototype.preCreated=function(e){var i=new t.FishLabel(e);return i},i.prototype.clear=function(){this.fishLabelList.forEach(function(t){t.resumeOrgin(),t.setUseState(!1),t.parent&&t.parent.removeChild(t)}),this.fishLabelList=[]},i.prototype.play=function(e,i){if(this.parentObj){var n=t.FishMgr.Config.System.gold_fnt_index,r=t.FishMgr.FishObjectPool.getObject(t.ObjectClassType.TypeLabel,n);r.setFinishCall(function(t){t.resumeOrgin(),t.setUseState(!1),t.parent&&t.parent.removeChild(t)},this);var s=this.parentObj.globalToLocal(e.x,e.y);r.play(s,i),this.parentObj.addChild(r),this.fishLabelList.push(r)}},i}(BaseClass);t.FishLabelManager=e,__reflect(e.prototype,"fish.FishLabelManager")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.aliveFishLst={},t.aliveBBXInfoLst={},t.fishLevelInfo={level:0,fishId:-1},t.aliveFishLst={},t.aliveBBXInfoLst={},t.fishLevelInfo={level:0,fishId:-1},t}return __extends(i,e),i.prototype.init=function(t){this.parentObj=t},i.prototype.preCreated=function(e){var i=new t.Fish(e);return i},i.prototype.destroy=function(){this.parentObj=null,this.aliveFishLst={},this.aliveBBXInfoLst={}},i.prototype.addFish=function(e){if(this.parentObj){if(this.aliveFishLst[e.objId]){var i=this.aliveFishLst[e.objId];return i.setRunTime(e.runTime),!1}var n=t.FishMgr.FishObjectPool.getObject(t.ObjectClassType.TypeFish,e.fishId);return n.setObjId(e.objId),this.parentObj.addChild(n),n.setUseState(!0),n.setFishCurveId(e.cveId),n.setRunTime(e.runTime),n.setStartPos(e.pos),n.setReserve(e.breserve),n.setCurveRotation(e.angle),n.setUserInfo(e.userInfo),n.setFishSceneId(t.BackgroundManager.getInstance().getCurrentSceneId()),this.aliveFishLst[n.getObjId()]=n,this.aliveBBXInfoLst[n.getObjId()]=n.getCurrentBBX(),n.fishStart(),this.fishLevelInfo.fishId==e.fishId&&this.fishLevelInfo.fishId&&(n.setFishLevel(this.fishLevelInfo.level),t.FishMgr.SkillManager.play(n,4)),!0}},i.prototype.removeFish=function(t){var e=this.aliveFishLst[t];e&&e&&(e.fishDead(),delete this.aliveFishLst[t],delete this.aliveBBXInfoLst[t])},i.prototype.update=function(e){for(var i in this.aliveFishLst){var n=this.aliveFishLst[i];if(!n)return;n.update(e),this.aliveBBXInfoLst[i]=n.getCurrentBBX(),n.isOutofTime()&&(n.fishOut(),delete this.aliveFishLst[i],delete this.aliveBBXInfoLst[i])}1==t.FishMgr.BackgroundManager.getSceneState()&&t.FishMgr.BatteryManager.resetLockFishLst(this.getFishLevelLst())},i.prototype.shotFish=function(t){for(var e in this.aliveBBXInfoLst){var i=this.aliveBBXInfoLst[e];if(!i)return null;for(var n=0;n<t.length;n++)for(var r=(t[n],0);r<i.length;r++){var s=(i[r],Math.sqrt(Math.pow(i[r].a-t[n].a,2)+Math.pow(i[r].b-t[n].b,2)));if(i[r].r+t[n].r>s)return this.aliveFishLst[e]}}return null},i.prototype.clickFish=function(t){for(var e in this.aliveBBXInfoLst){var i=this.aliveBBXInfoLst[e];if(!i)return null;for(var n=0;n<i.length;n++){var r=Math.sqrt(Math.pow(i[n].a-t.x,2)+Math.pow(i[n].b-t.y,2));if(i[n].r>r)return this.aliveFishLst[e]}}return null},i.prototype.getAliveFishObjectLst=function(){return this.aliveFishLst},i.prototype.getAliveFish=function(t){return t?this.aliveFishLst[t]:null},i.prototype.getFishLevelLst=function(){var t=[];for(var e in this.aliveFishLst){var i=this.aliveFishLst[e];i&&i.getLockLevel()>0&&t.push(i)}return t.sort(function(t,e){return t.getLockLevel()-e.getLockLevel()}),t},i.prototype.getFishObjById=function(t){return this.aliveFishLst[t]},i.prototype.clearAllFish=function(){for(var e in this.aliveFishLst){var i=this.aliveFishLst[e];i&&i.getFishSceneId()!=t.FishMgr.BackgroundManager.getCurrentSceneId()&&-1!=i.getFishSceneId()&&(delete this.aliveFishLst[i.getObjId()],delete this.aliveBBXInfoLst[i.getObjId()],i.resumeOrgin())}},i.prototype.clearFishAll=function(){for(var t in this.aliveFishLst){var e=this.aliveFishLst[t];delete this.aliveFishLst[e.getObjId()],delete this.aliveBBXInfoLst[e.getObjId()],e.resumeOrgin()}},i}(BaseClass);t.FishManager=e,__reflect(e.prototype,"fish.FishManager")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.init(t),i}return __extends(i,e),i.prototype.init=function(e){this.dataId=e.id,this.objId=e.objId,this.setUseState(!1);var i=t.FishMgr.Config.Net[e.id],n=t.FishMgr.Config.Sprite[i.src_id];this.movieClipData=GameApp.getMovieDataByFileName(n.file,n.key),n.width&&n.height&&(this.width=n.width,this.height=n.height),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.touchEnabled=!1},i.prototype.resumeOrgin=function(){this.visible=!1,this.finishCall=null,this.x=0,this.y=0},i.prototype.startPlay=function(t){var e=this;this.setUseState(!0),this.visible=!0,this.parent&&(t=this.parent.globalToLocal(t.x,t.y)),this.x=t.x,this.y=t.y,this.addEventListener(egret.Event.COMPLETE,function(t){e.finishCall&&e.finishCall[0].apply(e.finishCall[1],[e])},this),this.gotoAndPlay("act")},i.prototype.setFinishCall=function(t,e){t&&e&&(this.finishCall=[t,e])},i.prototype.getDataId=function(){return this.dataId},i.prototype.getObjId=function(){return this.objId},i.prototype.setUseState=function(t){this.isUse=t},i.prototype.getUseState=function(){return this.isUse},i}(egret.MovieClip);t.FishNet=e,__reflect(e.prototype,"fish.FishNet")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.fishNetList=[],t}return __extends(i,e),i.prototype.init=function(t){this.parentObj=t,this.fishNetList=[]},i.prototype.destroy=function(){this.parentObj=null},i.prototype.preCreated=function(e){var i=new t.FishNet(e);return i},i.prototype.clear=function(){this.fishNetList.forEach(function(t){t.resumeOrgin(),t.setUseState(!1),t.parent&&t.parent.removeChild(t)}),this.fishNetList=[]},i.prototype.play=function(e){if(this.parentObj){var i=t.FishMgr.FishObjectPool.getObject(t.ObjectClassType.TypeNet,e.id);i&&(this.parentObj.addChild(i),i.setFinishCall(function(t){t.resumeOrgin(),t.setUseState(!1),t.parent&&t.parent.removeChild(t)},this),i.startPlay(e.pos),this.fishNetList.push(i))}},i}(BaseClass);t.FishNetManager=e,__reflect(e.prototype,"fish.FishNetManager")}(fish||(fish={}));var fish;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.objectClsssLst={},e.default_size=5,e}return __extends(e,t),e.prototype.init=function(){var t=this;Object.keys(i).filter(function(e){isNaN(Number(i[e]))&&(t.objectClsssLst[e]={objId:0,objLst:{},creater:null})})},e.prototype.destroy=function(){this.objectClsssLst={}},e.prototype.registerObjectCreater=function(t,e){var i=this.objectClsssLst[t];i&&(i.creater=e)},e.prototype.newSomeObject=function(t,e,i){var n=this.objectClsssLst[t];if(n&&n.creater)for(var r=0;i>r;r++){n.objId+=1;var s={objId:n.objId,id:e},o=n.creater,a=o.preCreated(s);n.objLst[n.objId]=a}},e.prototype.getObject=function(t,e){var i=null,n=this.objectClsssLst[t];if(n)for(var r in n.objLst){var s=n.objLst[r];if(s&&!s.getUseState()&&s.getDataId()==e){i=s;break}}return i||(this.newSomeObject(t,e,this.default_size),n=this.objectClsssLst[t],n&&(i=n.objLst[n.objId])),i},e}(BaseClass);t.FishObjectPool=e,__reflect(e.prototype,"fish.FishObjectPool");var i;!function(t){t[t.TypeFish=1]="TypeFish",t[t.TypeBullet=2]="TypeBullet",t[t.TypeNet=3]="TypeNet",t[t.TypeGold=4]="TypeGold",t[t.TypeLabel=5]="TypeLabel"}(i=t.ObjectClassType||(t.ObjectClassType={}))}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.info={side:0,seatId:0,isLocal:!1,offsetPos:0,bulletOffset:0,key:""},i.startPos={x:0,y:0},i.block=!1,i.isLockSuccess=!1,i.lockFishLst=[],i.curLockIdx=0,i.curLockObjId=-1,i.lockItemDis=30,i.curLockAngle=0,i.lockCall=null,i.isLockChange=!1,i.isForceLock=!1,i.frontForceLockObjId=-1,i.lineWidth=32,i.lastWidth=32,i.lockLineItems=[],i.touchEnabled=!1,i.height=1080,i.width=1920,i.info=t,i.touchEnabled=!1,i.initData(),i}return __extends(i,e),i.prototype.initData=function(){this.startPos={x:0,y:0},this.block=!1,this.isLockSuccess=!1,this.lockFishLst=[],this.curLockIdx=0,this.curLockObjId=-1,this.lockItemDis=30,this.curLockAngle=0,this.lockCall=null,this.isLockChange=!1,this.isForceLock=!1,this.frontForceLockObjId=-1,this.lastItem=new eui.Image,this.lastItem.texture=RES.getRes(this.info.key),this.lastItem.anchorOffsetX=this.lastItem.width/2,this.lastItem.anchorOffsetY=this.lastItem.height/2,this.lastItem.visible=!1,this.addChild(this.lastItem),this.lastWidth=this.lastItem.width,this.lineTexture=RES.getRes(this.info.key+"_1"),this.lineWidth=this.lineTexture.textureWidth,this.lockLineItems=[]},i.prototype.lock=function(){if(this.block=!0,this.isLockChange=!1,this.isForceLock=!1,this.frontForceLockObjId=-1,this.lockFishLst.length>0){this.curLockIdx+=1,this.curLockIdx>this.lockFishLst.length&&(this.curLockIdx=-1);var t=this.lockFishLst[this.curLockIdx];t&&(this.curLockObjId=t.getObjId()),this.lockCall&&this.lockCall()}},i.prototype.setLockFish=function(t){this.info.isLocal||(this.block=!0),this.block&&-1!=t&&(this.isLockSuccess=!0,this.curLockObjId=t)},i.prototype.forceToLockFish=function(t){this.info.isLocal&&t&&-1!=t&&(this.block=!0,this.isForceLock=!0,this.frontForceLockObjId=this.curLockObjId,this.curLockObjId=t,this.isLockSuccess=!0)},i.prototype.resetLockLst=function(t){this.lockFishLst=t,(!this.lockFishLst||this.lockFishLst.length<=0)&&(this.lockFishLst=[])},i.prototype.unlock=function(){this.curLockIdx=0,this.curLockObjId=-1,this.isForceLock=!1,this.frontForceLockObjId=-1,this.block=!1,this.isLockSuccess=!1,this.lastItem.visible=!1,this.curLockAngle=0,this.lockLineItems.forEach(function(t){t.visible=!1})},i.prototype.selectLockFish=function(){if(this.isForceLock&&this.info.isLocal){var e=t.FishMgr.FishManager.getFishObjById(this.curLockObjId);return e&&this.isFishCanLock(e)?(this.isLockSuccess=!0,this.lockCall&&this.frontForceLockObjId!=this.curLockObjId&&-1!=this.curLockObjId&&(this.frontForceLockObjId=this.curLockObjId,this.isLockChange=!0,this.lockCall(this.curLockObjId)),e):(this.isLockSuccess=!1,null)}if(!this.info.isLocal){var e=t.FishMgr.FishManager.getFishObjById(this.curLockObjId);return this.isFishCanLock(e)?(this.isLockSuccess=!0,this.isLockChange=!0,e):(this.isLockSuccess=!1,null)}for(var i=-1,n=0;n<this.lockFishLst.length;n++){var r=this.lockFishLst[n];if(this.curLockObjId==r.getObjId()&&this.isFishCanLock(r))return this.isLockChange=!0,r;if(this.isFishCanLock(r)&&-1==i){i=n;break}}return-1==i?(this.curLockIdx=0,this.curLockObjId=-1,this.isLockSuccess=!1,this.isLockChange=!1):(this.curLockIdx=i,this.curLockObjId=this.lockFishLst[this.curLockIdx].getObjId(),this.lockCall&&this.lockCall(this.curLockObjId),this.isLockChange=!0,this.isLockSuccess=!0),this.lockFishLst[this.curLockIdx]},i.prototype.isFishCanLock=function(e){if(e){var i=e.getCurrentPos(),n=t.FishMgr.BatteryManager.getBatteryBySeatId(this.info.seatId),r=n.getSendBulletPos();r=this.globalToLocal(r.x,r.y),i=this.globalToLocal(i.x,i.y);var s=new egret.Rectangle(0,0,1920,1080);if(s.contains(i.x,i.y)&&this.isPosValid(this.info.side,r,i))return!0}return!1},i.prototype.isPosValid=function(t,e,i){var n=this.getRotationAngle(e,i,t),r=!1;return 1==t&&(n>=90&&90>=n||n>=270&&360>=n)&&e.x<i.x?r=!0:2==t&&n>=90&&90>=n&&e.x>i.x?r=!0:3==t&&n>=0&&180>=n&&i.y>e.y?r=!0:4==t&&n>=180&&360>=n&&i.y<e.y&&(r=!0),r},i.prototype.getRotationAngle=function(t,e,i){var n=0;if(t.x==e.x)1==i&&t.y>=e.y?n=90:1==i&&t.y<e.y?n=270:2==i&&t.y>=e.y?n=90:2==i&&t.y<e.y?n=270:3==i?n=270:4==i&&(n=90);else{var r=(t.y-e.y)/(t.x-e.x);n=180*Math.atan(r)/Math.PI,1==i&&0>=n?n=360+n:2==i?n=180+n:3==i&&0>=n?n=180+n:3==i&&n>0?n=n:4==i&&0>=n?n=360+n:4==i&&n>0&&(n=180+n)}return n},i.prototype.update=function(e){if(this.block){var i=this.selectLockFish();if(i&&this.isLockSuccess){var n=t.FishMgr.BatteryManager.getBatteryBySeatId(this.info.seatId);if(n){var r=GameApp.clone(n.getBarrelPos());this.startPos=this.globalToLocal(r.x,r.y)}var s=GameApp.clone(i.getCurrentPos()),o=this.globalToLocal(s.x,s.y);this.resetLockLineByPos(this.startPos,o)}else this.lockLineItems.forEach(function(t){t.visible=!1}),this.lastItem.visible=!1,this.isForceLock&&this.info.isLocal&&(this.isForceLock=!1,this.block=!1,this.isLockSuccess=!1)}},i.prototype.resetLockLineByPos=function(t,e){var i=this.getRotationAngle(t,e,this.info.side),n=App.MathUtils.getDistanceByPoint(t,e);n=n-(this.lineWidth+this.lastWidth)-this.info.bulletOffset;for(var r=0,s=0,o=this.lockLineItems.length,a=2*this.lineWidth+this.lockItemDis,h=0;o>h;h++){if(s=h*a,s>=n){r=h;break}var c=h*a+this.info.bulletOffset,l=this.getPosByDistanceAndAngle(c,i);this.lockLineItems[h].x=l.x,this.lockLineItems[h].y=l.y,this.lockLineItems[h].visible=!0}for(;n>s;){var p=new eui.Image;p.texture=this.lineTexture,p.anchorOffsetX=p.width/2,p.anchorOffsetY=p.height/2;var l=this.getPosByDistanceAndAngle(s,i);s+=a,p.x=l.x,p.y=l.y,p.visible=!0,p.touchEnabled=!1,this.lockLineItems.push(p),this.addChild(p),r++}this.lastItem.x=e.x,this.lastItem.y=e.y,this.lastItem.visible=!0;
for(var h=r;h<this.lockLineItems.length;h++)this.lockLineItems[h].visible=!1;this.curLockAngle=i},i.prototype.getPosByDistanceAndAngle=function(t,e){var i=t*Math.cos(e/180*Math.PI),n=t*Math.sin(e/180*Math.PI);return{x:this.startPos.x+i,y:this.startPos.y+n}},i.prototype.getLockState=function(){return this.block&&this.isLockSuccess},i.prototype.getCurrentLockFishId=function(){return this.getLockState()?this.curLockObjId:-1},i.prototype.getCurrentLockAngle=function(){return this.curLockAngle},i.prototype.setLockCall=function(t){this.lockCall=t},i.prototype.onDestroy=function(){this.lockLineItems.forEach(function(t){t.parent&&t.parent.removeChild(t)}),this.parent&&this.parent.removeChild(this)},i}(eui.Group);t.LockFish=e,__reflect(e.prototype,"fish.LockFish")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.timeOnEnterFrame=0,t.allMusicLst=[],t}return __extends(i,e),i.prototype.destroy=function(){egret.stopTick(this.update,this),this.timeOnEnterFrame=0,this.allMusicLst=[]},i.prototype.init=function(){this.timeOnEnterFrame=egret.getTimer(),egret.startTick(this.update,this)},i.prototype.stopAllMusicEffect=function(){this.allMusicLst=[]},i.prototype.play=function(e){if(e&&-1!=e){var i=t.FishMgr.Config.Music[e],n=this.analyze(i);n.lst.length>0&&this.allMusicLst.push(n)}},i.prototype.analyze=function(t){var e={id:t.id,lst:[]};if(t){var i=t.mus_lst,n=0,r={curAddTime:0,curPlayIndex:0,dataLst:[],playCmp:!1};e.lst.push(r);for(var s=i.length,o=0;s>o;o++)if(e.lst[n].dataLst.push(i[o]),-1==i[o].nxt_id&&s>o){var a={curAddTime:0,curPlayIndex:0,dataLst:[],playCmp:!1};e.lst.push(a),n=e.lst.length-1}}return e},i.prototype.update=function(e){var i=e-this.timeOnEnterFrame;this.timeOnEnterFrame=e;for(var n=0;n<this.allMusicLst.length;n++){for(var r=this.allMusicLst[n],s=!0,o=0;o<r.lst.length;o++){var a=r.lst[o];if(0==a.playCmp){s=!1;break}}if(s){this.allMusicLst.splice(n,1);break}}return this.allMusicLst.forEach(function(e){e.lst.forEach(function(e){if(e.curPlayIndex<e.dataLst.length)if(e.curAddTime>=e.dataLst[e.curPlayIndex].t){var n=e.dataLst[e.curPlayIndex],r=t.FishMgr.Config.Sound[n.src_id],s=n.loop;s?App.SoundManager.playEffect(r.file,0):App.SoundManager.playEffect(r.file),e.curAddTime=0,e.curPlayIndex++}else e.curAddTime+=i;else e.playCmp=!0})}),!0},i}(BaseClass);t.MusicManager=e,__reflect(e.prototype,"fish.MusicManager")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.init(t),i}return __extends(i,e),i.prototype.init=function(t){this.info=t,this.createItem(),this.touchEnabled=!1},i.prototype.createItem=function(){var e=t.FishMgr.Config.Skill[this.info.id];if(e){var i=t.FishMgr.Config.Sprite[e.bk_src_id];if(1==i.stype){var n=GameApp.getClipByFileName(i.file,i.key);n.anchorOffsetX=.5*n.width,n.anchorOffsetY=.5*n.width,this.addChild(n),n.touchEnabled=!1,-1==e.floop?n.gotoAndPlay("act",-1):n.gotoAndPlay("act",e.floop)}else 2==i.stype&&(this.img=new eui.Image(i.file),this.img.verticalCenter=0,this.img.horizontalCenter=0,this.img.touchEnabled=!1,this.addChild(this.img));this.width=this.img.width,this.height=this.img.height,this.anchorOffsetX=.5*this.width,this.anchorOffsetY=.5*this.height,this.label=new eui.BitmapLabel(this.info.score),this.label.font=RES.getRes(e.score_fnt_src),this.label.verticalCenter=0,this.label.horizontalCenter=0,this.label.touchEnabled=!1,this.addChild(this.label),this.info.parent.addChild(this);var r=egret.Tween.get(this,{loop:!0});r.to({rotation:60},600).to({rotation:0},600),App.TimerManager.doTimer(3600,1,function(){},this,function(){this.parent&&this.parent.removeChild(this)},this)}var s=this.info.parent;s&&(1==s.getCusSkin()?(this.x=450,this.y=0):(this.x=150,this.y=0))},i}(eui.Group);t.RotateScore=e,__reflect(e.prototype,"fish.RotateScore")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.info=t,i.runLine(),i}return __extends(i,e),i.prototype.runLine=function(){var e=t.FishMgr.Config.Sprite[this.info.src_id];e&&(this.movieClipData=GameApp.getMovieDataByFileName(e.file,e.key)),this.info.parent.addChild(this),this.setPosAndRotate()},i.prototype.setPosAndRotate=function(){this.x=this.info.pos1.x,this.y=this.info.pos1.y,this.anchorOffsetY=this.height/2;var t=App.MathUtils.getDistanceByPoint(this.info.pos1,this.info.pos2),e=t/this.width;this.scaleX=e;var i=this.getAngleByPos(this.info.pos1,this.info.pos2);this.rotation=i,this.gotoAndPlay("act",-1),egret.Tween.get(this).wait(1e3).call(function(){this.parent&&this.parent.removeChild(this)},this)},i.prototype.getAngleByPos=function(t,e){var i=0,n=this.getSideByPos(t,e);if(t.x==e.x)1==n?i=90:4==n?i=270:2==n?i=90:3==n&&(i=270);else{var r=(t.y-e.y)/(t.x-e.x);i=180*Math.atan(r)/Math.PI}return 1==n&&0>=i?i=-i:2==n&&0>i?i=180+i:3==n&&i>0?i=180+i:3==n&&0>=i?i=180-i:4==n&&0>=i&&(i=360+i),i},i.prototype.getSideByPos=function(t,e){var i=0,n={x:e.x-t.x,y:e.y-t.y};return n.x>=0&&n.y>=0?i=1:n.x>=0&&n.y<=0?i=4:n.x<=0&&n.y>=0?i=2:n.x<=0&&n.y<=0&&(i=3),i},i}(egret.MovieClip);t.SkillItemLine=e,__reflect(e.prototype,"fish.SkillItemLine")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.init=function(t){this.skillFuncLst=[],this.onShakeFunc=t,this.skillFuncLst.push({func:this.shakeScreen,skillIdLst:[1]}),this.skillFuncLst.push({func:this.rotateScore,skillIdLst:[2]}),this.skillFuncLst.push({func:this.lineFish,skillIdLst:[3]}),this.skillFuncLst.push({func:null,skillIdLst:[4]}),this.skillFuncLst.push({func:this.bigFishBom,skillIdLst:[5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]})},i.prototype.destroy=function(){this.skillFuncLst=[],this.onShakeFunc=null},i.prototype.play=function(t,e){for(var i=0;i<this.skillFuncLst.length;i++)for(var n=this.skillFuncLst[i],r=0;r<n.skillIdLst.length;r++)if(e==n.skillIdLst[r]&&n.func)return n.func(t,e),!0;return!1},i.prototype.shakeScreen=function(e,i){var n=t.FishMgr.Config.Skill[i];n&&t.FishMgr.SkillManager.onShakeFunc&&t.FishMgr.SkillManager.onShakeFunc()},i.prototype.rotateScore=function(e,i){var n=e.getShotSeatId(),r=t.FishMgr.BatteryManager.getBatteryBySeatId(n);if(n){var s={id:i,parent:r,pos:t.FishMgr.Config.System.rotate_score_pos,score:e.getFishScore()};new t.RotateScore(s)}},i.prototype.lineFish=function(e,i){for(var n=e.getCurrentPos(),r=e.getLineRelObjLst(),s=t.FishMgr.Config.Skill[i],o=0;o<r.length;o++){var a=r[o].getCurrentPos(),h={pos1:n,pos2:a,parent:e.parent,src_id:s.line_src_id},c=new t.SkillItemLine(h);r[o].setCurrentLineObj(c)}},i.prototype.bigFishBom=function(e,i){for(var n=(e.getCurrentPos(),t.FishMgr.Config.Skill[i]),r=0;r<n.src_id_lst.length;r++);},i}(BaseClass);t.SkillManager=e,__reflect(e.prototype,"fish.SkillManager")}(fish||(fish={}));var jcby;!function(t){var e=function(){function t(){}return t.send_ReqEnterGameHall=function(){var e={id:t.c2s_jc_ReqEnterGameHall_msg};App.Socket.send(e,function(t,i){App.EasyLoading.hideLoading(),t==e.id?(GameApp.PlayerInfo.myRoomTypeInfo=i.roomTypes,GameApp.PlayerInfo.curGameID=9,GameApp.HomeManager.resEnterGameHall("金蟾捕鱼")):PlayerManager.resCommonMsg(i)},this)},t.send_ReqEnterRoom=function(t){},t.send_ReqFastEnterTable=function(e){var i={id:t.c2s_jc_ReqFastEnterTable_msg,roomId:e};App.Socket.send(i,function(t,e){t==i.id?e.mems?(e.mems.forEach(function(t){var e={playerId:t.playerId,seatId:t.order+1,isLocal:GameApp.PlayerInfo.isMySelf(t.playerId),chips:t.chips};e.isLocal&&(fish.FishMgr.seatId=e.seatId),fish.FishMgr.fishModel.addUserInfo(e.seatId,e)}),fish.FishMgr.start("jc")):App.SceneManager.runScene(SceneConsts.Login):PlayerManager.resCommonMsg(e)},this)},t.send_ReqFire=function(e){var i={id:t.c2s_jc_ReqFire_msg,angle:e};App.Socket.send(i,function(t,e){t==i.id||egret.log("开炮失败")},this)},t.send_ReqSwitchBattery=function(e){var i={id:t.c2s_jc_ReqSwitchBattery_msg,type:e};App.Socket.send(i,function(t,e){t==i.id||egret.log("切换炮台失败")},this)},t.send_ReqHitFish=function(e,i,n){var r={id:t.c2s_jc_ReqHitFish_msg,playerId:e,bulletId:i,fishId:n};App.Socket.send(r,function(t,e){t==r.id||egret.log("打中鱼失败")},this)},t.send_ReqExitRoom=function(){var e={id:t.c2s_jc_ReqExitRoom_msg};App.Socket.send(e,function(t,i){t==e.id||GameApp.PromotManager.floatingTip(i.errorCode)},this)},t.send_ReqExitTable=function(){var e={id:t.c2s_jc_ReqExitTable_msg};App.Socket.send(e,function(t,i){t==e.id?(GameApp.HomeManager.reqExitCurGameRoom(),LoginMgr.start()):GameApp.PromotManager.floatingTip(i.errorCode)},this)},t.send_ReqScene=function(){var e={id:t.c2s_jc_ReqScence_msg};App.Socket.send(e,function(t,i){t==e.id?(fish.FishMgr.fishModel.isEnterScene=!0,App.ControllerManager.applyFunc(ControllerConst.FishMain,fish.FishResConst.ResEnterScene,i)):GameApp.PromotManager.floatingTip(i.errorCode)},this)},t.send_ReqLockFish=function(e,i){var n={id:t.c2s_jc_ReqLockFish_msg,fishId:e,angle:i};App.Socket.send(n,function(t,r){t==n.id||egret.log("锁定鱼失败",e,i)},this)},t.send_ReqCancelLockFish=function(){var e={id:t.c2s_jc_ReqCancelLockFish_msg};App.Socket.send(e,function(t,i){t==e.id||egret.log("取消锁定鱼失败")},this)},t.send_ReqBackTable=function(){var e={id:t.c2s_jc_ReqBackTable_msg};App.Socket.send(e,function(t,i){t==e.id?App.ControllerManager.applyFunc(ControllerConst.FishMain,fish.FishResConst.ResBackTable,i):LoginMgr.start()},this)},t.send_ReqExchangeChips=function(e){var i={id:t.c2s_jc_ReqExchangeChips_msg,gold:e};App.Socket.send(i,function(t,e){t==i.id||GameApp.PromotManager.floatingTip(e.errorCode)},this)},t.send_ReqExchangeGolds=function(e){var i={id:t.c2s_jc_ReqExchangeGold_msg,chips:e};App.Socket.send(i,function(t,e){t==i.id||GameApp.PromotManager.floatingTip(e.errorCode)},this)},t.setRoomInfo=function(t){fish.FishMgr.setRoomInfo(t)},t.pauseGame=function(){if(App.ViewManager.isShow(ViewConst.FishMain)){var t=App.ViewManager.getView(ViewConst.FishMain);t&&t.pauseGame(!0)}},t.loadScene=function(){fish.FishMgr.fishModel.backRoom=!0,App.ViewManager.isShow(ViewConst.FishMain)?t.send_ReqBackTable():fish.FishMgr.start("jc")},t.registerCommonReq=function(){GameApp.HomeManager.registerModuleReq(9,CommonReq.SetRoomInfo,t.setRoomInfo,t),GameApp.HomeManager.registerModuleReq(9,CommonReq.LoadGameScene,t.loadScene,t),GameApp.HomeManager.registerModuleReq(9,CommonReq.ReqEnterCurGame,t.send_ReqEnterGameHall,t),GameApp.HomeManager.registerModuleReq(9,CommonReq.ReqEnterCurGameRoom,t.send_ReqEnterRoom,t),GameApp.HomeManager.registerModuleReq(9,CommonReq.ReqExitCurGameRoom,t.send_ReqExitRoom,t),GameApp.HomeManager.registerModuleReq(9,CommonReq.ReqQuickEnterCurGame,t.send_ReqFastEnterTable,t),GameApp.HomeManager.registerModuleReq(9,CommonReq.ReqExitCurGameTable,t.send_ReqExitTable,t),GameApp.HomeManager.registerModuleReq(9,CommonReq.PauseGame,t.pauseGame,t)},t.removeCommonReq=function(){GameApp.HomeManager.removeModuleReq(9)},t.c2s_jc_ReqEnterGameHall_msg=5401,t.c2s_jc_ReqFire_msg=5406,t.c2s_jc_ReqSwitchBattery_msg=5407,t.c2s_jc_ReqHitFish_msg=5408,t.c2s_jc_ReqExitRoom_msg=5409,t.c2s_jc_ReqExitTable_msg=5410,t.c2s_jc_ReqScence_msg=5411,t.c2s_jc_ReqLockFish_msg=5412,t.c2s_jc_ReqCancelLockFish_msg=5413,t.c2s_jc_ReqBackTable_msg=5414,t.c2s_jc_ReqExchangeGold_msg=5415,t.c2s_jc_ReqExchangeChips_msg=5416,t.c2s_jc_ReqFastEnterTable_msg=5417,t}();t.FishReq=e,__reflect(e.prototype,"jcby.FishReq")}(jcby||(jcby={}));var jcby;!function(t){var e=function(){function t(){}return t.rec_ResOtherEnterTable=function(t){if(fish.FishMgr.isEnterScene())App.ControllerManager.applyFunc(ControllerConst.FishMain,fish.FishResConst.ResOtherEnterTable,t.mem,t.battery);else{var e={playerId:t.mem.playerId,seatId:t.mem.order+1,isLocal:GameApp.PlayerInfo.isMySelf(t.mem.playerId),chips:t.mem.chips};fish.FishMgr.fishModel.addUserInfo(e.seatId,e)}},t.rec_ResChipsChange=function(t){fish.FishMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.FishMain,fish.FishResConst.ResChangeChips,t)},t.rec_ResFire=function(t){fish.FishMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.FishMain,fish.FishResConst.ResFire,t)},t.rec_ResSwitchBattery=function(t){fish.FishMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.FishMain,fish.FishResConst.ResSwitchBattery,t.battery)},t.rec_ResHitFish=function(t){fish.FishMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.FishMain,fish.FishResConst.ResHitFish,t)},t.rec_ResExitTable=function(t){fish.FishMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.FishMain,fish.FishResConst.ResExitTable,t)},t.rec_ResLockFish=function(t){fish.FishMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.FishMain,fish.FishResConst.ResLockFish,t)},t.rec_ResCancelLockFish=function(t){fish.FishMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.FishMain,fish.FishResConst.ResCancelLockFish,t)},t.rec_ResInsteadPlayersUpgrade=function(t){fish.FishMgr.fishModel.instatdSendPlayerLst=t.insteadPlayers,fish.FishMgr.isEnterScene()},t.rec_ResProductFish=function(t){fish.FishMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.FishMain,fish.FishResConst.ResProductFish,t)},t.rec_ResScence=function(t){fish.FishMgr.isEnterScene()&&App.ControllerManager.applyFunc(ControllerConst.FishMain,fish.FishResConst.ResScence,t)},t.registerResListener=function(){App.MessageCenter.addListener(t.s2c_jc_ResOtherEnterTable_msg,t.rec_ResOtherEnterTable,t),App.MessageCenter.addListener(t.s2c_jc_ResChangeChips_msg,t.rec_ResChipsChange,t),App.MessageCenter.addListener(t.s2c_jc_ResFire_msg,t.rec_ResFire,t),App.MessageCenter.addListener(t.s2c_jc_ResSwitchBattery_msg,t.rec_ResSwitchBattery,t),App.MessageCenter.addListener(t.s2c_jc_ResHitFish_msg,t.rec_ResHitFish,t),App.MessageCenter.addListener(t.s2c_jc_ResExitTable_msg,t.rec_ResExitTable,t),App.MessageCenter.addListener(t.s2c_jc_ResLockFish_msg,t.rec_ResLockFish,t),App.MessageCenter.addListener(t.s2c_jc_ResCancelLockFish_msg,t.rec_ResCancelLockFish,t),App.MessageCenter.addListener(t.s2c_jc_ResInsteadPlayersUpgrade_msg,t.rec_ResInsteadPlayersUpgrade,t),App.MessageCenter.addListener(t.s2c_jc_ResProductFish_msg,t.rec_ResProductFish,t),App.MessageCenter.addListener(t.s2c_jc_ResScence_msg,t.rec_ResScence,t)},t.removeResListener=function(){App.MessageCenter.removeAll(t)},t.s2c_jc_ResOtherEnterTable_msg="5451",t.s2c_jc_ResChangeChips_msg="5452",t.s2c_jc_ResFire_msg="5453",t.s2c_jc_ResSwitchBattery_msg="5454",t.s2c_jc_ResHitFish_msg="5455",t.s2c_jc_ResExitTable_msg="5456",t.s2c_jc_ResLockFish_msg="5457",t.s2c_jc_ResCancelLockFish_msg="5458",t.s2c_jc_ResInsteadPlayersUpgrade_msg="5459",t.s2c_jc_ResProductFish_msg="5461",t.s2c_jc_ResScence_msg="5462",t}();t.FishRes=e,__reflect(e.prototype,"jcby.FishRes")}(jcby||(jcby={}));var fish;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.loadingView=new t.FishLoadingView(i,LayerManager.UI_Main),App.ViewManager.register(ViewConst.FishLoad,i.loadingView),i.registerFunc(ControllerConst.FishLoad,i.setProgress,i),i}return __extends(i,e),i.prototype.setProgress=function(t,e){this.loadingView.setProgress(t,e)},i}(BaseController);t.FishLoadingController=e,__reflect(e.prototype,"fish.FishLoadingController")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.loadingBgRes=function(){return t.FishMgr.fishModule+"_fish_loading_json.loadingbg"},i.prototype.fillBgRes=function(){return t.FishMgr.fishModule+"_fish_loading_json.loadbg"},i.prototype.fillRes=function(){return t.FishMgr.fishModule+"_fish_loading_json.loadt"},i}(BaseLoadingView);t.FishLoadingView=e,__reflect(e.prototype,"fish.FishLoadingView")}(fish||(fish={}));var fish;!function(t){var e;!function(t){t[t.ResEnterGame=1000001]="ResEnterGame",t[t.SetRoomInfo=1000002]="SetRoomInfo",t[t.LoadScene=1000003]="LoadScene",t[t.ResEnterTable=1000004]="ResEnterTable",t[t.ResBackTable=1000005]="ResBackTable",t[t.ResEnterScene=1000006]="ResEnterScene",t[t.ResOtherEnterTable=1000007]="ResOtherEnterTable",t[t.ResChangeChips=1000008]="ResChangeChips",t[t.ResFire=1000009]="ResFire",t[t.ResSwitchBattery=1000010]="ResSwitchBattery",t[t.ResHitFish=1000011]="ResHitFish",t[t.ResExitTable=1000012]="ResExitTable",t[t.ResLockFish=1000013]="ResLockFish",t[t.ResCancelLockFish=1000014]="ResCancelLockFish",t[t.ResInsteadPlayersUpgrade=1000015]="ResInsteadPlayersUpgrade",t[t.ResProductFish=1000016]="ResProductFish",t[t.ResScence=1000017]="ResScence"}(e=t.FishResConst||(t.FishResConst={}))}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.mainView=new t.FishMainView(i,LayerManager.UI_Main),App.ViewManager.register(ViewConst.FishMain,i.mainView),i._registerFunc(),i}return __extends(i,e),i.prototype._registerFunc=function(){var e=this;this.registerFunc(t.FishResConst.ResBackTable,this.backTable,this),this.registerFunc(t.FishResConst.ResEnterScene,this.enterScene,this),this.registerFunc(t.FishResConst.ResOtherEnterTable,this.otherEnterTable,this),this.registerFunc(t.FishResConst.ResChangeChips,function(i){var n={seatId:i.order+1,chips:i.chips};e.mainView.updateChips(n);var r=t.FishMgr.fishModel.getUserInfo(n.seatId);r&&-1!=r.playerId&&(r.chips=n.chips)},this),this.registerFunc(t.FishResConst.ResFire,function(t){var i={seatId:t.order+1,bulletId:t.bulletId,angle:t.angle,playerId:t.playerId};e.mainView.fire(i)},this),this.registerFunc(t.FishResConst.ResSwitchBattery,this.updateBattery,this),this.registerFunc(t.FishResConst.ResHitFish,function(t){var i={seatId:t.order+1,dies:t.dies};e.mainView.fishsDead(i)},this),this.registerFunc(t.FishResConst.ResExitTable,this.exitTable,this),this.registerFunc(t.FishResConst.ResLockFish,function(t){var i={seatId:t.order+1,fishId:t.fishId};e.mainView.setLockFish(i)},this),this.registerFunc(t.FishResConst.ResCancelLockFish,function(t){e.mainView.unLockFish(t.order+1)},this),this.registerFunc(t.FishResConst.ResInsteadPlayersUpgrade,function(e){t.FishMgr.fishModel.instatdSendPlayerLst=e.insteadPlayers},this),this.registerFunc(t.FishResConst.ResProductFish,function(t){e.mainView.addFish(t.fishs)},this),this.registerFunc(t.FishResConst.ResScence,function(t){e.mainView.switchScene(t.scene)},this)},i.prototype.enterScene=function(e){var i=this;e.fishs.forEach(function(t){t.angle>0&&(t.angle=360-t.angler)}),this.mainView.addFish(e.fishs),this.mainView.enterScene(e.scenceId),e.batterys.forEach(function(t){i.updateBattery(t)}),t.FishMgr.fishModel.instatdSendPlayerLst=e.insteadPlayers},i.prototype.otherEnterTable=function(e,i){var n={playerId:i.playerId,seatId:i.order+1,isLocal:GameApp.PlayerInfo.isMySelf(i.playerId),chips:e.chips};t.FishMgr.fishModel.addUserInfo(n.seatId,n),this.mainView.setOtherPlayerUserInfo(n),this.updateBattery(i)},i.prototype.exitTable=function(e){if(!App.ViewManager.isShow(ViewConst.Home)){var i={seatId:e.order+1,playerId:e.playerId};t.FishMgr.fishModel.getUserInfo(i.seatId).isLocal||(t.FishMgr.fishModel.resetUserInfo(i.seatId),this.mainView.removeSeat(i))}},i.prototype.updateBattery=function(t){var e={seatId:t.order+1,num:t.num,score:t.score,power:t.power};this.mainView.updateBattery(e)},i.prototype.backTable=function(e){if(e.room&&e.mems){var i=t.FishMgr.Config.BatteryPos;for(var n in i)t.FishMgr.fishModel.addUserInfo(n,{playerId:-1,seatId:-1,isLocal:!1,chips:0});t.FishMgr.fishModel.removeAllUserInfo(),e.mems.forEach(function(e){var i={playerId:e.playerId,seatId:e.order+1,isLocal:GameApp.PlayerInfo.isMySelf(e.playerId),chips:e.chips};i.isLocal&&(t.FishMgr.seatId=i.seatId),t.FishMgr.fishModel.addUserInfo(i.seatId,i)}),t.FishMgr.fishModel.roomInfo=e.room,t.FishMgr.fishModel.gameInfo=e.gameInfo,this.mainView.rebackTable()}else this.mainView.finish(),LoginMgr.start()},i}(BaseController);t.FishMainSceneController=e,__reflect(e.prototype,"fish.FishMainSceneController")}(fish||(fish={}));var fish;!function(t){var e=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n.autoExitTime=30,n.autoExitTimeSum=0,n.autoExit=!1,n.isTimeout=!1,n.isRightPlaying=!1,n.skinName="resource/skins/fish/FishMainSkin.exml",n}return __extends(i,e),i.prototype.initUI=function(){e.prototype.initUI.call(this),this.registerEvent(),this.timeOnEnterFrame=egret.getTimer()},i.prototype.initData=function(){e.prototype.initData.call(this),this.groupLongTimeNoSend.visible=!1,t.FishMgr.BackgroundManager.init(this.groupBackground,this.groupWater),t.FishMgr.FishLabelManager.init(this.groupBullet),t.FishMgr.FishNetManager.init(this.groupBullet),t.FishMgr.MusicManager.init(),t.FishMgr.FishGoldManager.init(this),t.FishMgr.FishObjectPool.init(),t.FishMgr.BulletManager.init(this.groupBullet),t.FishMgr.BatteryManager.init(this.groupBattery,this.groupLock),t.FishMgr.FishManager.init(this.groupFish);var i=this;t.FishMgr.SkillManager.init(function(){for(var t=egret.Tween.get(i),e=0;40>e;e++)e%2==0?t.to({x:i.x+5,y:i.y+5},50,egret.Ease.bounceOut):t.to({x:i.x-5,y:i.y-5},50,egret.Ease.bounceIn),39==e&&t.to({x:0,y:0},50,egret.Ease.bounceIn)}),t.FishMgr.CollisionManager.registerCallback(this.onShotCallback,this),this.preCreate(),egret.startTick(this.update,this),t.FishMgr.fishModel.backRoom?t.FishReq.send_ReqBackTable():t.FishReq.send_ReqScene(),this.visible=!1},i.prototype.preCreate=function(){t.FishMgr.FishObjectPool.registerObjectCreater(t.ObjectClassType.TypeBullet,t.FishMgr.BulletManager);var e=t.FishMgr.Config.Bullet;for(var i in e)t.FishMgr.FishObjectPool.newSomeObject(t.ObjectClassType.TypeBullet,i,50);t.FishMgr.FishObjectPool.registerObjectCreater(t.ObjectClassType.TypeGold,t.FishMgr.FishGoldManager);var n=t.FishMgr.Config.FishGold;for(var i in n)t.FishMgr.FishObjectPool.newSomeObject(t.ObjectClassType.TypeGold,i,20);t.FishMgr.FishObjectPool.registerObjectCreater(t.ObjectClassType.TypeNet,t.FishMgr.FishNetManager);var r=t.FishMgr.Config.Net;for(var i in r)t.FishMgr.FishObjectPool.newSomeObject(t.ObjectClassType.TypeNet,i,20);t.FishMgr.FishObjectPool.registerObjectCreater(t.ObjectClassType.TypeLabel,t.FishMgr.FishLabelManager);var s=t.FishMgr.Config.LabelFnt;for(var i in s)t.FishMgr.FishObjectPool.newSomeObject(t.ObjectClassType.TypeLabel,i,20);t.FishMgr.FishObjectPool.registerObjectCreater(t.ObjectClassType.TypeFish,t.FishMgr.FishManager);var o=t.FishMgr.Config.Fish;for(var i in o)t.FishMgr.FishObjectPool.newSomeObject(t.ObjectClassType.TypeFish,i,20)},i.prototype.registerEvent=function(){var e=this;this.exchangeView.hide(),this.exchangeView.registerEvent(function(e,i){switch(e){case game.ExchangeType.CashIn:t.FishReq.send_ReqExchangeChip(game.ExchangeType.CashIn,i);break;case game.ExchangeType.CashOut:t.FishReq.send_ReqExchangeChip(game.ExchangeType.CashOut,i)}},this),this.setView.show(!1),this.setView.registerEvent(function(){t.FishMgr.BackgroundManager.playBkMusic()},this),this.btnLeft.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.btnRight.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.btnHelp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.btnSet.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.btnExit.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.btnExchange.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.groupBattery.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.tgLock.addEventListener(eui.UIEvent.CHANGE,function(i){var n=t.FishMgr.BatteryManager.getMyBattery();n&&n.setAutoLockFish(i.target.selected),i.target.selected&&(e.tgAuto.selected=!1)},this),this.tgAuto.addEventListener(eui.UIEvent.CHANGE,function(i){var n=t.FishMgr.BatteryManager.getMyBattery();n&&(n.setAutoFire(i.target.selected),0==i.target.selected&&t.FishReq.send_ReqCancelLockFish()),i.target.selected&&(e.tgLock.selected=!1)},this)},i.prototype.onClickHandler=function(e){switch(e.target){case this.btnLeft:if(this.isRightPlaying)return;this.isRightPlaying=!0,egret.Tween.get(this.groupRight).to({right:0},500).call(function(){this.btnLeft.visible=!1,this.btnRight.visible=!0,this.isRightPlaying=!1},this);break;case this.btnRight:this.hideOpBtn();break;case this.btnHelp:this.groupHelp.visible=!0,this.hideOpBtn();break;case this.btnSet:this.hideOpBtn(),this.setView.show(!0);break;case this.btnExit:t.FishReq.send_ReqExitTable();break;case this.btnExchange:var i=t.FishMgr.BatteryManager.getMyBattery();i?this.exchangeView.show(GameApp.PlayerInfo.safeGold,i.getChips(),t.FishMgr.fishModel.roomInfo):this.exchangeView.show(GameApp.PlayerInfo.safeGold,0,t.FishMgr.fishModel.roomInfo),this.hideOpBtn();break;case this.btnClose:this.groupHelp.visible=!1;break;case this.groupBattery:t.FishMgr.BatteryManager.rotateByPos(this.groupBattery.localToGlobal(e.localX,e.localY))}},i.prototype.hideOpBtn=function(){this.isRightPlaying||(this.isRightPlaying=!0,egret.Tween.get(this.groupRight).to({right:-178},500).call(function(){this.btnLeft.visible=!0,this.btnRight.visible=!1,this.isRightPlaying=!1},this))},i.prototype.onShotCallback=function(e){for(var i=0;i<e.length;i++){var n=e[i];if(n.bullet.isMyBullet()&&t.FishReq.send_ReqHitFish(n.bullet.getBulletPlayerId(),n.bullet.getBulletServerId(),n.fish.getObjId()),t.FishMgr.fishModel.instatdSendPlayerLst)for(var r=0;r<t.FishMgr.fishModel.instatdSendPlayerLst.length;r++){var s=t.FishMgr.fishModel.instatdSendPlayerLst[r];if(n.bullet.getBulletPlayerId().equals(s)){t.FishReq.send_ReqHitFish(s,n.bullet.getBulletServerId(),n.fish.getObjId());break}}t.FishMgr.BulletManager.removeBulletObject(n.bullet.getObjId())}},i.prototype.isAutoExitScene=function(){var e=t.FishMgr.BatteryManager.getMyBattery();e&&(e.isLongTimeNoSendBullet()?(this.autoExit||(this.groupLongTimeNoSend.visible=!0,this.autoExitTimeSum=0,this.showLongTimeNoSendTip(30,this.autoExitTime)),this.autoExit=!0):(this.autoExit=!1,this.groupLongTimeNoSend.visible=!1))},i.prototype.autoExitScene=function(e){if(this.isAutoExitScene(),this.autoExit)if(Math.floor(this.autoExitTimeSum)>=this.autoExitTime)this.isTimeout||(t.FishReq.send_ReqExitTable(),this.isTimeout=!0);else{this.autoExitTimeSum+=e;var i=this.autoExitTime-Math.floor(this.autoExitTimeSum);i>=0&&this.showLongTimeNoSendTip(30,i)}},i.prototype.showLongTimeNoSendTip=function(t,e){e>=0&&(this.lbTimeout.text=e.toString())},i.prototype.update=function(e){var i=(e-this.timeOnEnterFrame)/1e3;return this.timeOnEnterFrame=e,t.FishMgr.FishManager.update(i),t.FishMgr.BulletManager.update(i),t.FishMgr.BatteryManager.update(i),t.FishMgr.CollisionManager.update(i),this.autoExitScene(i),!0},i.prototype.enterScene=function(e){this.visible=!0;var i=!0;fish.FishMgr.fishModel.backRoom&&(i=!1,t.FishMgr.BackgroundManager.initState(0),fish.FishMgr.fishModel.backRoom=!1),t.FishMgr.BackgroundManager.switchBaground(e);for(var n in fish.FishMgr.fishModel.userInfoLst){var r=fish.FishMgr.fishModel.userInfoLst[n];-1!=r.playerId&&-1!=r.seatId&&t.FishMgr.BatteryManager.createBattery({userInfo:r},i)}t.FishMgr.BatteryManager.setClearLockStateCall(function(){});var s=t.FishMgr.BatteryManager.getMyBattery();s&&s.getChips()<=0&&this.exchangeView.show(GameApp.PlayerInfo.safeGold,s.getChips(),t.FishMgr.fishModel.roomInfo);var o=t.FishMgr.fishModel.gameInfo;if(o&&o.lockInfos)for(var a=0;a<o.lockInfos.length;a++){var h=o.lockInfos[a],c=t.FishMgr.BatteryManager.getBatteryByPId(h.playerId);c&&(h.lockFishId>0?(this.tgAuto.selected=!1,this.tgLock.selected=!0,c.setAutoLockFish(!0),GameApp.PlayerInfo.isMySelf(h.playerId)?c.forceToLockFish(h.lockFishId):c.setLockFish(h.lockFishId)):h.lockAngle>=0&&(this.tgAuto.selected=!0,this.tgLock.selected=!1,c.setAutoAngle(h.lockAngle),c.setAutoFire(!0)))}},i.prototype.switchScene=function(e){t.FishMgr.BackgroundManager.switchBaground(e)},i.prototype.setOtherPlayerUserInfo=function(e){e&&t.FishMgr.BatteryManager.createBattery({userInfo:e},!1)},i.prototype.updateBattery=function(e){var i=t.FishMgr.BatteryManager.getBatteryBySeatId(e.seatId);i&&i.setBarrelIndex(e.num,e.score,e.power>0)},i.prototype.updateChips=function(e){var i=t.FishMgr.BatteryManager.getBatteryBySeatId(e.seatId);i&&i.setChips(e.chips)},i.prototype.fire=function(e){var i=t.FishMgr.BatteryManager.getBatteryBySeatId(e.seatId);i&&i.runSendBullet(e.bulletId,e.angle)},i.prototype.addFish=function(e){e.forEach(function(e){var i={objId:e.id,fishId:e.type,pos:{x:e.xcoord,y:e.ycoord},angle:e.angle,cveId:e.road,runTime:e.time/1e3,userInfo:{}};t.FishMgr.FishManager.addFish(i)})},i.prototype.fishsDead=function(e){var i=e.seatId,n=e.dies;if(!(n.length<=0)){for(var r=-1,s=0;s<n.length;s++)if(0==s&&(r=n[s].fishId),s>0){var o=t.FishMgr.FishManager.getFishObjById(n[s].fishId),a=t.FishMgr.FishManager.getFishObjById(r);a&&o&&a.addLineRelObj(o),this.fishDeath(i,n[s].fishId,n[s].score)}this.fishDeath(i,n[0].fishId,n[0].score)}},i.prototype.fishDeath=function(e,i,n){var r=t.FishMgr.BatteryManager.getBatteryBySeatId(e),s=t.FishMgr.FishManager.getFishObjById(i);r&&s&&(s.setFishScore(n),s.setGoldMoveEndPos(r.getBatteryPos()),s.setShotSeatId(e),t.FishMgr.FishManager.removeFish(i))},i.prototype.setLockFish=function(e){var i=t.FishMgr.BatteryManager.getBatteryBySeatId(e.seatId);i&&(e.fishId>0?i.setLockFish(e.fishId):e.angle>=0&&i.setAutoFire(!0))},i.prototype.unLockFish=function(e){var i=t.FishMgr.BatteryManager.getBatteryBySeatId(e);i&&i.setUnLockFish()},i.prototype.removeSeat=function(e){t.FishMgr.BatteryManager.removeBatteryBySeatId(e.seatId),t.FishMgr.BulletManager.removeBulletObjectBySetId(e.seatId)},i.prototype.rebackTable=function(){this.visible=!0,this.isRightPlaying=!1,this.tgAuto.selected=!1,this.tgLock.selected=!1,t.FishMgr.FishManager.clearFishAll(),t.FishMgr.FishLabelManager.clear(),t.FishMgr.FishNetManager.clear(),t.FishMgr.FishGoldManager.clear();for(var e in fish.FishMgr.fishModel.userInfoLst){var i=fish.FishMgr.fishModel.userInfoLst[e],n=t.FishMgr.BatteryManager.getBatteryBySeatId(parseInt(e));n&&-1==i.seatId&&this.removeSeat(i)}t.FishReq.send_ReqScene()},i.prototype.pauseGame=function(e){e&&(App.SoundManager.stopBg(),App.SoundManager.stopEffect()),t.FishMgr.FishLabelManager.clear(),t.FishMgr.FishNetManager.clear(),t.FishMgr.FishGoldManager.clear()},i.prototype.finish=function(){egret.stopTick(this.update,this),egret.Tween.removeAllTweens(),t.FishMgr.BackgroundManager.destroy(),t.FishMgr.FishLabelManager.destroy(),t.FishMgr.FishNetManager.destroy(),t.FishMgr.MusicManager.destroy(),t.FishMgr.FishGoldManager.destroy(),t.FishMgr.FishObjectPool.destroy(),t.FishMgr.BulletManager.destroy(),t.FishMgr.BatteryManager.destroy(),t.FishMgr.FishManager.destroy(),t.FishMgr.CollisionManager.destroy(),t.FishMgr.SkillManager.destroy()},i}(BaseEuiView);t.FishMainView=e,__reflect(e.prototype,"fish.FishMainView")}(fish||(fish={}));var CommonReq;!function(t){t[t.SetRoomInfo=1]="SetRoomInfo",t[t.LoadGameScene=2]="LoadGameScene",t[t.ReqEnterCurGame=3]="ReqEnterCurGame",t[t.ReqEnterCurGameRoom=4]="ReqEnterCurGameRoom",t[t.ReqExitCurGameRoom=5]="ReqExitCurGameRoom",t[t.ReqQuickEnterCurGame=6]="ReqQuickEnterCurGame",t[t.ReqExitCurGameTable=7]="ReqExitCurGameTable",t[t.PauseGame=8]="PauseGame"}(CommonReq||(CommonReq={}));var HomeController=function(t){function e(){var e=t.call(this)||this;return e.homeView=new HomeView(e,LayerManager.UI_Main),App.ViewManager.register(ViewConst.Home,e.homeView),e}return __extends(e,t),e}(BaseController);__reflect(HomeController.prototype,"HomeController");var HomeManager=function(t){function e(){var e=t.call(this)||this;return e._moduleReq={},e._moduleReqFuncs={},e._moduleResFuncs={},e}return __extends(e,t),e.prototype.registerModuleReqFunc=function(t,e,i){this._moduleReqFuncs[t]=[e,i]},e.prototype.registerModuleReqListener=function(t){if(this._moduleReqFuncs[t]){var e=this._moduleReqFuncs[t][0],i=this._moduleReqFuncs[t][1];e.apply(i)}},e.prototype.registerModuleResFunc=function(t,e,i){this._moduleResFuncs[t]=[e,i]},e.prototype.registerGameResListener=function(t){if(this._moduleResFuncs[t]){var e=this._moduleResFuncs[t][0],i=this._moduleResFuncs[t][1];
e.apply(i)}},e.prototype.registerModuleReq=function(t,e,i,n){this._moduleReq[t]||(this._moduleReq[t]={}),this._moduleReq[t][e]=[i,n]},e.prototype.removeModuleReq=function(t){this._moduleReq[t]&&delete this._moduleReq[t]},e.prototype.loadGameScene=function(t){if(this.registerGameResListener(t),this.registerModuleReqListener(t),this.containsModule(t,CommonReq.LoadGameScene)){var e=this._moduleReq[t][CommonReq.LoadGameScene][0],i=this._moduleReq[t][CommonReq.LoadGameScene][1];e.apply(i)}},e.prototype.setRoomInfo=function(t){var e=GameApp.PlayerInfo.curGameID;if(this.containsModule(e,CommonReq.SetRoomInfo)){var i=this._moduleReq[e][CommonReq.SetRoomInfo][0],n=this._moduleReq[e][CommonReq.SetRoomInfo][1];i.apply(n,[t])}},e.prototype.reqEnterCurGame=function(t){if(this.registerGameResListener(t),this.registerModuleReqListener(t),this.containsModule(t,CommonReq.ReqEnterCurGame)){var e=this._moduleReq[t][CommonReq.ReqEnterCurGame][0],i=this._moduleReq[t][CommonReq.ReqEnterCurGame][1];e.apply(i)}},e.prototype.reqEnterCurGameRoom=function(t){var e=GameApp.PlayerInfo.curGameID;if(this.containsModule(e,CommonReq.ReqEnterCurGameRoom)){var i=this._moduleReq[e][CommonReq.ReqEnterCurGameRoom][0],n=this._moduleReq[e][CommonReq.ReqEnterCurGameRoom][1];i.apply(n,[t])}},e.prototype.reqExitCurGameRoom=function(){var t=GameApp.PlayerInfo.curGameID;if(this.containsModule(t,CommonReq.ReqExitCurGameRoom)){var e=this._moduleReq[t][CommonReq.ReqExitCurGameRoom][0],i=this._moduleReq[t][CommonReq.ReqExitCurGameRoom][1];e.apply(i)}},e.prototype.reqQuickEnterCurGame=function(t){var e=GameApp.PlayerInfo.curGameID;if(this.containsModule(e,CommonReq.ReqQuickEnterCurGame)){var i=this._moduleReq[e][CommonReq.ReqQuickEnterCurGame][0],n=this._moduleReq[e][CommonReq.ReqQuickEnterCurGame][1];i.apply(n,[t])}},e.prototype.reqExitCurGameTable=function(){var t=GameApp.PlayerInfo.curGameID;if(this.containsModule(t,CommonReq.ReqExitCurGameTable)){var e=this._moduleReq[t][CommonReq.ReqExitCurGameTable][0],i=this._moduleReq[t][CommonReq.ReqExitCurGameTable][1];e.apply(i)}},e.prototype.containsModule=function(t,e){return t&&this._moduleReq[t]&&this._moduleReq[t][e]},e.prototype.resEnterGameHall=function(t){App.EasyLoading.hideLoading(),App.ViewManager.open(ViewConst.Room,t)},e.prototype.resFailEnterRoom=function(){this.reqEnterCurGame(GameApp.PlayerInfo.curGameID)},e.prototype.resSeatInfoUpdateMsg=function(t){var e=t.seat;if(this._members){var i=this._members[t.seat.playerId];i?(e.sex=i.sex,e.icon=i.icon,e.playerName=i.playerName,e.state=i.state,e.gold=i.gold,e.cedit=i.cedit,e.chips=i.chips,e.sysHost=i.sysHost,e.vip=i.vip):e.state=0,GameApp.PlayerInfo.updateDeskInfo(e)}},e.prototype.resMemInfoUpdateMsg=function(t){GameApp.PlayerInfo.updateDeskInfo(t.member),this._members||(this._members={}),this._members[t.member.playerId]=t.member},e.prototype.resRemoveMemInfoMsg=function(t){this._members&&(this._members[t.playerId]=null)},e.prototype.resRoomSettingUpdateMsg=function(t){this._roomSettingData=t.roomSetting},e.prototype.resQuickEnterCurGame=function(){this.reqExitCurGameRoom()},e.prototype.resEnterRoomMsg=function(t){this._members={};for(var e=[],i=0;i<t.members.length;i++){var n=t.members[i];this._members[n.playerId]=n,GameApp.PlayerInfo.isMySelf(n.playerId)?e.unshift(n):e.push(n)}for(var i=0;i<t.tables.length;i++)for(var r=t.tables[i],s=0;s<r.seats.length;s++){var o=r.seats[s];if(!this._members)return;var a=this._members[o.playerId];a?(o.sex=a.sex,o.icon=a.icon,o.playerName=a.playerName,o.state=a.state,o.gold=a.gold,o.cedit=a.cedit,o.chips=a.chips,o.sysHost=a.sysHost):o=0}GameApp.PlayerInfo.myDesksInfo=t.tables},e.prototype.getMemberInfos=function(t){for(var e=[],i=0;i<t.players.length;i++){var n=t.players[i];GameApp.PlayerInfo.isMySelf(n.playerId)?e.unshift(n):e.push(n)}return e},e.prototype.resRoomPlayerNumMsg=function(t){GameApp.PlayerInfo.updateRoomInfo(t.roomId,t.num)},e.prototype.pauseGame=function(){if(GameApp.PlayerInfo.isLogin&&GameApp.PlayerInfo.curGameID&&App.SceneManager.getCurrScene()!=SceneConsts.Login){var t=GameApp.PlayerInfo.curGameID;if(this.containsModule(t,CommonReq.PauseGame)){var e=this._moduleReq[t][CommonReq.PauseGame][0],i=this._moduleReq[t][CommonReq.PauseGame][1];e.apply(i)}}},e.prototype.resumeGame=function(){GameApp.PlayerInfo.isLogin&&GameApp.PlayerInfo.curGameID&&App.SceneManager.getCurrScene()!=SceneConsts.Login&&GameApp.HomeManager.loadGameScene(GameApp.PlayerInfo.curGameID)},e}(BaseClass);__reflect(HomeManager.prototype,"HomeManager");var HomeView=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.gameData=[],n.skinName="resource/skins/HomeSkin.exml",n}return __extends(e,t),e.prototype.initUI=function(){var e=this;t.prototype.initUI.call(this),this.lstGame=new eui.List;var i=new eui.HorizontalLayout;i.verticalAlign=egret.VerticalAlign.MIDDLE,i.horizontalAlign=egret.HorizontalAlign.CENTER,i.gap=10,this.lstGame.layout=i,this.lstGame.dataProvider=new eui.ArrayCollection,this.scrollerGame.viewport=this.lstGame,this.lstGame.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onChangeHandler,this),this.btnExit.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitHandler,this),App.MessageCenter.addListener("event_change_gold",function(){e.lbGold.text="金币："+GameApp.chips2Money(GameApp.PlayerInfo.safeGold)},this)},e.prototype.initData=function(){t.prototype.initData.call(this),this.getGameData(),this.lstGame.dataProvider=new eui.ArrayCollection(this.gameData),this.lstGame.itemRendererSkinName=this.exml()},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this,e),this.lbNick.text="昵称："+GameApp.PlayerInfo.nickName,this.lbID.text="ID："+GameApp.PlayerInfo.id,this.lbGold.text="金币："+GameApp.chips2Money(GameApp.PlayerInfo.safeGold),this.imgHead.texture=GameApp.PlayerInfo.getHeadTexture()},e.prototype.onChangeHandler=function(){App.SoundManager.playEffect("btnclick_mp3");var t=this.lstGame.selectedItem,e=this.configData[t.id];e&&1==e.play_state?(App.EasyLoading.showLoading(),GameApp.HomeManager.reqEnterCurGame(t.id)):GameApp.PromotManager.oneButtonTip("敬请期待")},e.prototype.getGameData=function(){if(this.configData=RES.getRes("game_config"),this.configData){for(var t in this.configData){var e=this.configData[t];1==e.play_state&&this.gameData.push(e)}this.gameData.sort(function(t,e){return t.sort<e.sort?-1:t.sort>e.sort?1:0})}},e.prototype.exml=function(){return'<e:Skin xmlns:e="http://ns.egret.com/eui" xmlns:w="http://ns.egret.com/wing" states="up, down"><e:Image source="{data.icon}" alpha.up="1" alpha.down="0.8"/></e:Skin>'},e.prototype.onExitHandler=function(t){LoginReq.send_logout(function(t,e){t?(GameApp.PlayerInfo.logout(),App.ViewManager.closeView(this),App.ViewManager.open(ViewConst.Login)):GameApp.PromotManager.floatingTip(e.errorCode)},this)},e}(BaseEuiView);__reflect(HomeView.prototype,"HomeView");var LoadingConst=function(){function t(){}return t.SetProgress=10001,t}();__reflect(LoadingConst.prototype,"LoadingConst");var LoadingController=function(t){function e(){var e=t.call(this)||this;return e.loadingView=new LoadingView(e,LayerManager.UI_Main),App.ViewManager.register(ViewConst.Loading,e.loadingView),e.registerFunc(LoadingConst.SetProgress,e.setProgress,e),e}return __extends(e,t),e.prototype.setProgress=function(t,e){this.loadingView.setProgress(t,e)},e}(BaseController);__reflect(LoadingController.prototype,"LoadingController");var LoadingView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.loadingBgRes=function(){return"loading_bg_jpg"},e.prototype.fillBgRes=function(){return"loading_fill_bg_png"},e.prototype.fillRes=function(){return"loading_fill_png"},e}(BaseLoadingView);__reflect(LoadingView.prototype,"LoadingView");var HeartMgr=function(t){function e(){var e=t.call(this)||this;return e.invalidTime=0,e.sumTime=0,e.timeOut=50,e.pingRate=10,e}return __extends(e,t),e.prototype.init=function(){this.sendHeart=!0,this.timer||(this.timer=new egret.Timer(1e3)),this.startHeart||(this.timer.hasEventListener(egret.TimerEvent.TIMER)||this.timer.addEventListener(egret.TimerEvent.TIMER,this.doTimer,this),this.timer.start(),this.startHeart=!0)},e.prototype.pause=function(){this.sendHeart=!1,this.invalidTime=0,this.sumTime=0,this.timer&&this.timer.stop()},e.prototype.resume=function(){this.sendHeart=!1,this.invalidTime=0,this.sumTime=0,this.timer&&this.timer.start()},e.prototype.uninit=function(){this.startHeart=!1,this.sendHeart=!1,this.invalidTime=0,this.sumTime=0,this.timer.removeEventListener(egret.TimerEvent.TIMER,this.doTimer,this)},e.prototype.doTimer=function(){this.sendHeart&&(this.invalidTime++,this.sumTime++,this.sumTime>this.pingRate&&(this.send_ReqHeartbeat(),this.sumTime=0),this.invalidTime>=this.timeOut&&(egret.log("心跳超时"),this.sendHeart=!1))},e.prototype.send_ReqHeartbeat=function(){var t={id:1},e=this;App.Socket.send(t,function(i,n){i==t.id&&(e.invalidTime=0)},this)},e}(BaseClass);__reflect(HeartMgr.prototype,"HeartMgr");var LoginController=function(t){function e(){var e=t.call(this)||this;return e.loginView=new LoginView(e,LayerManager.UI_Main),App.ViewManager.register(ViewConst.Login,e.loginView),e}return __extends(e,t),e}(BaseController);__reflect(LoginController.prototype,"LoginController");var LoginMgr=function(){function t(){}return t.start=function(){t.loginStart||(t.loginStart=new LoginStart),t.loginStart.start()},t.finish=function(){t.loginStart},t}();__reflect(LoginMgr.prototype,"LoginMgr");var LoginReq=function(){function t(){}return t.send_reLogin=function(e,i,n,r,s){var o={id:t.c2s_login_ReqReLogin_msg,byHand:n,code:e,type:i,platform:0};App.Socket.send(o,function(t,e){t==o.id?egret.localStorage.setItem("reloginType",i+""):(GameApp.PlayerInfo.updateLoginState(!1),egret.localStorage.removeItem("reloginCode"),egret.localStorage.removeItem("reloginType"),LoginMgr.start()),r.apply(s,[t==o.id,e])},this)},t.send_loginBySmsCode=function(e,i,n,r){var s={id:t.c2s_login_ReqLoginBySmsCode_msg,smsCode:i,phone:e};App.Socket.send(s,function(t,e){n.apply(r,[t==s.id,e])},this)},t.send_loginByTourist=function(e,i,n){var r={id:t.c2s_login_ReqTouristLogin_msg,platform:2};n&&(r.code="GZ_"+n,console.log("[LoginReq] Platform tourist login with code:",r.code)),App.Socket.send(r,function(t,n){e.apply(i,[t==r.id,n])},this)},t.send_logout=function(e,i){var n={id:t.c2s_login_REqLogout_msg};App.Socket.send(n,function(t,r){e.apply(i,[t==n.id,r])},this)},t.c2s_login_ReqHeartbeat_msg=1,t.c2s_login_ReqTouristLogin_msg=101,t.c2s_login_ReqGetLoginSms_msg=102,t.c2s_login_ReqLoginBySmsCode_msg=103,t.c2s_login_ReqReLogin_msg=106,t.c2s_login_ReqReqLoginFromWechat_msg=113,t.c2s_login_REqLogout_msg=105,t}();__reflect(LoginReq.prototype,"LoginReq");var LoginStart=function(){function t(){}return t.prototype.start=function(){if(GameApp.PlayerInfo.curGameID=null,LoginMgr.isLoading){this.initModule(),App.SceneManager.runScene(SceneConsts.Login);var t=new URLSearchParams(window.location.search),e=t.get("userId");if(e&&!GameApp.PlayerInfo.isLogin)return console.log("[LoginStart] Platform user detected from URL params in start():",e),void this.connectServerWithPlatformLogin({id:e,name:"玩家"});var i=window.currentUser||window.GameZoe&&window.GameZoe.currentUser;if(i&&i.id&&!GameApp.PlayerInfo.isLogin)return console.log("[LoginStart] Platform user detected in start(), auto-login..."),void this.connectServerWithPlatformLogin(i);GameApp.PlayerInfo.isLogin?App.ViewManager.open(ViewConst.Home):App.ViewManager.open(ViewConst.Login)}else this.runLoading(),App.ResourceUtils.addConfig("resource/resource_core.json","resource/"),App.ResourceUtils.addConfig("resource/proto/proto.res.json","resource/"),App.ResourceUtils.loadConfig(this.onConfigComplete,this),App.EasyLoading.showLoading()},t.prototype.runLoading=function(){return App.SceneManager.register(SceneConsts.Login,new LoginScene),App.ControllerManager.register(ControllerConst.Loading,new LoadingController),App.SceneManager.runScene(SceneConsts.Login),App.ViewManager.open(ViewConst.Loading),!0},t.prototype.onConfigComplete=function(){App.EasyLoading.hideLoading();var t="common",e=["preload_core","common_asset","proto_file"];App.ResourceUtils.loadGroups(t,e,this.onLoadComplete,this.onLoadProgress,this)},t.prototype.onLoadComplete=function(){LoginMgr.isLoading=!0,App.MsgFactory.registerAll(),App.Init(),GameApp.Init(),this.initModule();var t=new URLSearchParams(window.location.search),e=t.get("userId");if(e)return console.log("[LoginStart] Platform user detected from URL params:",e),void this.connectServerWithPlatformLogin({id:e,name:"玩家"});var i=window.currentUser||window.GameZoe&&window.GameZoe.currentUser;return i&&i.id?(console.log("[LoginStart] Platform user detected:",i.id),void this.connectServerWithPlatformLogin(i)):(GameApp.PlayerInfo.isLogin?App.ViewManager.open(ViewConst.Home):App.ViewManager.open(ViewConst.Login),void this.connectServer())},t.prototype.onLoadProgress=function(t,e){App.ControllerManager.applyFunc(ControllerConst.Loading,LoadingConst.SetProgress,t,e)},t.prototype.initModule=function(){App.ControllerManager.register(ControllerConst.Login,new LoginController),App.ControllerManager.register(ControllerConst.Home,new HomeController),App.ControllerManager.register(ControllerConst.Room,new RoomController)},t.prototype.connectServer=function(){var t=this;App.Socket.connect(),App.MessageCenter.addListener(SocketConst.SOCKET_CONNECT,function(){GameApp.HeartMgr.init();var e=egret.localStorage.getItem("reloginCode"),i=parseInt(egret.localStorage.getItem("reloginType"));e&&i&&t.reLogin(e,i)},this),App.MessageCenter.addListener(SocketConst.SOCKET_RECONNECT,function(){GameApp.HeartMgr.resume(),console.log("断线重连成功"),GameApp.PlayerInfo.isLogin&&LoginReq.send_reLogin(GameApp.PlayerInfo.reLoginCode,GameApp.PlayerInfo.loginType,0,function(t,e){},t)},this),App.MessageCenter.addListener(SocketConst.SOCKET_START_RECONNECT,function(){GameApp.HeartMgr.pause(),console.log("开始与服务器重新连接")},this),App.MessageCenter.addListener(SocketConst.SOCKET_CLOSE,function(){GameApp.HeartMgr.pause(),GameApp.PromotManager.twoButtonTip("服务器连接失败，请检查网络设置",null,function(){GameApp.PromotManager.hideButtonTip(),App.Socket.connect()},t,function(){location.href="404.html?code=500&msg=服务器连接失败，请检查网络设置"},t)},this),App.MessageCenter.addListener(SocketConst.SOCKET_NOCONNECT,function(){GameApp.HeartMgr.pause(),GameApp.PromotManager.twoButtonTip("服务器连接失败，请检查网络设置",null,function(){GameApp.PromotManager.hideButtonTip(),App.Socket.connect()},t,function(){location.href="404.html?code=500&msg=服务器连接失败，请检查网络设置"},t)},this)},t.prototype.connectServerWithPlatformLogin=function(t){var e=this;egret.localStorage.setItem("platformUserId",t.id),egret.localStorage.setItem("platformUserName",t.name||"玩家"),App.Socket.connect(),App.MessageCenter.addListener(SocketConst.SOCKET_CONNECT,function(){GameApp.HeartMgr.init(),console.log("[LoginStart] Socket connected, checking for existing session...");var i=egret.localStorage.getItem("reloginCode"),n=parseInt(egret.localStorage.getItem("reloginType"));i&&n?e.reLogin(i,n):(console.log("[LoginStart] No existing session, platform login with userId:",t.id),LoginReq.send_loginByTourist(function(e,i){e?(console.log("[LoginStart] Platform login success, userId:",t.id),GameApp.PlayerInfo.loginType=LoginType.Tourist,egret.localStorage.setItem("reloginType",LoginType.Tourist+"")):(console.error("[LoginStart] Tourist login failed"),App.ViewManager.open(ViewConst.Login))},e,t.id))},this),App.MessageCenter.addListener(SocketConst.SOCKET_RECONNECT,function(){GameApp.HeartMgr.resume(),console.log("断线重连成功"),GameApp.PlayerInfo.isLogin&&LoginReq.send_reLogin(GameApp.PlayerInfo.reLoginCode,GameApp.PlayerInfo.loginType,0,function(t,e){},e)},this),App.MessageCenter.addListener(SocketConst.SOCKET_START_RECONNECT,function(){GameApp.HeartMgr.pause(),console.log("开始与服务器重新连接")},this),App.MessageCenter.addListener(SocketConst.SOCKET_CLOSE,function(){GameApp.HeartMgr.pause(),GameApp.PromotManager.twoButtonTip("服务器连接失败，请检查网络设置",null,function(){GameApp.PromotManager.hideButtonTip(),App.Socket.connect()},e,function(){window.top&&(window.top.location.href="/")},e)},this),App.MessageCenter.addListener(SocketConst.SOCKET_NOCONNECT,function(){GameApp.HeartMgr.pause(),GameApp.PromotManager.twoButtonTip("服务器连接失败，请检查网络设置",null,function(){GameApp.PromotManager.hideButtonTip(),App.Socket.connect()},e,function(){window.top&&(window.top.location.href="/")},e)},this)},t.prototype.reLogin=function(t,e){App.EasyLoading.showLoading();LoginReq.send_reLogin(t,e,1,function(t,e){App.EasyLoading.hideLoading(),t||GameApp.PromotManager.oneButtonTip("登录失败")},this)},t.prototype.finish=function(){},t}();__reflect(LoginStart.prototype,"LoginStart");var LoginType;!function(t){t[t.Tourist=1]="Tourist",t[t.Phone=2]="Phone",t[t.Wechat=3]="Wechat",t[t.H5=5]="H5"}(LoginType||(LoginType={}));var LoginView=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.countdown=60,n.skinName="resource/skins/LoginSkin.exml",n}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.inputAccount.restrict="0-9",this.inputAccount.maxChars=11,this.inputCode.restrict="0-9",this.inputCode.maxChars=6,this.btnCode.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCodeHandler,this),this.btnAccount.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAccountLoginHandler,this),this.btnTourist.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouristLoginHandler,this)},e.prototype.onCodeHandler=function(t){var e=App.StringUtils.trimSpace(this.inputAccount.text);if(this.checkPhone(e)){this.btnCode.label="60s, 再获取",this.btnCode.enabled=!1;var i=60;App.TimerManager.doTimer(1e3,this.countdown,function(){i--,this.btnCode.label=i+"s, 再获取"},this,function(){this.btnCode.label="获取验证码",this.btnCode.enabled=!0},this)}},e.prototype.onAccountLoginHandler=function(t){var e=App.StringUtils.trimSpace(this.inputAccount.text),i=App.StringUtils.trimSpace(this.inputCode.text);this.checkPhone(e)&&this.checkCode(i)&&LoginReq.send_loginBySmsCode(e,i,function(t,e){t?(GameApp.PlayerInfo.loginType=LoginType.Phone,egret.localStorage.setItem("reloginType",LoginType.Phone+"")):GameApp.PromotManager.floatingTip(e.errorCode)},this)},e.prototype.onTouristLoginHandler=function(t){LoginReq.send_loginByTourist(function(t,e){t?(GameApp.PlayerInfo.loginType=LoginType.Tourist,egret.localStorage.setItem("reloginType",LoginType.Tourist+"")):GameApp.PromotManager.floatingTip(e.errorCode)},this)},e.prototype.checkPhone=function(t){return App.StringUtils.isEmpty(t)?(GameApp.PromotManager.floatingTip("号码不能为空"),!1):App.StringUtils.isPhone(t)?!0:(GameApp.PromotManager.floatingTip("号码不合法"),!1)},e.prototype.checkCode=function(t){return App.StringUtils.isEmpty(t)?(GameApp.PromotManager.floatingTip("验证码为空"),!1):6!=t.length?(GameApp.PromotManager.floatingTip("验证码不合法 < 6 位"),!1):!0},e}(BaseEuiView);__reflect(LoginView.prototype,"LoginView");var CommonNoticeRes=function(){function t(){}return t.rec_common_ResError=function(t){PlayerManager.resCommonMsg(t)},t.rec_common_ResWarn=function(t){PlayerManager.resCommonMsg(t)},t.rec_common_ResTip=function(t){PlayerManager.resCommonMsg(t)},t.rec_common_ResShow=function(t){},t.rec_common_ResCloseRoom=function(e){App.SceneManager.getCurrScene()==SceneConsts.Login?App.ViewManager.isShow(ViewConst.Room)&&GameApp.HomeManager.reqEnterCurGame(GameApp.PlayerInfo.curGameID):GameApp.PromotManager.oneButtonTip("25035",{},function(){GameApp.PromotManager.hideButtonTip(),LoginMgr.start()},t)},t.rec_common_ResMarqueeNotice=function(t){t.isInBackground||GameApp.MarqueeManager.start(t)},t.registerResListener=function(){App.MessageCenter.addListener(t.s2c_common_ResError_msg,t.rec_common_ResError,t),App.MessageCenter.addListener(t.s2c_common_ResWarn_msg,t.rec_common_ResWarn,t),App.MessageCenter.addListener(t.s2c_common_ResTip_msg,t.rec_common_ResTip,t),App.MessageCenter.addListener(t.s2c_common_ResShow_msg,t.rec_common_ResShow,t),App.MessageCenter.addListener(t.s2c_common_ResCloseRoom_msg,t.rec_common_ResCloseRoom,t),App.MessageCenter.addListener(t.S2c_commmon_ResMarqueeNotice_msg,t.rec_common_ResMarqueeNotice,t)},t.s2c_common_ResError_msg="3",t.s2c_common_ResShow_msg="4",t.s2c_common_ResTip_msg="5",t.s2c_common_ResWarn_msg="6",t.s2c_common_ResCloseRoom_msg="5009",t.S2c_commmon_ResMarqueeNotice_msg="501",t}();__reflect(CommonNoticeRes.prototype,"CommonNoticeRes");var PlayerInfo=function(t){function e(){var e=t.call(this)||this;return e.id="",e.superId=0,e.userName="",e.nickName="",e.sex="",e.icon=1,e.level=0,e.vipLevel=0,e.vipTime=0,e.gold=0,e.safeGold=0,e.acer=0,e.integral=0,e.fullName="",e.idCardNo="",e.lottery=0,e.phone="",e.email="",e.age=0,e.birthMonth=1,e.birthDay=1,e.province="",e.city="",e.addr="",e.signature="",e.bindingMac="",e.havePwdProtect=0,e.loginPhoneVerify=0,e.playItemEffect=0,e.isTourist=!1,e.isLogin=!1,e.reLoginCode="",e.transferReward=0,e.type=0,e.nextLevelExp=0,e.exp=0,e.myRoomTypeInfo=[],e.myDesksInfo=[],e.curGameID=null,e.myTableId=null,e.loginType=LoginType.Tourist,e.gameInfo=null,e}return __extends(e,t),e.prototype.loginSuccess=function(t,e){this.id=t.id,this.superId=t.superId?t.superId:0,this.userName=t.userName?t.userName:"",this.nickName=t.nickName?t.nickName:"",this.level=t.level?t.level:0,this.vipLevel=t.vipLevel?t.vipLevel:0,this.gold=t.gold?t.gold.toNumber():0,this.acer=t.ingot?t.ingot:0,this.safeGold=t.safeGold?t.safeGold.toNumber():0,this.integral=t.cedit?t.cedit:0,this.lottery=t.lottery?t.lottery:0,this.phone=t.phone?t.phone:"",this.email=t.email?t.email:"",this.fullName=t.fullName?t.fullName:"",this.sex=t.sex?t.sex:"女",this.icon=t.icon?t.icon:1,this.idCardNo=t.idCardNo?t.idCardNo:"",this.vipTime=t.vipDuration?t.vipDuration:0,this.age=t.age?t.age:18,this.birthMonth=t.birthMonth?t.birthMonth:1,this.birthDay=t.birthDay?t.birthDay:1,this.province=t.province?t.province:"",this.city=t.city?t.city:"",this.addr=t.addr?t.addr:"",this.signature=t.signature?t.signature:"",this.bindingMac=t.bindingMac?t.bindingMac:"",this.havePwdProtect=t.havePwdProtect?t.havePwdProtect:0,this.loginPhoneVerify=t.loginPhoneVerify?t.loginPhoneVerify:0,this.playItemEffect=t.playItemEffect?t.playItemEffect:0,this.isTourist=1==t.tourist,this.reLoginCode=t.reLoginCode?t.reLoginCode:"",this.transferReward=t.transferReward?t.transferReward:0,this.type=t.type?t.type:0,this.nextLevelExp=t.nextLevelExp?t.nextLevelExp:0,this.exp=t.exp?t.exp:0,this.isTourist&&egret.localStorage.setItem("touristKey",this.userName),egret.localStorage.setItem("reloginCode",this.reLoginCode),this.updateLoginState(!0),this.gameInfo=e},e.prototype.updateRoomInfo=function(t,e){if(this.myRoomTypeInfo&&!(this.myRoomTypeInfo.length<=0))for(var i=0;i<this.myRoomTypeInfo.length;i++){var n=this.myRoomTypeInfo[i];if(n&&!(n.length<=0))for(var r=0;r<n.length;r++)if(n[i].roomId==t)return void(n[i].playerNum=e)}},e.prototype.updateDeskInfo=function(t){if(this.myDesksInfo&&!(this.myDesksInfo.length<=0))for(var e=0;e<this.myDesksInfo.length;e++){var i=this.myDesksInfo[e].desk;if(i&&i.id==t.tableId){var n=i.setas;if(!n||n.length<=0)return;for(var r=0;r<n.length;r++)n[e].order==t.order&&(n[e]=t)}}},e.prototype.isMySelf=function(t){return 0==this.id.compare(t)},e.prototype.updateLoginState=function(t){this.isLogin=t},e.prototype.logout=function(){this.updateLoginState(!1),egret.localStorage.removeItem("reloginCode")},e.prototype.getHeadTexture=function(t){var e=t;e||(e=this.icon),e%=10;var i="player_"+e+"_png";return RES.getRes(i)},e}(BaseClass);__reflect(PlayerInfo.prototype,"PlayerInfo");var PlayerManager=function(){function t(){}return t.resCommonMsg=function(t){App.EasyLoading.hideLoading(),t.errorCode&&GameApp.PromotManager.oneButtonTip(t.errorCode,t.args)},t.resPlayerAttrChangeMsg=function(t){switch(t.type){case 1:GameApp.PlayerInfo.acer=t.val;break;case 2:break;case 3:GameApp.PlayerInfo.safeGold=t.val,App.MessageCenter.dispatch("event_change_gold");break;case 4:GameApp.PlayerInfo.integral=t.val;break;case 5:GameApp.PlayerInfo.lottery=t.val;break;case 6:var e=parseInt(t.val);e&&e!=GameApp.PlayerInfo.level&&GameApp.PromotManager.floatingTip("恭喜升级到lv."+e),GameApp.PlayerInfo.level=e;break;case 7:GameApp.PlayerInfo.vipLevel=t.val;break;case 8:GameApp.PlayerInfo.vipTime=t.val;break;case 9:GameApp.PlayerInfo.exp=t.val;break;case 10:GameApp.PlayerInfo.transferReward=t.val;break;case 11:GameApp.PlayerInfo.nextLevelExp=t.val;break;case 12:GameApp.PlayerInfo.superId=t.val;break;case 13:GameApp.PlayerInfo.type=t.val}},t.logout_callback=function(t,e){GameApp.PromotManager.hideButtonTip(),egret.localStorage.removeItem("reloginCode"),egret.localStorage.removeItem("reloginType"),LoginMgr.start()},t.resLogoutMsg=function(e){if(e)switch(GameApp.PlayerInfo.updateLoginState(!1),e.id){case parseInt(PlayerRes.s2c_player_ResLogout_msg):t.logout_callback();break;case parseInt(PlayerRes.s2c_player_ResRepeatLogin_msg):GameApp.PromotManager.oneButtonTip("129",null,function(){t.logout_callback(PlayerRes.s2c_player_ResLogout_msg,"对不起，您的账号在另一个地方登录")},t);break;case parseInt(PlayerRes.s2c_player_ResLocked_msg):GameApp.PromotManager.oneButtonTip("106",null,function(){t.logout_callback(PlayerRes.s2c_player_ResLocked_msg,"对不起，您的账号已被冻结")},t);break;case parseInt(PlayerRes.s2c_player_ResNetStuck_msg):GameApp.PromotManager.oneButtonTip("715",null,function(){t.logout_callback(PlayerRes.s2c_player_ResNetStuck_msg,"对不起，当前牌桌出错，请重新登录。")},t);break;case parseInt(PlayerRes.s2c_player_ResStopService_msg):GameApp.PromotManager.oneButtonTip("100017",null,function(){t.logout_callback(PlayerRes.s2c_player_ResNetStuck_msg,"对不起，游戏服务器维护中，请关注官网公告！")},t)}},t.registerResListener=function(){CommonNoticeRes.registerResListener(),PlayerRes.registerResListener()},t}();__reflect(PlayerManager.prototype,"PlayerManager");var PlayerRes=function(){function t(){}return t.rec_player_ResPlayerAttrChange=function(t){PlayerManager.resPlayerAttrChangeMsg(t)},t.rec_player_ResRepeatLogin=function(t){PlayerManager.resLogoutMsg(t)},t.rec_player_ResLocked=function(t){PlayerManager.resLogoutMsg(t)},t.rec_player_ResNetStuck=function(t){PlayerManager.resLogoutMsg(t)},t.rec_player_ResStopService=function(t){PlayerManager.resLogoutMsg(t)},t.rec_player_ResPlayerInfo=function(t){GameApp.PlayerInfo.loginSuccess(t.playerInfo,t.gameInfo);var e=GameApp.PlayerInfo.gameInfo;e&&e.gameType&&e.gameType>0?(GameApp.PlayerInfo.curGameID=e.gameType,GameApp.HomeManager.loadGameScene(e.gameType)):App.SceneManager.getCurrScene()!=SceneConsts.Login?LoginMgr.start():App.ViewManager.open(ViewConst.Home)},t.registerResListener=function(){App.MessageCenter.addListener(t.s2c_player_ResPlayerInfo_msg,t.rec_player_ResPlayerInfo,t),App.MessageCenter.addListener(t.s2c_player_ResPlayerAttrChange,t.rec_player_ResPlayerAttrChange,t),App.MessageCenter.addListener(t.s2c_player_ResRepeatLogin_msg,t.rec_player_ResRepeatLogin,t),App.MessageCenter.addListener(t.s2c_player_ResLocked_msg,t.rec_player_ResLocked,t),App.MessageCenter.addListener(t.s2c_player_ResNetStuck_msg,t.rec_player_ResNetStuck,t),App.MessageCenter.addListener(t.s2c_player_ResStopService_msg,t.rec_player_ResStopService,t)},t.s2c_player_ResPlayerAttrChange="214",t.s2c_player_ResPlayerInfo_msg="201",t.s2c_player_ResLogout_msg="105",t.s2c_player_ResRepeatLogin_msg="108",t.s2c_player_ResLocked_msg="109",t.s2c_player_ResNetStuck_msg="110",t.s2c_player_ResStopService_msg="112",t}();__reflect(PlayerRes.prototype,"PlayerRes");var ButtonComponent=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(eui.UIEvent.COMPLETE,e.onUIComplete,e),e.skinName="resource/skins/ButtonTipSkin.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.percentWidth=100,this.percentHeight=100},e.prototype.onUIComplete=function(){this.btnCancel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCancelHandler,this),this.btnSure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSurelHandler,this)},e.prototype.onCancelHandler=function(){this.cancelListener&&this.cancelListener[0].apply(this.cancelListener[1])},e.prototype.onSurelHandler=function(){this.sureListener&&this.sureListener[0].apply(this.sureListener[1])},e.prototype.SetCancelHandler=function(t,e){t&&e?this.cancelListener=[t,e]:this.cancelListener=null},e.prototype.SetSureHandler=function(t,e){t&&e?this.sureListener=[t,e]:this.sureListener=null},e.prototype.SetCancelVisible=function(t){this.btnCancel.visible=t,t?(this.btnCancel.right=0,this.btnSure.left=0):this.btnSure.left=145},e.prototype.SetMsg=function(t){this.lbMsg.text=t},e}(eui.Component);__reflect(ButtonComponent.prototype,"ButtonComponent");var ButtonTip=function(t){function e(){var e=t.call(this)||this;return e.content=null,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.content=new egret.Sprite,this.content.graphics.beginFill(0,.3),this.content.graphics.drawRect(0,0,App.StageUtils.getWidth(),App.StageUtils.getHeight()),this.content.graphics.endFill(),this.content.touchEnabled=!0,this.btnTip=new ButtonComponent,this.content.addChild(this.btnTip)},e.prototype.oneButtonTip=function(t,e,i){this.btnTip.SetCancelVisible(!1),this.btnTip.SetMsg(t),e&&i?this.btnTip.SetSureHandler(e,i):this.btnTip.SetSureHandler(this.hideButtonTip,this),App.StageUtils.getStage().addChild(this.content)},e.prototype.twoButtonTip=function(t,e,i,n,r){this.btnTip.SetCancelVisible(!0),this.btnTip.SetMsg(t),e&&e?this.btnTip.SetSureHandler(e,i):this.btnTip.SetSureHandler(this.hideButtonTip,this),n&&r?this.btnTip.SetCancelHandler(n,r):this.btnTip.SetCancelHandler(this.hideButtonTip,this),App.StageUtils.getStage().addChild(this.content)},e.prototype.hideButtonTip=function(){App.StageUtils.getStage().removeChild(this.content)},e}(BaseClass);__reflect(ButtonTip.prototype,"ButtonTip");var FloatingTip=function(t){function e(){var e=t.call(this)||this;return e.content=null,e.tipArray=[],e.init(),e}return __extends(e,t),e.prototype.init=function(){this.content=new egret.Sprite,this.content.graphics.beginFill(0,0),this.content.graphics.drawRect(0,0,App.StageUtils.getWidth(),App.StageUtils.getHeight()),this.content.graphics.endFill()},e.prototype.createTextField=function(t,e,i,n,r){void 0===e&&(e=16777215),void 0===i&&(i=egret.VerticalAlign.MIDDLE),void 0===n&&(n=egret.HorizontalAlign.CENTER),void 0===r&&(r="Verdana");var s=new egret.TextField;return s.size=t,s.textColor=e,s.textAlign=n,s.verticalAlign=i,s.fontFamily=r,s.cacheAsBitmap=!0,s},e.prototype.showTips=function(t,e){void 0===e&&(e=16777215),this.tipArray.push({text:t,color:e}),App.StageUtils.getStage().addChild(this.content),App.TimerManager.doFrame(1,0,this.enterFrame,this)},e.prototype.enterFrame=function(){if(this.tipArray.length>0){var t=this.tipArray.pop(),e=App.StageUtils.getWidth(),i=App.StageUtils.getHeight(),n=this.createTextField(40);n.text=t.text,n.textColor=t.color,n.y=.5*i,n.width=e,this.content.addChild(n),egret.Tween.get(n).to({y:.3*i,alpha:0},1e3,egret.Ease.circIn).call(function(t){t.parent&&t.parent.removeChild(t)},this,[n])}else App.TimerManager.remove(this.enterFrame,this)},e}(BaseClass);__reflect(FloatingTip.prototype,"FloatingTip");var MarqueeManager=function(t){function e(){var e=t.call(this)||this;return e.speed=200,e.isRuning=!1,e.lastInterval=0,e.isInterval=!1,e.msgArray=[],e.msgQueue=[],e.init(),e}return __extends(e,t),e.prototype.init=function(){this.content=new egret.Sprite,this.content.graphics.beginFill(0,0),this.content.graphics.drawRect(0,0,App.StageUtils.getWidth(),App.StageUtils.getHeight()),this.content.graphics.endFill(),this.imgBg=new eui.Image,this.imgBg.texture=RES.getRes("common_marquee_bg_png"),this.imgBg.width=1097,this.imgBg.height=99,this.imgBg.x=(App.StageUtils.getWidth()-this.imgBg.width)/2,this.imgBg.y=60;var t=new egret.Rectangle(this.imgBg.x,this.imgBg.y,1097,99);this.content.mask=t,this.content.addChild(this.imgBg),this.timeOnEnterFrame=egret.getTimer(),egret.startTick(this.update,this)},e.prototype.start=function(t){if(t)if(this.msgQueue.push({interval:0,runing:!1,msg:t}),t.times>1)for(var e=0;e<t.times;e++)this.msgArray.push(t);
else this.msgArray.push(t)},e.prototype._run2=function(t){if(this._updateInterval(t),this.msgQueue.length<=0&&0==this.isRuning)return void(this.content.parent&&this.content.parent.removeChild(this.content));if(this.text)this.text.x-=t*this.speed,this.text.x<this.imgBg.x-this.text.width&&this.text.parent&&(this.text.parent.removeChild(this.text),this.text=null,this.isRuning=!1,this.runingMsg&&(this.runingMsg.runing=!1));else{var e=this._getMsg();if(e)this.text=this.createText(e.msg,this.imgBg.x+this.imgBg.width,this.imgBg.y),this.content.addChild(this.text),this.isRuning=!0,e.runing=!0,this.runingMsg=e,this.content.parent||App.StageUtils.getStage().addChild(this.content);else{var i=this._getMaxInterval();i>3&&this.content.parent&&this.content.parent.removeChild(this.content)}}},e.prototype._getMsg=function(){this._removeMsg();for(var t=0;t<this.msgQueue.length;t++){var e=this.msgQueue[t];if(!(e.interval>0||e.msg.times<=0))return e.msg.times-=1,e.interval=e.msg.interval,e}return null},e.prototype._removeMsg=function(){for(var t=this.msgQueue.length,e=t-1;e>=0;e--){var i=this.msgQueue[e];i.msg.times<=0&&this.msgQueue.splice(e,1)}},e.prototype._updateInterval=function(t){for(var e=0;e<this.msgQueue.length;e++){var i=this.msgQueue[e];0==i.runing&&(i.interval-=t,i.interval<0&&(i.interval=0))}},e.prototype._getMaxInterval=function(){for(var t=0,e=0;e<this.msgQueue.length;e++){var i=this.msgQueue[e];0==i.runing&&i.interval>t&&(t=i.interval)}return t},e.prototype.update=function(t){var e=(t-this.timeOnEnterFrame)/1e3;return this.timeOnEnterFrame=t,this._run2(e),!0},e.prototype._run=function(t){if(this.isInterval&&this.msgArray.length>0)return this.lastInterval-=t,this.content.parent&&this.content.parent.removeChild(this.content),void(this.lastInterval<=0&&(this.lastInterval=0,this.isInterval=!1,this.isRuning=!1));if(this.msgArray.length<=0&&0==this.isRuning)return void(this.content.parent&&this.content.parent.removeChild(this.content));if(this.content.parent||App.StageUtils.getStage().addChild(this.content),!this.text&&this.msgArray.length>0){this.isRuning=!0;var e=this.msgArray.shift();this.text=this.createText(e,this.imgBg.x+this.imgBg.width,this.imgBg.y),this.lastInterval=e.interval,this.content.addChild(this.text)}else this.text.x-=t*this.speed,this.text.x<this.imgBg.x-this.text.width&&this.text.parent&&(this.text.parent.removeChild(this.text),this.text=null,this.lastInterval>0?this.isInterval=!0:this.isRuning=!1)},e.prototype.createText=function(t,e,i){var n=new egret.TextField;n.text=t.content;var r=16777215;switch(t.color){case"red":r=16711680;break;case"yellow":r=16776960}return n.textColor=r,n.size=50,n.bold=!0,n.x=e+n.width,n.y=i+n.height/2,n},e}(BaseClass);__reflect(MarqueeManager.prototype,"MarqueeManager");var PromotManager=function(t){function e(){var e=t.call(this)||this;return e.floatTip=FloatingTip.getInstance(),e.btnTip=ButtonTip.getInstance(),e}return __extends(e,t),e.prototype.floatingTip=function(t){t&&"400"!=t.toString()&&this.floatTip.showTips(this.getMsg(t))},e.prototype.oneButtonTip=function(t,e,i,n){if(t&&"400"!=t.toString()){var r=this.getMsg(t);r=this.contactArgs(r,e),this.btnTip.oneButtonTip(r,i,n)}},e.prototype.twoButtonTip=function(t,e,i,n,r,s){if(t){var o=this.getMsg(t);o=this.contactArgs(o,e),this.btnTip.twoButtonTip(o,i,n,r,s)}},e.prototype.hideButtonTip=function(){this.btnTip.hideButtonTip()},e.prototype.getMsg=function(t){var e=RES.getRes("message_config");return e[t]?e[t].name:t},e.prototype.contactArgs=function(t,e){if(t&&t.length>0&&e&&e.length>0)for(var i=0;i<e.length;i++)t=t.replace("{"+(i+1)+"}",e[i]);return t},e}(BaseClass);__reflect(PromotManager.prototype,"PromotManager");var ItemRoomRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.lbTitle&&(this.lbTitle.text=this.data.name,this.lbLimit.text="入场："+this.data.lower/1e3)},e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i),this.data&&i==this.lbTitle&&(this.lbTitle.text=this.data.name,this.lbLimit.text="入场："+this.data.lower/1e3)},e}(eui.ItemRenderer);__reflect(ItemRoomRenderer.prototype,"ItemRoomRenderer");var RoomController=function(t){function e(){var e=t.call(this)||this;return e.roomView=new RoomView(e,LayerManager.UI_Main),App.ViewManager.register(ViewConst.Room,e.roomView),e}return __extends(e,t),e}(BaseController);__reflect(RoomController.prototype,"RoomController");var RoomView=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.title="选择场次",n}return __extends(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.lstRoom=new eui.List,this.lstRoom.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onChangeHandler,this)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this,e),e&&e[0]&&(this.title=e[0],this.lbTitle.text=this.title);for(var n=new eui.ArrayCollection,r=0;r<GameApp.PlayerInfo.myRoomTypeInfo.length;r++)for(var s=GameApp.PlayerInfo.myRoomTypeInfo[r].rooms,o=0;o<s.length;o++)n.addItem(s[o]);this.createList(n)},e.prototype.createList=function(t){var e=new eui.HorizontalLayout;e.verticalAlign=egret.VerticalAlign.MIDDLE,e.horizontalAlign=egret.HorizontalAlign.CENTER,e.gap=0,this.lstRoom.layout=e,this.lstRoom.itemRenderer=ItemRoomRenderer,this.lstRoom.itemRendererSkinName="resource/skins/ItemRoomSkin.exml",this.lstRoom.dataProvider=t;var i=new eui.Scroller;i.percentWidth=i.percentHeight=100,i.viewport=this.lstRoom,this.contentGroup.addChild(i),this.lstRoom.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onChangeHandler,this)},e.prototype.onChangeHandler=function(){var t=this.lstRoom.selectedItem;return GameApp.PlayerInfo.safeGold<t.lower.toNumber()?void GameApp.PromotManager.floatingTip("金币不足"):GameApp.PlayerInfo.safeGold>t.upper.toNumber()?void GameApp.PromotManager.floatingTip("金币超出房间设置"):(App.EasyLoading.showLoading(),GameApp.HomeManager.setRoomInfo(t),void GameApp.HomeManager.reqQuickEnterCurGame(t.roomId))},e}(BasePanelView);__reflect(RoomView.prototype,"RoomView");var LayerManager=function(){function t(){}return t.UI_Main=new BaseEuiLayer,t.UI_Popup=new BaseEuiLayer,t}();__reflect(LayerManager.prototype,"LayerManager");var LoginScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onEnter=function(){t.prototype.onEnter.call(this),this.addLayer(LayerManager.UI_Main)},e}(BaseScene);__reflect(LoginScene.prototype,"LoginScene");